# ãƒ­ãƒ¼ã‚«ãƒ«/æœ¬ç•ªã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®Œå…¨åˆ†é›¢ä¿®æ­£ãƒ¬ãƒãƒ¼ãƒˆ

**ä½œæˆæ—¥æ™‚**: 2025å¹´12æœˆ9æ—¥  
**ä¿®æ­£å†…å®¹**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã¨Azureæœ¬ç•ªç’°å¢ƒã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‚’å®Œå…¨åˆ†é›¢

---

## ğŸ” å•é¡Œã®åŸå› 

å‰å›ã®ä¿®æ­£ã§ã¯ã€ç’°å¢ƒåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ã¯æ­£ã—ãä¿®æ­£ã—ã¾ã—ãŸãŒã€**å®Ÿè£…ãŒã€ŒBLOBãŒåˆ©ç”¨å¯èƒ½ãªã‚‰ä½¿ã†ã€ã¨ã„ã†æ§‹é€ **ã«ãªã£ã¦ã„ã¾ã—ãŸã€‚

### å•é¡Œã®å‹•ä½œãƒ•ãƒ­ãƒ¼

**ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ç™ºç”Ÿã—ã¦ã„ãŸå•é¡Œ**:
```
1. ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã‚‚ getBlobServiceClient() ãŒå‘¼ã°ã‚Œã‚‹
2. AZURE_STORAGE_CONNECTION_STRING ãŒè¨­å®šã•ã‚Œã¦ã„ã‚Œã° BLOBã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆå–å¾—æˆåŠŸ
3. Azure BLOB ã¸ã®æ¥ç¶šã‚’è©¦ã¿ã‚‹ï¼ˆé…ã„ï¼‰
4. æ¥ç¶šã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã¾ãŸã¯ã‚¨ãƒ©ãƒ¼
5. ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ï¼ˆã•ã‚‰ã«é…ã„ï¼‰
```

**ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¸ã®å½±éŸ¿**:
- â‘  **æ–°è¦ãƒ•ãƒ­ãƒ¼ä½œæˆ**: ç”Ÿæˆã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ãŒBLOBä¿å­˜ã‚’è©¦ã¿ã€å¤±æ•—ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã•ã‚Œãªã„
- â‘¡ **ãƒãƒ£ãƒƒãƒˆç”»åƒé€ä¿¡**: ç”»åƒãŒBLOBã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚’è©¦ã¿ã€ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¦è¡¨ç¤ºã•ã‚Œãªã„
- â‘¢ **å±¥æ­´ç”»åƒè¡¨ç¤º**: BLOBå–å¾—ã‚’è©¦ã¿ã€é…å»¶ã¾ãŸã¯è¡¨ç¤ºå¤±æ•—

---

## âœ… ä¿®æ­£å†…å®¹

### åŸºæœ¬æ–¹é‡

**å®Œå…¨åˆ†é›¢ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£**:
- **ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ**: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ **ã®ã¿**ä½¿ç”¨ï¼ˆBLOBã¸ã®æ¥ç¶šã‚’ä¸€åˆ‡è©¦ã¿ãªã„ï¼‰
- **Azureç’°å¢ƒ**: BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸**ã®ã¿**ä½¿ç”¨ï¼ˆãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—ï¼‰

### ç’°å¢ƒåˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæœ€çµ‚ç‰ˆï¼‰

```javascript
// Azure App Serviceå›ºæœ‰ã®ç’°å¢ƒå¤‰æ•°ã®ã¿ã§åˆ¤å®š
const isAzureEnvironment = 
  process.env.WEBSITE_INSTANCE_ID !== undefined ||
  process.env.WEBSITE_SITE_NAME !== undefined;
```

**åˆ¤å®šæ¡ä»¶ã‹ã‚‰é™¤å¤–ã—ãŸã‚‚ã®**:
- `NODE_ENV`: ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚‚è¨­å®šå¯èƒ½
- `AZURE_STORAGE_CONNECTION_STRING`: ãƒ­ãƒ¼ã‚«ãƒ«ã§BLOBãƒ†ã‚¹ãƒˆç”¨ã«è¨­å®šã™ã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹

---

## ğŸ“ ä¿®æ­£ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã¨å†…å®¹

### 1. ç”»åƒå–å¾—ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ (`server/src/api/images/index.mjs`)

**ä¿®æ­£å†…å®¹**:
```javascript
// Azureç’°å¢ƒã‹ã©ã†ã‹ã‚’åˆ¤å®š
const isAzureEnvironment = 
  process.env.WEBSITE_INSTANCE_ID !== undefined ||
  process.env.WEBSITE_SITE_NAME !== undefined;

// Azureç’°å¢ƒ: BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿ä½¿ç”¨
if (isAzureEnvironment) {
  console.log('[api/images] AZURE: Using BLOB storage');
  const blobServiceClient = getBlobServiceClient();
  // ... BLOBå‡¦ç†ã®ã¿
  return;
}

// ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã¿ä½¿ç”¨
console.log('[api/images] LOCAL: Using local filesystem');
const localFilePath = path.join(localBasePath, fileName);
// ... ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«å‡¦ç†ã®ã¿
```

**åŠ¹æœ**:
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯ getBlobServiceClient() ã‚’å‘¼ã°ãªã„
- BLOBã¸ã®æ¥ç¶šã‚’ä¸€åˆ‡è©¦ã¿ãªã„ãŸã‚ã€é«˜é€ŸåŒ–

---

### 2. å±¥æ­´ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ (`server/src/routes/history.mjs`)

**ä¿®æ­£å†…å®¹**:
```javascript
// Azureç’°å¢ƒã‹ã©ã†ã‹ã‚’åˆ¤å®š
const isAzureEnvironment = 
  process.env.WEBSITE_INSTANCE_ID !== undefined ||
  process.env.WEBSITE_SITE_NAME !== undefined;

// ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã¿ä½¿ç”¨
if (!isAzureEnvironment) {
  console.log('[history/upload-image] LOCAL: Using local filesystem');
  
  const localDir = path.resolve(process.cwd(), 'knowledge-base', 'images', 'chat-exports');
  const localFilePath = path.join(localDir, fileName);
  
  // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
  if (!fs.existsSync(localDir)) {
    fs.mkdirSync(localDir, { recursive: true });
  }
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
  fs.writeFileSync(localFilePath, req.file.buffer);
  
  return res.json({
    success: true,
    imageUrl: `/api/images/chat-exports/${fileName}`,
    storage: 'local'
  });
}

// Azureç’°å¢ƒ: BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿ä½¿ç”¨
console.log('[history/upload-image] AZURE: Using BLOB storage');
// ... BLOBå‡¦ç†ã®ã¿
```

**åŠ¹æœ**:
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã¯BLOBæ¥ç¶šã‚’è©¦ã¿ãšã€ç›´æ¥ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜
- ãƒãƒ£ãƒƒãƒˆç”»åƒãŒå³åº§ã«ä¿å­˜ãƒ»è¡¨ç¤ºã•ã‚Œã‚‹

---

### 3. ãƒ•ãƒ­ãƒ¼ç”Ÿæˆãƒ»ä¿å­˜ (`server/src/api/emergency-flow/index.mjs`)

**ä¿®æ­£å†…å®¹**:

#### 3-1. ãƒ•ãƒ­ãƒ¼ç”Ÿæˆ (`/api/emergency-flow/generate`)

```javascript
// Azureç’°å¢ƒã‹ã©ã†ã‹ã‚’åˆ¤å®š
const isAzureEnvironment = 
  process.env.WEBSITE_INSTANCE_ID !== undefined ||
  process.env.WEBSITE_SITE_NAME !== undefined;

const fileName = `${flowId}.json`;

// ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®ã¿ä½¿ç”¨
if (!isAzureEnvironment) {
  console.log('[api/emergency-flow/generate] LOCAL: Using local filesystem');
  
  const localDir = path.resolve(process.cwd(), 'knowledge-base', 'troubleshooting');
  const localFilePath = path.join(localDir, fileName);
  
  // ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ
  if (!fs.existsSync(localDir)) {
    fs.mkdirSync(localDir, { recursive: true });
  }
  
  // ãƒ•ã‚¡ã‚¤ãƒ«ä¿å­˜
  const content = JSON.stringify(flowTemplate, null, 2);
  fs.writeFileSync(localFilePath, content, 'utf-8');
  
  return res.json({
    success: true,
    data: flowTemplate,
    saved: true,
    storage: 'local',
    message: `ãƒ•ãƒ­ãƒ¼ã‚’ç”Ÿæˆã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã«ä¿å­˜ã—ã¾ã—ãŸ (${fileName})`
  });
}

// Azureç’°å¢ƒ: BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿ä½¿ç”¨
console.log('[api/emergency-flow/generate] AZURE: Using BLOB storage');
// ... BLOBå‡¦ç†ã®ã¿
```

#### 3-2. ãƒ•ãƒ­ãƒ¼ä¸€è¦§å–å¾— (`/api/emergency-flow/list`)

```javascript
// ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰å–å¾—
if (!isAzureEnvironment) {
  console.log('[api/emergency-flow/list] LOCAL: Reading from local filesystem');
  const localDir = path.resolve(process.cwd(), 'knowledge-base', 'troubleshooting');
  
  if (fs.existsSync(localDir)) {
    const files = fs.readdirSync(localDir);
    
    for (const fileName of files) {
      if (!fileName.endsWith('.json')) continue;
      
      const filePath = path.join(localDir, fileName);
      const stats = fs.statSync(filePath);
      
      flows.push({
        id: fileName.replace('.json', ''),
        name: fileName,
        fileName,
        lastModified: stats.mtime,
        size: stats.size,
      });
    }
  }
  
  return res.json({
    success: true,
    data: flows,
    total: flows.length,
    storage: 'local'
  });
}

// Azureç’°å¢ƒ: BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å–å¾—
// ... BLOBå‡¦ç†ã®ã¿
```

#### 3-3. ãƒ•ãƒ­ãƒ¼è©³ç´°å–å¾— (`/api/emergency-flow/detail/:id`)

```javascript
// ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ: ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰å–å¾—
if (!isAzureEnvironment) {
  console.log('[api/emergency-flow/detail] LOCAL: Reading from local filesystem');
  const localDir = path.resolve(process.cwd(), 'knowledge-base', 'troubleshooting');
  const localFilePath = path.join(localDir, fileName);
  
  if (!fs.existsSync(localFilePath)) {
    return res.status(404).json({ 
      success: false, 
      error: 'ãƒ•ãƒ­ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'
    });
  }
  
  const content = fs.readFileSync(localFilePath, 'utf-8');
  const jsonData = JSON.parse(content);
  
  return res.json({
    success: true,
    data: jsonData,
    storage: 'local',
    ...jsonData
  });
}

// Azureç’°å¢ƒ: BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã‹ã‚‰å–å¾—
// ... BLOBå‡¦ç†ã®ã¿
```

**åŠ¹æœ**:
- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ãƒ•ãƒ­ãƒ¼ç”ŸæˆãŒå³åº§ã«å®Œäº†
- ãƒ•ãƒ­ãƒ¼ä¸€è¦§ãŒãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã‹ã‚‰é«˜é€Ÿå–å¾—
- ãƒ•ãƒ­ãƒ¼ç·¨é›†ãŒæ­£å¸¸ã«å‹•ä½œ

---

## ğŸš€ ä¿®æ­£å¾Œã®å‹•ä½œãƒ•ãƒ­ãƒ¼

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ

```
ç’°å¢ƒåˆ¤å®š: isAzureEnvironment = false
â†“
ã€ç”»åƒå–å¾—ã€‘
/api/images/{category}/{fileName}
â†’ knowledge-base/images/{category}/{fileName} ã‹ã‚‰ç›´æ¥å–å¾—
â†’ é«˜é€Ÿ

ã€ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€‘
/history/upload-image
â†’ knowledge-base/images/chat-exports/{fileName} ã«ç›´æ¥ä¿å­˜
â†’ é«˜é€Ÿ

ã€ãƒ•ãƒ­ãƒ¼ç”Ÿæˆã€‘
/api/emergency-flow/generate
â†’ knowledge-base/troubleshooting/{flowId}.json ã«ç›´æ¥ä¿å­˜
â†’ é«˜é€Ÿ

ã€ãƒ•ãƒ­ãƒ¼ä¸€è¦§ã€‘
/api/emergency-flow/list
â†’ knowledge-base/troubleshooting/ ã‚’ç›´æ¥èª­ã¿è¾¼ã¿
â†’ é«˜é€Ÿ

ã€ãƒ•ãƒ­ãƒ¼è©³ç´°ã€‘
/api/emergency-flow/detail/:id
â†’ knowledge-base/troubleshooting/{flowId}.json ã‚’ç›´æ¥èª­ã¿è¾¼ã¿
â†’ é«˜é€Ÿ
```

### Azureç’°å¢ƒ

```
ç’°å¢ƒåˆ¤å®š: isAzureEnvironment = true
          (WEBSITE_INSTANCE_ID ã¾ãŸã¯ WEBSITE_SITE_NAME ãŒå­˜åœ¨)
â†“
ã€ç”»åƒå–å¾—ã€‘
/api/images/{category}/{fileName}
â†’ BLOB: knowledge-base/images/{category}/{fileName} ã‹ã‚‰å–å¾—
â†’ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—

ã€ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã€‘
/history/upload-image
â†’ BLOB: knowledge-base/images/chat-exports/{fileName} ã«ä¿å­˜
â†’ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—

ã€ãƒ•ãƒ­ãƒ¼ç”Ÿæˆã€‘
/api/emergency-flow/generate
â†’ BLOB: knowledge-base/troubleshooting/{flowId}.json ã«ä¿å­˜
â†’ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ãªã—

ã€ãƒ•ãƒ­ãƒ¼ä¸€è¦§ã€‘
/api/emergency-flow/list
â†’ BLOB: knowledge-base/troubleshooting/*.json ã‚’ä¸€è¦§å–å¾—

ã€ãƒ•ãƒ­ãƒ¼è©³ç´°ã€‘
/api/emergency-flow/detail/:id
â†’ BLOB: knowledge-base/troubleshooting/{flowId}.json ã‚’å–å¾—
```

---

## ğŸ“Š æœŸå¾…ã•ã‚Œã‚‹åŠ¹æœ

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ

| æ©Ÿèƒ½ | ä¿®æ­£å‰ | ä¿®æ­£å¾Œ |
|-----|-------|-------|
| æ–°è¦ãƒ•ãƒ­ãƒ¼ä½œæˆ | âŒ BLOBæ¥ç¶šè©¦è¡Œ â†’ å¤±æ•— â†’ ä¿å­˜ã•ã‚Œãªã„ | âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã«å³åº§ã«ä¿å­˜ |
| ãƒãƒ£ãƒƒãƒˆç”»åƒé€ä¿¡ | âŒ BLOBæ¥ç¶šè©¦è¡Œ â†’ ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ â†’ è¡¨ç¤ºã•ã‚Œãªã„ | âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã«å³åº§ã«ä¿å­˜ãƒ»è¡¨ç¤º |
| å±¥æ­´ç”»åƒè¡¨ç¤º | âŒ BLOBæ¥ç¶šè©¦è¡Œ â†’ é…å»¶ â†’ è¡¨ç¤ºå¤±æ•— | âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰å³åº§ã«è¡¨ç¤º |
| ãƒ•ãƒ­ãƒ¼ä¸€è¦§è¡¨ç¤º | âŒ BLOBæ¥ç¶šè©¦è¡Œ â†’ é…å»¶ â†’ è¡¨ç¤ºå¤±æ•— | âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã‹ã‚‰å³åº§ã«è¡¨ç¤º |

### Azureæœ¬ç•ªç’°å¢ƒ

| æ©Ÿèƒ½ | å‹•ä½œ |
|-----|-----|
| æ–°è¦ãƒ•ãƒ­ãƒ¼ä½œæˆ | âœ… BLOBã«ä¿å­˜ï¼ˆæ°¸ç¶šåŒ–ï¼‰ |
| ãƒãƒ£ãƒƒãƒˆç”»åƒé€ä¿¡ | âœ… BLOBã«ä¿å­˜ï¼ˆæ°¸ç¶šåŒ–ï¼‰ |
| å±¥æ­´ç”»åƒè¡¨ç¤º | âœ… BLOBã‹ã‚‰å–å¾— |
| ãƒ•ãƒ­ãƒ¼ä¸€è¦§è¡¨ç¤º | âœ… BLOBã‹ã‚‰å–å¾— |

---

## ğŸ§ª ãƒ†ã‚¹ãƒˆæ‰‹é †

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§ã®ãƒ†ã‚¹ãƒˆ

```powershell
# 1. ã‚µãƒ¼ãƒãƒ¼å†èµ·å‹•
npm run dev

# 2. ãƒ†ã‚¹ãƒˆé …ç›®
```

#### â‘  æ–°è¦ãƒ•ãƒ­ãƒ¼ä½œæˆã®ãƒ†ã‚¹ãƒˆ
1. å¿œæ€¥å¾©æ—§ãƒ‡ãƒ¼ã‚¿ç®¡ç†UIã‚’é–‹ã
2. æ–°è¦ãƒ•ãƒ­ãƒ¼ä½œæˆã‚¿ãƒ–ã‚’é¸æŠ
3. ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆä¾‹: "åœé›»"ï¼‰ã‚’å…¥åŠ›ã—ã¦ãƒ•ãƒ­ãƒ¼ç”Ÿæˆ
4. **æœŸå¾…çµæœ**: 
   - å³åº§ã«ãƒ•ãƒ­ãƒ¼ç”Ÿæˆå®Œäº†
   - `knowledge-base/troubleshooting/emergency-flow-{timestamp}.json` ã«ä¿å­˜
   - ãƒ•ãƒ­ãƒ¼ä¸€è¦§ã«è¡¨ç¤ºã•ã‚Œã‚‹

#### â‘¡ ãƒãƒ£ãƒƒãƒˆç”»åƒé€ä¿¡ã®ãƒ†ã‚¹ãƒˆ
1. ãƒãƒ£ãƒƒãƒˆUIã‚’é–‹ã
2. ã‚«ãƒ¡ãƒ©ã‚¢ã‚¤ã‚³ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç”»åƒã‚’é¸æŠ
3. ç”»åƒã‚’é€ä¿¡
4. **æœŸå¾…çµæœ**: 
   - å³åº§ã«ç”»åƒã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å®Œäº†
   - `knowledge-base/images/chat-exports/chat_image_{timestamp}.jpg` ã«ä¿å­˜
   - ãƒãƒ£ãƒƒãƒˆã«ç”»åƒãŒè¡¨ç¤ºã•ã‚Œã‚‹

#### â‘¢ å±¥æ­´ç”»åƒè¡¨ç¤ºã®ãƒ†ã‚¹ãƒˆ
1. å±¥æ­´ç®¡ç†UIã‚’é–‹ã
2. æ•…éšœä¸€è¦§è¡¨ã‚’ç¢ºèª
3. **æœŸå¾…çµæœ**: 
   - ç”»åƒåˆ—ã«ç”»åƒãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãŒå³åº§ã«è¡¨ç¤ºã•ã‚Œã‚‹
   - ç”»åƒãŒç•°å¸¸ã«é…ã„ã“ã¨ãªãè¡¨ç¤ºã•ã‚Œã‚‹

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ 

### ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒ

```
Emergency-Assistance/
â”œâ”€â”€ knowledge-base/
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ chat-exports/          # ãƒãƒ£ãƒƒãƒˆç”»åƒ
â”‚   â”‚   â”‚   â””â”€â”€ chat_image_*.jpg
â”‚   â”‚   â””â”€â”€ emergency-flows/       # ãƒ•ãƒ­ãƒ¼ç”»åƒï¼ˆå°†æ¥ç”¨ï¼‰
â”‚   â””â”€â”€ troubleshooting/            # ãƒ•ãƒ­ãƒ¼å®šç¾©
â”‚       â””â”€â”€ emergency-flow-*.json
```

### Azureç’°å¢ƒï¼ˆBLOBï¼‰

```
knowledge (container)
â”œâ”€â”€ knowledge-base/
â”‚   â”œâ”€â”€ images/
â”‚   â”‚   â”œâ”€â”€ chat-exports/          # ãƒãƒ£ãƒƒãƒˆç”»åƒ
â”‚   â”‚   â”‚   â””â”€â”€ chat_image_*.jpg
â”‚   â”‚   â””â”€â”€ emergency-flows/       # ãƒ•ãƒ­ãƒ¼ç”»åƒï¼ˆå°†æ¥ç”¨ï¼‰
â”‚   â””â”€â”€ troubleshooting/            # ãƒ•ãƒ­ãƒ¼å®šç¾©
â”‚       â””â”€â”€ emergency-flow-*.json
```

---

## ğŸ¯ ã¾ã¨ã‚

### ä¿®æ­£ã®ãƒã‚¤ãƒ³ãƒˆ

1. **ç’°å¢ƒåˆ¤å®š**: Azure App Serviceå›ºæœ‰ã®ç’°å¢ƒå¤‰æ•°ã®ã¿ã§åˆ¤å®š
2. **å®Œå…¨åˆ†é›¢**: ãƒ­ãƒ¼ã‚«ãƒ«ã¯ãƒ­ãƒ¼ã‚«ãƒ«ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿ã€Azureã¯BLOBã®ã¿
3. **ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯å‰Šé™¤**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§BLOBæ¥ç¶šã‚’è©¦ã¿ãªã„
4. **é«˜é€ŸåŒ–**: ä¸è¦ãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯æ¥ç¶šã‚’æ’é™¤

### è§£æ±ºã—ãŸå•é¡Œ

- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã§æ–°è¦ãƒ•ãƒ­ãƒ¼ä½œæˆãŒæ­£å¸¸ã«å‹•ä½œ
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒãƒ£ãƒƒãƒˆç”»åƒé€ä¿¡ãŒæ­£å¸¸ã«å‹•ä½œ
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã§å±¥æ­´ç”»åƒãŒå³åº§ã«è¡¨ç¤º
- âœ… ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ•ãƒ­ãƒ¼ä¸€è¦§ãŒå³åº§ã«è¡¨ç¤º
- âœ… æœ¬ç•ªç’°å¢ƒã§BLOBã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã®ã¿ä½¿ç”¨

---

**ä¿®æ­£å®Œäº†æ—¥æ™‚**: 2025å¹´12æœˆ9æ—¥  
**æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—**: ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒã§3ã¤ã®æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆã—ã¦å‹•ä½œç¢ºèª
