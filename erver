[1mdiff --git a/ops/verify-login.ps1 b/ops/verify-login.ps1[m
[1mnew file mode 100644[m
[1mindex 00000000..6d9e636b[m
[1m--- /dev/null[m
[1m+++ b/ops/verify-login.ps1[m
[36m@@ -0,0 +1,85 @@[m
[32m+[m[32m# ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ[m
[32m+[m[32m# PowerShell / curl.exe å‰æ[m
[32m+[m
[32m+[m[32mparam([m
[32m+[m[32m    [string]$BASE = "https://emergencyassistance-sv-fbanemhrbshuf9bd.japanwest-01.azurewebsites.net"[m
[32m+[m[32m)[m
[32m+[m
[32m+[m[32mWrite-Host "ğŸ” ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ†ã‚¹ãƒˆé–‹å§‹" -ForegroundColor Green[m
[32m+[m[32mWrite-Host "å¯¾è±¡URL: $BASE" -ForegroundColor Yellow[m
[32m+[m
[32m+[m[32m# 1) æœªãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã§ /me ã‚’ãƒ†ã‚¹ãƒˆï¼ˆ401æœŸå¾…ï¼‰[m
[32m+[m[32mWrite-Host "`n1ï¸âƒ£ æœªãƒ­ã‚°ã‚¤ãƒ³çŠ¶æ…‹ã§ /api/auth/me ã‚’ãƒ†ã‚¹ãƒˆ..." -ForegroundColor Cyan[m
[32m+[m[32m$meResponse = curl.exe -s -i "$BASE/api/auth/me"[m
[32m+[m[32m$meStatus = ($meResponse | Select-String "HTTP/1.1 (\d+)").Matches[0].Groups[1].Value[m
[32m+[m
[32m+[m[32mif ($meStatus -eq "401") {[m
[32m+[m[32m    Write-Host "âœ… /api/auth/me æœªãƒ­ã‚°ã‚¤ãƒ³: 401 OK" -ForegroundColor Green[m
[32m+[m[32m} else {[m
[32m+[m[32m    Write-Host "âŒ /api/auth/me æœªãƒ­ã‚°ã‚¤ãƒ³: æœŸå¾…å€¤401, å®Ÿéš›$meStatus" -ForegroundColor Red[m
[32m+[m[32m    Write-Host "ãƒ¬ã‚¹ãƒãƒ³ã‚¹: $meResponse" -ForegroundColor Yellow[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32m# 2) ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆCookieä¿å­˜ï¼‰[m
[32m+[m[32mWrite-Host "`n2ï¸âƒ£ ãƒ­ã‚°ã‚¤ãƒ³å®Ÿè¡Œï¼ˆCookieä¿å­˜ï¼‰..." -ForegroundColor Cyan[m
[32m+[m[32m$loginResponse = curl.exe -s -i -c cookies.txt -H "Content-Type: application/json" -X POST "$BASE/api/auth/login" --data '{"username":"niina","password":"dummy"}'[m
[32m+[m[32m$loginStatus = ($loginResponse | Select-String "HTTP/1.1 (\d+)").Matches[0].Groups[1].Value[m
[32m+[m
[32m+[m[32mif ($loginStatus -eq "200") {[m
[32m+[m[32m    Write-Host "âœ… POST /api/auth/login: 200 OK" -ForegroundColor Green[m
[32m+[m[41m    [m
[32m+[m[32m    # Set-Cookieãƒ˜ãƒƒãƒ€ãƒ¼ã®ç¢ºèª[m
[32m+[m[32m    $setCookie = ($loginResponse | Select-String "Set-Cookie").Line[m
[32m+[m[32m    if ($setCookie) {[m
[32m+[m[32m        Write-Host "âœ… Set-Cookie ãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª: $setCookie" -ForegroundColor Green[m
[32m+[m[32m    } else {[m
[32m+[m[32m        Write-Host "âš ï¸ Set-Cookie ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“" -ForegroundColor Yellow[m
[32m+[m[32m    }[m
[32m+[m[32m} else {[m
[32m+[m[32m    Write-Host "âŒ POST /api/auth/login: æœŸå¾…å€¤200, å®Ÿéš›$loginStatus" -ForegroundColor Red[m
[32m+[m[32m    Write-Host "ãƒ¬ã‚¹ãƒãƒ³ã‚¹: $loginResponse" -ForegroundColor Yellow[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32m# 3) ãƒ­ã‚°ã‚¤ãƒ³å¾Œã® /meï¼ˆ200æœŸå¾…ï¼‰[m
[32m+[m[32mWrite-Host "`n3ï¸âƒ£ ãƒ­ã‚°ã‚¤ãƒ³å¾Œã® /api/auth/me ã‚’ãƒ†ã‚¹ãƒˆ..." -ForegroundColor Cyan[m
[32m+[m[32m$meLoggedInResponse = curl.exe -s -i -b cookies.txt "$BASE/api/auth/me"[m
[32m+[m[32m$meLoggedInStatus = ($meLoggedInResponse | Select-String "HTTP/1.1 (\d+)").Matches[0].Groups[1].Value[m
[32m+[m
[32m+[m[32mif ($meLoggedInStatus -eq "200") {[m
[32m+[m[32m    Write-Host "âœ… /api/auth/me ãƒ­ã‚°ã‚¤ãƒ³å¾Œ: 200 OK" -ForegroundColor Green[m
[32m+[m[32m} else {[m
[32m+[m[32m    Write-Host "âŒ /api/auth/me ãƒ­ã‚°ã‚¤ãƒ³å¾Œ: æœŸå¾…å€¤200, å®Ÿéš›$meLoggedInStatus" -ForegroundColor Red[m
[32m+[m[32m    Write-Host "ãƒ¬ã‚¹ãƒãƒ³ã‚¹: $meLoggedInResponse" -ForegroundColor Yellow[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32m# 4) ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯[m
[32m+[m[32mWrite-Host "`n4ï¸âƒ£ ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯..." -ForegroundColor Cyan[m
[32m+[m[32m$healthResponse = curl.exe -s -i "$BASE/api/health"[m
[32m+[m[32m$healthStatus = ($healthResponse | Select-String "HTTP/1.1 (\d+)").Matches[0].Groups[1].Value[m
[32m+[m
[32m+[m[32mif ($healthStatus -eq "200") {[m
[32m+[m[32m    Write-Host "âœ… /api/health: 200 OK" -ForegroundColor Green[m
[32m+[m[32m} else {[m
[32m+[m[32m    Write-Host "âŒ /api/health: æœŸå¾…å€¤200, å®Ÿéš›$healthStatus" -ForegroundColor Red[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32m# 5) CORS ãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª[m
[32m+[m[32mWrite-Host "`n5ï¸âƒ£ CORS ãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª..." -ForegroundColor Cyan[m
[32m+[m[32m$corsResponse = curl.exe -s -i -H "Origin: https://witty-river-012f39e00.1.azurestaticapps.net" "$BASE/api/auth/me"[m
[32m+[m[32m$corsOrigin = ($corsResponse | Select-String "Access-Control-Allow-Origin").Line[m
[32m+[m[32m$corsCredentials = ($corsResponse | Select-String "Access-Control-Allow-Credentials").Line[m
[32m+[m
[32m+[m[32mif ($corsOrigin -and $corsCredentials) {[m
[32m+[m[32m    Write-Host "âœ… CORS ãƒ˜ãƒƒãƒ€ãƒ¼ç¢ºèª: $corsOrigin" -ForegroundColor Green[m
[32m+[m[32m    Write-Host "âœ… CORS Credentials: $corsCredentials" -ForegroundColor Green[m
[32m+[m[32m} else {[m
[32m+[m[32m    Write-Host "âš ï¸ CORS ãƒ˜ãƒƒãƒ€ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“" -ForegroundColor Yellow[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32m# ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—[m
[32m+[m[32mif (Test-Path "cookies.txt") {[m
[32m+[m[32m    Remove-Item "cookies.txt"[m
[32m+[m[32m    Write-Host "`nğŸ§¹ ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã—ã¾ã—ãŸ" -ForegroundColor Gray[m
[32m+[m[32m}[m
[32m+[m
[32m+[m[32mWrite-Host "`nğŸ ãƒ­ã‚°ã‚¤ãƒ³èªè¨¼ãƒ†ã‚¹ãƒˆå®Œäº†" -ForegroundColor Green[m
