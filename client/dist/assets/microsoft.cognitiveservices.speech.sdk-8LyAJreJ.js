import{c as k,g as Zu,a as Yu}from"./index-Ch_OZrEg.js";function ed(t,e){for(var r=0;r<e.length;r++){const o=e[r];if(typeof o!="string"&&!Array.isArray(o)){for(const p in o)if(p!=="default"&&!(p in t)){const a=Object.getOwnPropertyDescriptor(o,p);a&&Object.defineProperty(t,p,a.get?a:{enumerable:!0,get:()=>o[p]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}var rs={},bn={},hi={},Mn={},B={},et={},ae={},pc={},li={},vi={};Object.defineProperty(vi,"__esModule",{value:!0});vi.default=rd;let si;const td=new Uint8Array(16);function rd(){if(!si&&(si=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!si))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return si(td)}var Ae={},He={},fi={};Object.defineProperty(fi,"__esModule",{value:!0});fi.default=void 0;var id=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;fi.default=id;Object.defineProperty(He,"__esModule",{value:!0});He.default=void 0;var nd=sd(fi);function sd(t){return t&&t.__esModule?t:{default:t}}function od(t){return typeof t=="string"&&nd.default.test(t)}var ad=od;He.default=ad;Object.defineProperty(Ae,"__esModule",{value:!0});Ae.default=void 0;Ae.unsafeStringify=uc;var cd=pd(He);function pd(t){return t&&t.__esModule?t:{default:t}}const U=[];for(let t=0;t<256;++t)U.push((t+256).toString(16).slice(1));function uc(t,e=0){return U[t[e+0]]+U[t[e+1]]+U[t[e+2]]+U[t[e+3]]+"-"+U[t[e+4]]+U[t[e+5]]+"-"+U[t[e+6]]+U[t[e+7]]+"-"+U[t[e+8]]+U[t[e+9]]+"-"+U[t[e+10]]+U[t[e+11]]+U[t[e+12]]+U[t[e+13]]+U[t[e+14]]+U[t[e+15]]}function ud(t,e=0){const r=uc(t,e);if(!(0,cd.default)(r))throw TypeError("Stringified UUID is invalid");return r}var dd=ud;Ae.default=dd;Object.defineProperty(li,"__esModule",{value:!0});li.default=void 0;var hd=vd(vi),ld=Ae;function vd(t){return t&&t.__esModule?t:{default:t}}let Ns,On,Dn=0,kn=0;function fd(t,e,r){let o=e&&r||0;const p=e||new Array(16);t=t||{};let a=t.node||Ns,n=t.clockseq!==void 0?t.clockseq:On;if(a==null||n==null){const h=t.random||(t.rng||hd.default)();a==null&&(a=Ns=[h[0]|1,h[1],h[2],h[3],h[4],h[5]]),n==null&&(n=On=(h[6]<<8|h[7])&16383)}let i=t.msecs!==void 0?t.msecs:Date.now(),s=t.nsecs!==void 0?t.nsecs:kn+1;const c=i-Dn+(s-kn)/1e4;if(c<0&&t.clockseq===void 0&&(n=n+1&16383),(c<0||i>Dn)&&t.nsecs===void 0&&(s=0),s>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Dn=i,kn=s,On=n,i+=122192928e5;const u=((i&268435455)*1e4+s)%4294967296;p[o++]=u>>>24&255,p[o++]=u>>>16&255,p[o++]=u>>>8&255,p[o++]=u&255;const d=i/4294967296*1e4&268435455;p[o++]=d>>>8&255,p[o++]=d&255,p[o++]=d>>>24&15|16,p[o++]=d>>>16&255,p[o++]=n>>>8|128,p[o++]=n&255;for(let h=0;h<6;++h)p[o+h]=a[h];return e||(0,ld.unsafeStringify)(p)}var gd=fd;li.default=gd;var gi={},Ie={},Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.default=void 0;var md=Sd(He);function Sd(t){return t&&t.__esModule?t:{default:t}}function Cd(t){if(!(0,md.default)(t))throw TypeError("Invalid UUID");let e;const r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=e&255,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=e&255,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=e&255,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=e&255,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=e&255,r}var yd=Cd;Kr.default=yd;Object.defineProperty(Ie,"__esModule",{value:!0});Ie.URL=Ie.DNS=void 0;Ie.default=Td;var Pd=Ae,Rd=Ed(Kr);function Ed(t){return t&&t.__esModule?t:{default:t}}function Id(t){t=unescape(encodeURIComponent(t));const e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}const dc="6ba7b810-9dad-11d1-80b4-00c04fd430c8";Ie.DNS=dc;const hc="6ba7b811-9dad-11d1-80b4-00c04fd430c8";Ie.URL=hc;function Td(t,e,r){function o(p,a,n,i){var s;if(typeof p=="string"&&(p=Id(p)),typeof a=="string"&&(a=(0,Rd.default)(a)),((s=a)===null||s===void 0?void 0:s.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let c=new Uint8Array(16+p.length);if(c.set(a),c.set(p,a.length),c=r(c),c[6]=c[6]&15|e,c[8]=c[8]&63|128,n){i=i||0;for(let u=0;u<16;++u)n[i+u]=c[u];return n}return(0,Pd.unsafeStringify)(c)}try{o.name=t}catch{}return o.DNS=dc,o.URL=hc,o}var mi={};Object.defineProperty(mi,"__esModule",{value:!0});mi.default=void 0;function Ad(t){if(typeof t=="string"){const e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return wd(_d(bd(t),t.length*8))}function wd(t){const e=[],r=t.length*32,o="0123456789abcdef";for(let p=0;p<r;p+=8){const a=t[p>>5]>>>p%32&255,n=parseInt(o.charAt(a>>>4&15)+o.charAt(a&15),16);e.push(n)}return e}function lc(t){return(t+64>>>9<<4)+14+1}function _d(t,e){t[e>>5]|=128<<e%32,t[lc(e)-1]=e;let r=1732584193,o=-271733879,p=-1732584194,a=271733878;for(let n=0;n<t.length;n+=16){const i=r,s=o,c=p,u=a;r=K(r,o,p,a,t[n],7,-680876936),a=K(a,r,o,p,t[n+1],12,-389564586),p=K(p,a,r,o,t[n+2],17,606105819),o=K(o,p,a,r,t[n+3],22,-1044525330),r=K(r,o,p,a,t[n+4],7,-176418897),a=K(a,r,o,p,t[n+5],12,1200080426),p=K(p,a,r,o,t[n+6],17,-1473231341),o=K(o,p,a,r,t[n+7],22,-45705983),r=K(r,o,p,a,t[n+8],7,1770035416),a=K(a,r,o,p,t[n+9],12,-1958414417),p=K(p,a,r,o,t[n+10],17,-42063),o=K(o,p,a,r,t[n+11],22,-1990404162),r=K(r,o,p,a,t[n+12],7,1804603682),a=K(a,r,o,p,t[n+13],12,-40341101),p=K(p,a,r,o,t[n+14],17,-1502002290),o=K(o,p,a,r,t[n+15],22,1236535329),r=J(r,o,p,a,t[n+1],5,-165796510),a=J(a,r,o,p,t[n+6],9,-1069501632),p=J(p,a,r,o,t[n+11],14,643717713),o=J(o,p,a,r,t[n],20,-373897302),r=J(r,o,p,a,t[n+5],5,-701558691),a=J(a,r,o,p,t[n+10],9,38016083),p=J(p,a,r,o,t[n+15],14,-660478335),o=J(o,p,a,r,t[n+4],20,-405537848),r=J(r,o,p,a,t[n+9],5,568446438),a=J(a,r,o,p,t[n+14],9,-1019803690),p=J(p,a,r,o,t[n+3],14,-187363961),o=J(o,p,a,r,t[n+8],20,1163531501),r=J(r,o,p,a,t[n+13],5,-1444681467),a=J(a,r,o,p,t[n+2],9,-51403784),p=J(p,a,r,o,t[n+7],14,1735328473),o=J(o,p,a,r,t[n+12],20,-1926607734),r=G(r,o,p,a,t[n+5],4,-378558),a=G(a,r,o,p,t[n+8],11,-2022574463),p=G(p,a,r,o,t[n+11],16,1839030562),o=G(o,p,a,r,t[n+14],23,-35309556),r=G(r,o,p,a,t[n+1],4,-1530992060),a=G(a,r,o,p,t[n+4],11,1272893353),p=G(p,a,r,o,t[n+7],16,-155497632),o=G(o,p,a,r,t[n+10],23,-1094730640),r=G(r,o,p,a,t[n+13],4,681279174),a=G(a,r,o,p,t[n],11,-358537222),p=G(p,a,r,o,t[n+3],16,-722521979),o=G(o,p,a,r,t[n+6],23,76029189),r=G(r,o,p,a,t[n+9],4,-640364487),a=G(a,r,o,p,t[n+12],11,-421815835),p=G(p,a,r,o,t[n+15],16,530742520),o=G(o,p,a,r,t[n+2],23,-995338651),r=Q(r,o,p,a,t[n],6,-198630844),a=Q(a,r,o,p,t[n+7],10,1126891415),p=Q(p,a,r,o,t[n+14],15,-1416354905),o=Q(o,p,a,r,t[n+5],21,-57434055),r=Q(r,o,p,a,t[n+12],6,1700485571),a=Q(a,r,o,p,t[n+3],10,-1894986606),p=Q(p,a,r,o,t[n+10],15,-1051523),o=Q(o,p,a,r,t[n+1],21,-2054922799),r=Q(r,o,p,a,t[n+8],6,1873313359),a=Q(a,r,o,p,t[n+15],10,-30611744),p=Q(p,a,r,o,t[n+6],15,-1560198380),o=Q(o,p,a,r,t[n+13],21,1309151649),r=Q(r,o,p,a,t[n+4],6,-145523070),a=Q(a,r,o,p,t[n+11],10,-1120210379),p=Q(p,a,r,o,t[n+2],15,718787259),o=Q(o,p,a,r,t[n+9],21,-343485551),r=Re(r,i),o=Re(o,s),p=Re(p,c),a=Re(a,u)}return[r,o,p,a]}function bd(t){if(t.length===0)return[];const e=t.length*8,r=new Uint32Array(lc(e));for(let o=0;o<e;o+=8)r[o>>5]|=(t[o/8]&255)<<o%32;return r}function Re(t,e){const r=(t&65535)+(e&65535);return(t>>16)+(e>>16)+(r>>16)<<16|r&65535}function Md(t,e){return t<<e|t>>>32-e}function Si(t,e,r,o,p,a){return Re(Md(Re(Re(e,t),Re(o,a)),p),r)}function K(t,e,r,o,p,a,n){return Si(e&r|~e&o,t,e,p,a,n)}function J(t,e,r,o,p,a,n){return Si(e&o|r&~o,t,e,p,a,n)}function G(t,e,r,o,p,a,n){return Si(e^r^o,t,e,p,a,n)}function Q(t,e,r,o,p,a,n){return Si(r^(e|~o),t,e,p,a,n)}var Od=Ad;mi.default=Od;Object.defineProperty(gi,"__esModule",{value:!0});gi.default=void 0;var Dd=vc(Ie),kd=vc(mi);function vc(t){return t&&t.__esModule?t:{default:t}}const Nd=(0,Dd.default)("v3",48,kd.default);var zd=Nd;gi.default=zd;var Ci={},yi={};Object.defineProperty(yi,"__esModule",{value:!0});yi.default=void 0;const jd=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var Ld={randomUUID:jd};yi.default=Ld;Object.defineProperty(Ci,"__esModule",{value:!0});Ci.default=void 0;var zs=fc(yi),Bd=fc(vi),qd=Ae;function fc(t){return t&&t.__esModule?t:{default:t}}function Fd(t,e,r){if(zs.default.randomUUID&&!e&&!t)return zs.default.randomUUID();t=t||{};const o=t.random||(t.rng||Bd.default)();if(o[6]=o[6]&15|64,o[8]=o[8]&63|128,e){r=r||0;for(let p=0;p<16;++p)e[r+p]=o[p];return e}return(0,qd.unsafeStringify)(o)}var xd=Fd;Ci.default=xd;var Pi={},Ri={};Object.defineProperty(Ri,"__esModule",{value:!0});Ri.default=void 0;function Ud(t,e,r,o){switch(t){case 0:return e&r^~e&o;case 1:return e^r^o;case 2:return e&r^e&o^r&o;case 3:return e^r^o}}function Nn(t,e){return t<<e|t>>>32-e}function Wd(t){const e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof t=="string"){const n=unescape(encodeURIComponent(t));t=[];for(let i=0;i<n.length;++i)t.push(n.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);const o=t.length/4+2,p=Math.ceil(o/16),a=new Array(p);for(let n=0;n<p;++n){const i=new Uint32Array(16);for(let s=0;s<16;++s)i[s]=t[n*64+s*4]<<24|t[n*64+s*4+1]<<16|t[n*64+s*4+2]<<8|t[n*64+s*4+3];a[n]=i}a[p-1][14]=(t.length-1)*8/Math.pow(2,32),a[p-1][14]=Math.floor(a[p-1][14]),a[p-1][15]=(t.length-1)*8&4294967295;for(let n=0;n<p;++n){const i=new Uint32Array(80);for(let l=0;l<16;++l)i[l]=a[n][l];for(let l=16;l<80;++l)i[l]=Nn(i[l-3]^i[l-8]^i[l-14]^i[l-16],1);let s=r[0],c=r[1],u=r[2],d=r[3],h=r[4];for(let l=0;l<80;++l){const f=Math.floor(l/20),g=Nn(s,5)+Ud(f,c,u,d)+h+e[f]+i[l]>>>0;h=d,d=u,u=Nn(c,30)>>>0,c=s,s=g}r[0]=r[0]+s>>>0,r[1]=r[1]+c>>>0,r[2]=r[2]+u>>>0,r[3]=r[3]+d>>>0,r[4]=r[4]+h>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,r[0]&255,r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,r[1]&255,r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,r[2]&255,r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,r[3]&255,r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,r[4]&255]}var Vd=Wd;Ri.default=Vd;Object.defineProperty(Pi,"__esModule",{value:!0});Pi.default=void 0;var Hd=gc(Ie),$d=gc(Ri);function gc(t){return t&&t.__esModule?t:{default:t}}const Kd=(0,Hd.default)("v5",80,$d.default);var Jd=Kd;Pi.default=Jd;var Ei={};Object.defineProperty(Ei,"__esModule",{value:!0});Ei.default=void 0;var Gd="00000000-0000-0000-0000-000000000000";Ei.default=Gd;var Ii={};Object.defineProperty(Ii,"__esModule",{value:!0});Ii.default=void 0;var Qd=Xd(He);function Xd(t){return t&&t.__esModule?t:{default:t}}function Zd(t){if(!(0,Qd.default)(t))throw TypeError("Invalid UUID");return parseInt(t.slice(14,15),16)}var Yd=Zd;Ii.default=Yd;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"NIL",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"parse",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"stringify",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"v1",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(t,"v3",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"v4",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"v5",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"validate",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return n.default}});var e=u(li),r=u(gi),o=u(Ci),p=u(Pi),a=u(Ei),n=u(Ii),i=u(He),s=u(Ae),c=u(Kr);function u(d){return d&&d.__esModule?d:{default:d}}})(pc);Object.defineProperty(ae,"__esModule",{value:!0});ae.createNoDashGuid=ae.createGuid=void 0;const eh=pc,mc=()=>(0,eh.v4)();ae.createGuid=mc;const th=()=>mc().replace(new RegExp("-","g"),"").toUpperCase();ae.createNoDashGuid=th;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PlatformEvent=t.EventType=void 0;const e=ae;(function(o){o[o.Debug=0]="Debug",o[o.Info=1]="Info",o[o.Warning=2]="Warning",o[o.Error=3]="Error",o[o.None=4]="None"})(t.EventType||(t.EventType={}));class r{constructor(p,a){this.privName=p,this.privEventId=(0,e.createNoDashGuid)(),this.privEventTime=new Date().toISOString(),this.privEventType=a,this.privMetadata={}}get name(){return this.privName}get eventId(){return this.privEventId}get eventTime(){return this.privEventTime}get eventType(){return this.privEventType}get metadata(){return this.privMetadata}}t.PlatformEvent=r})(et);Object.defineProperty(B,"__esModule",{value:!0});B.AudioStreamNodeErrorEvent=B.AudioStreamNodeDetachedEvent=B.AudioStreamNodeAttachedEvent=B.AudioStreamNodeAttachingEvent=B.AudioStreamNodeEvent=B.AudioSourceErrorEvent=B.AudioSourceOffEvent=B.AudioSourceReadyEvent=B.AudioSourceInitializingEvent=B.AudioSourceEvent=void 0;const Qn=et;class tt extends Qn.PlatformEvent{constructor(e,r,o=Qn.EventType.Info){super(e,o),this.privAudioSourceId=r}get audioSourceId(){return this.privAudioSourceId}}B.AudioSourceEvent=tt;class rh extends tt{constructor(e){super("AudioSourceInitializingEvent",e)}}B.AudioSourceInitializingEvent=rh;class ih extends tt{constructor(e){super("AudioSourceReadyEvent",e)}}B.AudioSourceReadyEvent=ih;class nh extends tt{constructor(e){super("AudioSourceOffEvent",e)}}B.AudioSourceOffEvent=nh;class sh extends tt{constructor(e,r){super("AudioSourceErrorEvent",e,Qn.EventType.Error),this.privError=r}get error(){return this.privError}}B.AudioSourceErrorEvent=sh;class Jr extends tt{constructor(e,r,o){super(e,r),this.privAudioNodeId=o}get audioNodeId(){return this.privAudioNodeId}}B.AudioStreamNodeEvent=Jr;class oh extends Jr{constructor(e,r){super("AudioStreamNodeAttachingEvent",e,r)}}B.AudioStreamNodeAttachingEvent=oh;class ah extends Jr{constructor(e,r){super("AudioStreamNodeAttachedEvent",e,r)}}B.AudioStreamNodeAttachedEvent=ah;class ch extends Jr{constructor(e,r){super("AudioStreamNodeDetachedEvent",e,r)}}B.AudioStreamNodeDetachedEvent=ch;class ph extends Jr{constructor(e,r,o){super("AudioStreamNodeErrorEvent",e,r),this.privError=o}get error(){return this.privError}}B.AudioStreamNodeErrorEvent=ph;var q={};Object.defineProperty(q,"__esModule",{value:!0});q.ConnectionRedirectEvent=q.ConnectionMessageSentEvent=q.ConnectionMessageReceivedEvent=q.ConnectionEstablishErrorEvent=q.ConnectionErrorEvent=q.ConnectionClosedEvent=q.ConnectionEstablishedEvent=q.ConnectionStartEvent=q.ConnectionEvent=q.ServiceEvent=void 0;const Te=et;class uh extends Te.PlatformEvent{constructor(e,r,o=Te.EventType.Info){super(e,o),this.privJsonResult=r}get jsonString(){return this.privJsonResult}}q.ServiceEvent=uh;class me extends Te.PlatformEvent{constructor(e,r,o=Te.EventType.Info){super(e,o),this.privConnectionId=r}get connectionId(){return this.privConnectionId}}q.ConnectionEvent=me;class dh extends me{constructor(e,r,o){super("ConnectionStartEvent",e),this.privUri=r,this.privHeaders=o}get uri(){return this.privUri}get headers(){return this.privHeaders}}q.ConnectionStartEvent=dh;class hh extends me{constructor(e){super("ConnectionEstablishedEvent",e)}}q.ConnectionEstablishedEvent=hh;class lh extends me{constructor(e,r,o){super("ConnectionClosedEvent",e,Te.EventType.Debug),this.privReason=o,this.privStatusCode=r}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}q.ConnectionClosedEvent=lh;class vh extends me{constructor(e,r,o){super("ConnectionErrorEvent",e,Te.EventType.Debug),this.privMessage=r,this.privType=o}get message(){return this.privMessage}get type(){return this.privType}}q.ConnectionErrorEvent=vh;class fh extends me{constructor(e,r,o){super("ConnectionEstablishErrorEvent",e,Te.EventType.Error),this.privStatusCode=r,this.privReason=o}get reason(){return this.privReason}get statusCode(){return this.privStatusCode}}q.ConnectionEstablishErrorEvent=fh;class gh extends me{constructor(e,r,o){super("ConnectionMessageReceivedEvent",e),this.privNetworkReceivedTime=r,this.privMessage=o}get networkReceivedTime(){return this.privNetworkReceivedTime}get message(){return this.privMessage}}q.ConnectionMessageReceivedEvent=gh;class mh extends me{constructor(e,r,o){super("ConnectionMessageSentEvent",e),this.privNetworkSentTime=r,this.privMessage=o}get networkSentTime(){return this.privNetworkSentTime}get message(){return this.privMessage}}q.ConnectionMessageSentEvent=mh;class Sh extends me{constructor(e,r,o,p){super("ConnectionRedirectEvent",e,Te.EventType.Info),this.privRedirectUrl=r,this.privOriginalUrl=o,this.privContext=p}get redirectUrl(){return this.privRedirectUrl}get originalUrl(){return this.privOriginalUrl}get context(){return this.privContext}}q.ConnectionRedirectEvent=Sh;var is={},V={};Object.defineProperty(V,"__esModule",{value:!0});V.ObjectDisposedError=V.InvalidOperationError=V.ArgumentNullError=void 0;class Ch extends Error{constructor(e){super(e),this.name="ArgumentNull",this.message=e}}V.ArgumentNullError=Ch;class yh extends Error{constructor(e){super(e),this.name="InvalidOperation",this.message=e}}V.InvalidOperationError=yh;class Ph extends Error{constructor(e,r){super(r),this.name=e+"ObjectDisposed",this.message=r}}V.ObjectDisposedError=Ph;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionMessage=t.MessageType=void 0;const e=V,r=ae;var o;(function(a){a[a.Text=0]="Text",a[a.Binary=1]="Binary"})(o=t.MessageType||(t.MessageType={}));class p{constructor(n,i,s,c){if(this.privBody=null,n===o.Text&&i&&typeof i!="string")throw new e.InvalidOperationError("Payload must be a string");if(n===o.Binary&&i&&!(i instanceof ArrayBuffer))throw new e.InvalidOperationError("Payload must be ArrayBuffer");switch(this.privMessageType=n,this.privBody=i,this.privHeaders=s||{},this.privId=c||(0,r.createNoDashGuid)(),this.messageType){case o.Binary:this.privSize=this.binaryBody!==null?this.binaryBody.byteLength:0;break;case o.Text:this.privSize=this.textBody.length}}get messageType(){return this.privMessageType}get headers(){return this.privHeaders}get body(){return this.privBody}get textBody(){if(this.privMessageType===o.Binary)throw new e.InvalidOperationError("Not supported for binary message");return this.privBody}get binaryBody(){if(this.privMessageType===o.Text)throw new e.InvalidOperationError("Not supported for text message");return this.privBody}get id(){return this.privId}}t.ConnectionMessage=p})(is);var Ti={};Object.defineProperty(Ti,"__esModule",{value:!0});Ti.ConnectionOpenResponse=void 0;class Rh{constructor(e,r){this.privStatusCode=e,this.privReason=r}get statusCode(){return this.privStatusCode}get reason(){return this.privReason}}Ti.ConnectionOpenResponse=Rh;var Ai={};Object.defineProperty(Ai,"__esModule",{value:!0});Ai.DeferralMap=void 0;class Eh{constructor(){this.privMap={}}add(e,r){this.privMap[e]=r}getId(e){return this.privMap[e]}complete(e,r){try{this.privMap[e].resolve(r)}catch(o){this.privMap[e].reject(o)}finally{this.privMap[e]=void 0}}}Ai.DeferralMap=Eh;var Ve={};Object.defineProperty(Ve,"__esModule",{value:!0});Ve.SendingAgentContextMessageEvent=Ve.DialogEvent=void 0;const js=et;class Sc extends js.PlatformEvent{constructor(e,r=js.EventType.Info){super(e,r)}}Ve.DialogEvent=Sc;class Ih extends Sc{constructor(e){super("SendingAgentContextMessageEvent"),this.privAgentConfig=e}get agentConfig(){return this.privAgentConfig}}Ve.SendingAgentContextMessageEvent=Ih;var wi={},Gr={};Object.defineProperty(Gr,"__esModule",{value:!0});Gr.EventSource=void 0;const Th=V,Ah=ae;class wh{constructor(e){this.privEventListeners={},this.privIsDisposed=!1,this.privConsoleListener=void 0,this.privMetadata=e}onEvent(e){if(this.isDisposed())throw new Th.ObjectDisposedError("EventSource");if(this.metadata)for(const r in this.metadata)r&&e.metadata&&(e.metadata[r]||(e.metadata[r]=this.metadata[r]));for(const r in this.privEventListeners)r&&this.privEventListeners[r]&&this.privEventListeners[r](e)}attach(e){const r=(0,Ah.createNoDashGuid)();return this.privEventListeners[r]=e,{detach:()=>(delete this.privEventListeners[r],Promise.resolve())}}attachListener(e){return this.attach(r=>e.onEvent(r))}attachConsoleListener(e){return this.privConsoleListener&&this.privConsoleListener.detach(),this.privConsoleListener=this.attach(r=>e.onEvent(r)),this.privConsoleListener}isDisposed(){return this.privIsDisposed}dispose(){this.privEventListeners=null,this.privIsDisposed=!0}get metadata(){return this.privMetadata}}Gr.EventSource=wh;Object.defineProperty(wi,"__esModule",{value:!0});wi.Events=void 0;const _h=V,bh=Gr;class Vr{static setEventSource(e){if(!e)throw new _h.ArgumentNullError("eventSource");Vr.privInstance=e}static get instance(){return Vr.privInstance}}wi.Events=Vr;Vr.privInstance=new bh.EventSource;var Cc={};Object.defineProperty(Cc,"__esModule",{value:!0});var yc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionState=void 0,function(e){e[e.None=0]="None",e[e.Connected=1]="Connected",e[e.Connecting=2]="Connecting",e[e.Disconnected=3]="Disconnected"}(t.ConnectionState||(t.ConnectionState={}))})(yc);var Pc={};Object.defineProperty(Pc,"__esModule",{value:!0});var Rc={};Object.defineProperty(Rc,"__esModule",{value:!0});var Ec={};Object.defineProperty(Ec,"__esModule",{value:!0});var Ic={};Object.defineProperty(Ic,"__esModule",{value:!0});var Tc={};Object.defineProperty(Tc,"__esModule",{value:!0});var Ac={};Object.defineProperty(Ac,"__esModule",{value:!0});var wc={};Object.defineProperty(wc,"__esModule",{value:!0});var _c={};Object.defineProperty(_c,"__esModule",{value:!0});var Qr={};Object.defineProperty(Qr,"__esModule",{value:!0});Qr.List=void 0;const Mh=V;class ye{constructor(e){if(this.privSubscriptionIdCounter=0,this.privAddSubscriptions={},this.privRemoveSubscriptions={},this.privDisposedSubscriptions={},this.privDisposeReason=null,this.privList=[],e)for(const r of e)this.privList.push(r)}get(e){return this.throwIfDisposed(),this.privList[e]}first(){return this.get(0)}last(){return this.get(this.length()-1)}add(e){this.throwIfDisposed(),this.insertAt(this.privList.length,e)}insertAt(e,r){this.throwIfDisposed(),e===0?this.privList.unshift(r):e===this.privList.length?this.privList.push(r):this.privList.splice(e,0,r),this.triggerSubscriptions(this.privAddSubscriptions)}removeFirst(){return this.throwIfDisposed(),this.removeAt(0)}removeLast(){return this.throwIfDisposed(),this.removeAt(this.length()-1)}removeAt(e){return this.throwIfDisposed(),this.remove(e,1)[0]}remove(e,r){this.throwIfDisposed();const o=this.privList.splice(e,r);return this.triggerSubscriptions(this.privRemoveSubscriptions),o}clear(){this.throwIfDisposed(),this.remove(0,this.length())}length(){return this.throwIfDisposed(),this.privList.length}onAdded(e){this.throwIfDisposed();const r=this.privSubscriptionIdCounter++;return this.privAddSubscriptions[r]=e,{detach:()=>(delete this.privAddSubscriptions[r],Promise.resolve())}}onRemoved(e){this.throwIfDisposed();const r=this.privSubscriptionIdCounter++;return this.privRemoveSubscriptions[r]=e,{detach:()=>(delete this.privRemoveSubscriptions[r],Promise.resolve())}}onDisposed(e){this.throwIfDisposed();const r=this.privSubscriptionIdCounter++;return this.privDisposedSubscriptions[r]=e,{detach:()=>(delete this.privDisposedSubscriptions[r],Promise.resolve())}}join(e){return this.throwIfDisposed(),this.privList.join(e)}toArray(){const e=Array();return this.privList.forEach(r=>{e.push(r)}),e}any(e){return this.throwIfDisposed(),e?this.where(e).length()>0:this.length()>0}all(e){return this.throwIfDisposed(),this.where(e).length()===this.length()}forEach(e){this.throwIfDisposed();for(let r=0;r<this.length();r++)e(this.privList[r],r)}select(e){this.throwIfDisposed();const r=[];for(let o=0;o<this.privList.length;o++)r.push(e(this.privList[o],o));return new ye(r)}where(e){this.throwIfDisposed();const r=new ye;for(let o=0;o<this.privList.length;o++)e(this.privList[o],o)&&r.add(this.privList[o]);return r}orderBy(e){this.throwIfDisposed();const o=this.toArray().sort(e);return new ye(o)}orderByDesc(e){return this.throwIfDisposed(),this.orderBy((r,o)=>e(o,r))}clone(){return this.throwIfDisposed(),new ye(this.toArray())}concat(e){return this.throwIfDisposed(),new ye(this.privList.concat(e.toArray()))}concatArray(e){return this.throwIfDisposed(),new ye(this.privList.concat(e))}isDisposed(){return this.privList==null}dispose(e){this.isDisposed()||(this.privDisposeReason=e,this.privList=null,this.privAddSubscriptions=null,this.privRemoveSubscriptions=null,this.triggerSubscriptions(this.privDisposedSubscriptions))}throwIfDisposed(){if(this.isDisposed())throw new Mh.ObjectDisposedError("List",this.privDisposeReason)}triggerSubscriptions(e){if(e)for(const r in e)r&&e[r]()}}Qr.List=ye;var ns={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.marshalPromiseToCallbacks=t.Sink=t.Deferred=t.PromiseResultEventSource=t.PromiseResult=t.PromiseState=void 0;var e;(function(i){i[i.None=0]="None",i[i.Resolved=1]="Resolved",i[i.Rejected=2]="Rejected"})(e=t.PromiseState||(t.PromiseState={}));class r{constructor(s){this.throwIfError=()=>{if(this.isError)throw this.error},s.on(c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!1,this.privResult=c)},c=>{this.privIsCompleted||(this.privIsCompleted=!0,this.privIsError=!0,this.privError=c)})}get isCompleted(){return this.privIsCompleted}get isError(){return this.privIsError}get error(){return this.privError}get result(){return this.privResult}}t.PromiseResult=r;class o{constructor(){this.setResult=s=>{this.privOnSetResult(s)},this.setError=s=>{this.privOnSetError(s)},this.on=(s,c)=>{this.privOnSetResult=s,this.privOnSetError=c}}}t.PromiseResultEventSource=o;class p{constructor(){this.resolve=s=>(this.privResolve(s),this),this.reject=s=>(this.privReject(s),this),this.privPromise=new Promise((s,c)=>{this.privResolve=s,this.privReject=c})}get promise(){return this.privPromise}}t.Deferred=p;class a{constructor(){this.privState=e.None,this.privPromiseResult=null,this.privPromiseResultEvents=null,this.privSuccessHandlers=[],this.privErrorHandlers=[],this.privPromiseResultEvents=new o,this.privPromiseResult=new r(this.privPromiseResultEvents)}get state(){return this.privState}get result(){return this.privPromiseResult}resolve(s){if(this.privState!==e.None)throw new Error("'Cannot resolve a completed promise'");this.privState=e.Resolved,this.privPromiseResultEvents.setResult(s);for(let c=0;c<this.privSuccessHandlers.length;c++)this.executeSuccessCallback(s,this.privSuccessHandlers[c],this.privErrorHandlers[c]);this.detachHandlers()}reject(s){if(this.privState!==e.None)throw new Error("'Cannot reject a completed promise'");this.privState=e.Rejected,this.privPromiseResultEvents.setError(s);for(const c of this.privErrorHandlers)this.executeErrorCallback(s,c);this.detachHandlers()}on(s,c){s==null&&(s=()=>{}),this.privState===e.None?(this.privSuccessHandlers.push(s),this.privErrorHandlers.push(c)):(this.privState===e.Resolved?this.executeSuccessCallback(this.privPromiseResult.result,s,c):this.privState===e.Rejected&&this.executeErrorCallback(this.privPromiseResult.error,c),this.detachHandlers())}executeSuccessCallback(s,c,u){try{c(s)}catch(d){this.executeErrorCallback(`'Unhandled callback error: ${d}'`,u)}}executeErrorCallback(s,c){if(c)try{c(s)}catch(u){throw new Error(`'Unhandled callback error: ${u}. InnerError: ${s}'`)}else throw new Error(`'Unhandled error: ${s}'`)}detachHandlers(){this.privErrorHandlers=[],this.privSuccessHandlers=[]}}t.Sink=a;function n(i,s,c){i.then(u=>{try{s&&s(u)}catch(d){if(c)try{if(d instanceof Error){const h=d;c(h.name+": "+h.message)}else c(d)}catch{}}},u=>{if(c)try{if(u instanceof Error){const d=u;c(d.name+": "+d.message)}else c(u)}catch{}})}t.marshalPromiseToCallbacks=n})(ns);var Xr={};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.Queue=void 0;const zn=V,jn=Qr,Ls=ns;var Wr;(function(t){t[t.Dequeue=0]="Dequeue",t[t.Peek=1]="Peek"})(Wr||(Wr={}));class Oh{constructor(e){this.privPromiseStore=new jn.List,this.privIsDrainInProgress=!1,this.privIsDisposing=!1,this.privDisposeReason=null,this.privList=e||new jn.List,this.privDetachables=[],this.privSubscribers=new jn.List,this.privDetachables.push(this.privList.onAdded(()=>this.drain()))}enqueue(e){this.throwIfDispose(),this.enqueueFromPromise(new Promise(r=>r(e)))}enqueueFromPromise(e){this.throwIfDispose(),e.then(r=>{this.privList.add(r)},()=>{})}dequeue(){this.throwIfDispose();const e=new Ls.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:Wr.Dequeue}),this.drain()),e.promise}peek(){this.throwIfDispose();const e=new Ls.Deferred;return this.privSubscribers&&(this.privSubscribers.add({deferral:e,type:Wr.Peek}),this.drain()),e.promise}length(){return this.throwIfDispose(),this.privList.length()}isDisposed(){return this.privSubscribers==null}async drainAndDispose(e,r){if(!this.isDisposed()&&!this.privIsDisposing){this.privDisposeReason=r,this.privIsDisposing=!0;const o=this.privSubscribers;if(o){for(;o.length()>0;)o.removeFirst().deferral.resolve(void 0);this.privSubscribers===o&&(this.privSubscribers=o)}for(const p of this.privDetachables)await p.detach();if(this.privPromiseStore.length()>0&&e){const p=[];return this.privPromiseStore.toArray().forEach(a=>{p.push(a)}),Promise.all(p).finally(()=>{this.privSubscribers=null,this.privList.forEach(a=>{e(a)}),this.privList=null}).then()}else this.privSubscribers=null,this.privList=null}}async dispose(e){await this.drainAndDispose(null,e)}drain(){if(!this.privIsDrainInProgress&&!this.privIsDisposing){this.privIsDrainInProgress=!0;const e=this.privSubscribers,r=this.privList;if(e&&r){for(;r.length()>0&&e.length()>0&&!this.privIsDisposing;){const o=e.removeFirst();if(o.type===Wr.Peek)o.deferral.resolve(r.first());else{const p=r.removeFirst();o.deferral.resolve(p)}}this.privSubscribers===e&&(this.privSubscribers=e),this.privList===r&&(this.privList=r)}this.privIsDrainInProgress=!1}}throwIfDispose(){if(this.isDisposed())throw this.privDisposeReason?new zn.InvalidOperationError(this.privDisposeReason):new zn.ObjectDisposedError("Queue");if(this.privIsDisposing)throw new zn.InvalidOperationError("Queue disposing")}}Xr.Queue=Oh;var _i={};Object.defineProperty(_i,"__esModule",{value:!0});_i.RawWebsocketMessage=void 0;const oi=is,nt=V,Dh=ae;class kh{constructor(e,r,o){if(this.privPayload=null,!r)throw new nt.ArgumentNullError("payload");if(e===oi.MessageType.Binary&&Object.getPrototypeOf(r).constructor.name!=="ArrayBuffer")throw new nt.InvalidOperationError("Payload must be ArrayBuffer");if(e===oi.MessageType.Text&&typeof r!="string")throw new nt.InvalidOperationError("Payload must be a string");this.privMessageType=e,this.privPayload=r,this.privId=o||(0,Dh.createNoDashGuid)()}get messageType(){return this.privMessageType}get payload(){return this.privPayload}get textContent(){if(this.privMessageType===oi.MessageType.Binary)throw new nt.InvalidOperationError("Not supported for binary message");return this.privPayload}get binaryContent(){if(this.privMessageType===oi.MessageType.Text)throw new nt.InvalidOperationError("Not supported for text message");return this.privPayload}get id(){return this.privId}}_i.RawWebsocketMessage=kh;var bi={};Object.defineProperty(bi,"__esModule",{value:!0});bi.RiffPcmEncoder=void 0;class Nh{constructor(e,r){this.privActualSampleRate=e,this.privDesiredSampleRate=r}encode(e){const r=this.downSampleAudioFrame(e,this.privActualSampleRate,this.privDesiredSampleRate);if(!r)return null;const o=r.length*2,p=new ArrayBuffer(o),a=new DataView(p);return this.floatTo16BitPCM(a,0,r),p}setString(e,r,o){for(let p=0;p<o.length;p++)e.setUint8(r+p,o.charCodeAt(p))}floatTo16BitPCM(e,r,o){for(let p=0;p<o.length;p++,r+=2){const a=Math.max(-1,Math.min(1,o[p]));e.setInt16(r,a<0?a*32768:a*32767,!0)}}downSampleAudioFrame(e,r,o){if(!e)return null;if(o===r||o>r)return e;const p=r/o,a=Math.round(e.length/p),n=new Float32Array(a);let i=0,s=0;for(;s<a;){const c=Math.round((s+1)*p);let u=0,d=0;for(;i<c&&i<e.length;)u+=e[i++],d++;n[s++]=u/d}return n}}bi.RiffPcmEncoder=Nh;var Mi={};Object.defineProperty(Mi,"__esModule",{value:!0});Mi.Stream=void 0;const Bs=V,zh=ae,qs=Xr;class jh{constructor(e){this.privIsWriteEnded=!1,this.privIsReadEnded=!1,this.privId=e||(0,zh.createNoDashGuid)(),this.privReaderQueue=new qs.Queue}get isClosed(){return this.privIsWriteEnded}get isReadEnded(){return this.privIsReadEnded}get id(){return this.privId}close(){this.privIsWriteEnded||(this.writeStreamChunk({buffer:null,isEnd:!0,timeReceived:Date.now()}),this.privIsWriteEnded=!0)}writeStreamChunk(e){if(this.throwIfClosed(),!this.privReaderQueue.isDisposed())try{this.privReaderQueue.enqueue(e)}catch{}}read(){if(this.privIsReadEnded)throw new Bs.InvalidOperationError("Stream read has already finished");return this.privReaderQueue.dequeue().then(async e=>((e===void 0||e.isEnd)&&await this.privReaderQueue.dispose("End of stream reached"),e))}readEnded(){this.privIsReadEnded||(this.privIsReadEnded=!0,this.privReaderQueue=new qs.Queue)}throwIfClosed(){if(this.privIsWriteEnded)throw new Bs.InvalidOperationError("Stream closed")}}Mi.Stream=jh;var Oi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TranslationStatus=void 0,function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(t.TranslationStatus||(t.TranslationStatus={}))})(Oi);var st={},Fs;function Lh(){if(Fs)return st;Fs=1,Object.defineProperty(st,"__esModule",{value:!0}),st.ChunkedArrayBufferStream=void 0;const t=A();let e=class extends t.Stream{constructor(o,p){super(p),this.privTargetChunkSize=Math.round(o),this.privNextBufferReadyBytes=0}writeStreamChunk(o){if(o.isEnd||this.privNextBufferReadyBytes===0&&o.buffer.byteLength===this.privTargetChunkSize){super.writeStreamChunk(o);return}let p=0;for(;p<o.buffer.byteLength;){this.privNextBufferToWrite===void 0&&(this.privNextBufferToWrite=new ArrayBuffer(this.privTargetChunkSize),this.privNextBufferStartTime=o.timeReceived);const a=Math.min(o.buffer.byteLength-p,this.privTargetChunkSize-this.privNextBufferReadyBytes),n=new Uint8Array(this.privNextBufferToWrite),i=new Uint8Array(o.buffer.slice(p,a+p));n.set(i,this.privNextBufferReadyBytes),this.privNextBufferReadyBytes+=a,p+=a,this.privNextBufferReadyBytes===this.privTargetChunkSize&&(super.writeStreamChunk({buffer:this.privNextBufferToWrite,isEnd:!1,timeReceived:this.privNextBufferStartTime}),this.privNextBufferReadyBytes=0,this.privNextBufferToWrite=void 0)}}close(){this.privNextBufferReadyBytes!==0&&!this.isClosed&&super.writeStreamChunk({buffer:this.privNextBufferToWrite.slice(0,this.privNextBufferReadyBytes),isEnd:!1,timeReceived:this.privNextBufferStartTime}),super.close()}};return st.ChunkedArrayBufferStream=e,st}var bc={};Object.defineProperty(bc,"__esModule",{value:!0});var Di={};Object.defineProperty(Di,"__esModule",{value:!0});Di.Timeout=void 0;class X{static load(){const e=new Map([[0,()=>{}]]),r=new Map,p="data:text/javascript;base64,"+btoa(`!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=14)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return u})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return d}));const r=new Map,o=new Map,i=e=>{const t=r.get(e);if(void 0===t)throw new Error('There is no interval scheduled with the given id "'.concat(e,'".'));clearTimeout(t),r.delete(e)},u=e=>{const t=o.get(e);if(void 0===t)throw new Error('There is no timeout scheduled with the given id "'.concat(e,'".'));clearTimeout(t),o.delete(e)},f=(e,t)=>{let n,r;if("performance"in self){const o=performance.now();n=o,r=e-Math.max(0,o-t)}else n=Date.now(),r=e;return{expected:n+r,remainingDelay:r}},c=(e,t,n,r)=>{const o="performance"in self?performance.now():Date.now();o>n?postMessage({id:null,method:"call",params:{timerId:t}}):e.set(t,setTimeout(c,n-o,e,t,n))},a=(e,t,n)=>{const{expected:o,remainingDelay:i}=f(e,n);r.set(t,setTimeout(c,i,r,t,o))},d=(e,t,n)=>{const{expected:r,remainingDelay:i}=f(e,n);o.set(t,setTimeout(c,i,o,t,r))}},function(e,t,n){"use strict";n.r(t);var r=n(2);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(3);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(4);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o);var f=n(5);for(var o in f)"default"!==o&&function(e){n.d(t,e,(function(){return f[e]}))}(o);var c=n(6);for(var o in c)"default"!==o&&function(e){n.d(t,e,(function(){return c[e]}))}(o);var a=n(7);for(var o in a)"default"!==o&&function(e){n.d(t,e,(function(){return a[e]}))}(o);var d=n(8);for(var o in d)"default"!==o&&function(e){n.d(t,e,(function(){return d[e]}))}(o);var s=n(9);for(var o in s)"default"!==o&&function(e){n.d(t,e,(function(){return s[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(11);for(var o in r)"default"!==o&&function(e){n.d(t,e,(function(){return r[e]}))}(o);var i=n(12);for(var o in i)"default"!==o&&function(e){n.d(t,e,(function(){return i[e]}))}(o);var u=n(13);for(var o in u)"default"!==o&&function(e){n.d(t,e,(function(){return u[e]}))}(o)},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1);for(var i in o)"default"!==i&&function(e){n.d(t,e,(function(){return o[e]}))}(i);var u=n(10);for(var i in u)"default"!==i&&function(e){n.d(t,e,(function(){return u[e]}))}(i);addEventListener("message",({data:e})=>{try{if("clear"===e.method){const{id:t,params:{timerId:n}}=e;Object(r.b)(n),postMessage({error:null,id:t})}else{if("set"!==e.method)throw new Error('The given method "'.concat(e.method,'" is not supported'));{const{params:{delay:t,now:n,timerId:o}}=e;Object(r.d)(t,o,n)}}}catch(t){postMessage({error:{message:t.message},id:e.id,result:null})}})}]);`),a=new Worker(p);return a.addEventListener("message",({data:s})=>{if(X.isCallNotification(s)){const{params:{timerId:c}}=s,u=e.get(c);if(typeof u=="number"){const d=r.get(u);if(d===void 0||d!==c)throw new Error("The timer is in an undefined state.")}else if(typeof u<"u")u(),e.delete(c);else throw new Error("The timer is in an undefined state.")}else if(X.isClearResponse(s)){const{id:c}=s,u=r.get(c);if(u===void 0)throw new Error("The timer is in an undefined state.");r.delete(c),e.delete(u)}else{const{error:{message:c}}=s;throw new Error(c)}}),{clearTimeout:s=>{const c=Math.random();r.set(c,s),e.set(s,c),a.postMessage({id:c,method:"clear",params:{timerId:s}})},setTimeout:(s,c)=>{const u=Math.random();return e.set(u,s),a.postMessage({id:null,method:"set",params:{delay:c,now:performance.now(),timerId:u}}),u}}}static loadWorkerTimers(){return()=>(X.workerTimers!==null||(X.workerTimers=X.load()),X.workerTimers)}static isCallNotification(e){return e.method!==void 0&&e.method==="call"}static isClearResponse(e){return e.error===null&&typeof e.id=="number"}}Di.Timeout=X;X.workerTimers=null;X.clearTimeout=t=>X.timers().clearTimeout(t);X.setTimeout=(t,e)=>X.timers().setTimeout(t,e);X.timers=X.loadWorkerTimers();var N={};Object.defineProperty(N,"__esModule",{value:!0});N.OCSPCacheUpdateErrorEvent=N.OCSPResponseRetrievedEvent=N.OCSPCacheFetchErrorEvent=N.OCSPVerificationFailedEvent=N.OCSPCacheHitEvent=N.OCSPCacheEntryNeedsRefreshEvent=N.OCSPCacheEntryExpiredEvent=N.OCSPWSUpgradeStartedEvent=N.OCSPStapleReceivedEvent=N.OCSPCacheUpdateCompleteEvent=N.OCSPDiskCacheStoreEvent=N.OCSPMemoryCacheStoreEvent=N.OCSPCacheUpdateNeededEvent=N.OCSPDiskCacheHitEvent=N.OCSPCacheMissEvent=N.OCSPMemoryCacheHitEvent=N.OCSPEvent=void 0;const H=et;class $ extends H.PlatformEvent{constructor(e,r,o){super(e,r),this.privSignature=o}}N.OCSPEvent=$;class Bh extends ${constructor(e){super("OCSPMemoryCacheHitEvent",H.EventType.Debug,e)}}N.OCSPMemoryCacheHitEvent=Bh;class qh extends ${constructor(e){super("OCSPCacheMissEvent",H.EventType.Debug,e)}}N.OCSPCacheMissEvent=qh;class Fh extends ${constructor(e){super("OCSPDiskCacheHitEvent",H.EventType.Debug,e)}}N.OCSPDiskCacheHitEvent=Fh;class xh extends ${constructor(e){super("OCSPCacheUpdateNeededEvent",H.EventType.Debug,e)}}N.OCSPCacheUpdateNeededEvent=xh;class Uh extends ${constructor(e){super("OCSPMemoryCacheStoreEvent",H.EventType.Debug,e)}}N.OCSPMemoryCacheStoreEvent=Uh;class Wh extends ${constructor(e){super("OCSPDiskCacheStoreEvent",H.EventType.Debug,e)}}N.OCSPDiskCacheStoreEvent=Wh;class Vh extends ${constructor(e){super("OCSPCacheUpdateCompleteEvent",H.EventType.Debug,e)}}N.OCSPCacheUpdateCompleteEvent=Vh;class Hh extends ${constructor(){super("OCSPStapleReceivedEvent",H.EventType.Debug,"")}}N.OCSPStapleReceivedEvent=Hh;class $h extends ${constructor(e){super("OCSPWSUpgradeStartedEvent",H.EventType.Debug,e)}}N.OCSPWSUpgradeStartedEvent=$h;class Kh extends ${constructor(e,r){super("OCSPCacheEntryExpiredEvent",H.EventType.Debug,e),this.privExpireTime=r}}N.OCSPCacheEntryExpiredEvent=Kh;class Jh extends ${constructor(e,r,o){super("OCSPCacheEntryNeedsRefreshEvent",H.EventType.Debug,e),this.privExpireTime=o,this.privStartTime=r}}N.OCSPCacheEntryNeedsRefreshEvent=Jh;class Gh extends ${constructor(e,r,o){super("OCSPCacheHitEvent",H.EventType.Debug,e),this.privExpireTime=o,this.privExpireTimeString=new Date(o).toLocaleDateString(),this.privStartTime=r,this.privStartTimeString=new Date(r).toLocaleTimeString()}}N.OCSPCacheHitEvent=Gh;class Qh extends ${constructor(e,r){super("OCSPVerificationFailedEvent",H.EventType.Debug,e),this.privError=r}}N.OCSPVerificationFailedEvent=Qh;class Xh extends ${constructor(e,r){super("OCSPCacheFetchErrorEvent",H.EventType.Debug,e),this.privError=r}}N.OCSPCacheFetchErrorEvent=Xh;class Zh extends ${constructor(e){super("OCSPResponseRetrievedEvent",H.EventType.Debug,e)}}N.OCSPResponseRetrievedEvent=Zh;class Yh extends ${constructor(e,r){super("OCSPCacheUpdateErrorEvent",H.EventType.Debug,e),this.privError=r}}N.OCSPCacheUpdateErrorEvent=Yh;var ot={},xs;function el(){if(xs)return ot;xs=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.BackgroundEvent=void 0;const t=A();class e extends t.PlatformEvent{constructor(o){super("BackgroundEvent",t.EventType.Error),this.privError=o}get error(){return this.privError}}return ot.BackgroundEvent=e,ot}var Us;function A(){return Us||(Us=1,function(t){var e=k&&k.__createBinding||(Object.create?function(p,a,n,i){i===void 0&&(i=n),Object.defineProperty(p,i,{enumerable:!0,get:function(){return a[n]}})}:function(p,a,n,i){i===void 0&&(i=n),p[i]=a[n]}),r=k&&k.__exportStar||function(p,a){for(var n in p)n!=="default"&&!Object.prototype.hasOwnProperty.call(a,n)&&e(a,p,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.TranslationStatus=void 0,r(B,t),r(q,t),r(is,t),r(Ti,t),r(Ai,t),r(Ve,t),r(V,t),r(wi,t),r(Gr,t),r(ae,t),r(Cc,t),r(yc,t),r(Pc,t),r(Rc,t),r(Ec,t),r(Ic,t),r(Tc,t),r(Ac,t),r(wc,t),r(_c,t),r(Qr,t),r(et,t),r(ns,t),r(Xr,t),r(_i,t),r(bi,t),r(Mi,t);var o=Oi;Object.defineProperty(t,"TranslationStatus",{enumerable:!0,get:function(){return o.TranslationStatus}}),r(Lh(),t),r(bc,t),r(Di,t),r(N,t),r(el(),t)}(Mn)),Mn}var F={};Object.defineProperty(F,"__esModule",{value:!0});F.HeaderNames=void 0;class ce{}F.HeaderNames=ce;ce.AuthKey="Ocp-Apim-Subscription-Key";ce.Authorization="Authorization";ce.SpIDAuthKey="Apim-Subscription-Id";ce.ConnectionId="X-ConnectionId";ce.ContentType="Content-Type";ce.CustomCommandsAppId="X-CommandsAppId";ce.Path="Path";ce.RequestId="X-RequestId";ce.RequestStreamId="X-StreamId";ce.RequestTimestamp="X-Timestamp";var rt={};Object.defineProperty(rt,"__esModule",{value:!0});rt.AuthInfo=void 0;class tl{constructor(e,r){this.privHeaderName=e,this.privToken=r}get headerName(){return this.privHeaderName}get token(){return this.privToken}}rt.AuthInfo=tl;Object.defineProperty(hi,"__esModule",{value:!0});hi.CognitiveSubscriptionKeyAuthentication=void 0;const rl=A(),il=F,nl=rt;class sl{constructor(e){if(!e)throw new rl.ArgumentNullError("subscriptionKey");this.privAuthInfo=new nl.AuthInfo(il.HeaderNames.AuthKey,e)}fetch(e){return Promise.resolve(this.privAuthInfo)}fetchOnExpiry(e){return Promise.resolve(this.privAuthInfo)}}hi.CognitiveSubscriptionKeyAuthentication=sl;var ki={};Object.defineProperty(ki,"__esModule",{value:!0});ki.CognitiveTokenAuthentication=void 0;const Ws=A(),Vs=rt,Hs=F;class Hr{constructor(e,r){if(!e)throw new Ws.ArgumentNullError("fetchCallback");if(!r)throw new Ws.ArgumentNullError("fetchOnExpiryCallback");this.privFetchCallback=e,this.privFetchOnExpiryCallback=r}fetch(e){return this.privFetchCallback(e).then(r=>new Vs.AuthInfo(Hs.HeaderNames.Authorization,r===void 0?void 0:Hr.privTokenPrefix+r))}fetchOnExpiry(e){return this.privFetchOnExpiryCallback(e).then(r=>new Vs.AuthInfo(Hs.HeaderNames.Authorization,r===void 0?void 0:Hr.privTokenPrefix+r))}}ki.CognitiveTokenAuthentication=Hr;Hr.privTokenPrefix="Bearer ";var Mc={};Object.defineProperty(Mc,"__esModule",{value:!0});var Oc={};Object.defineProperty(Oc,"__esModule",{value:!0});var at={},Ln={},Ni={};const ol={},al=Object.freeze(Object.defineProperty({__proto__:null,default:ol},Symbol.toStringTag,{value:"Module"})),$e=Zu(al);var ss={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0;const e=A();Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return e.EventType}})})(ss);var b={};Object.defineProperty(b,"__esModule",{value:!0});b.Contracts=void 0;class Pe{static throwIfNullOrUndefined(e,r){if(e==null)throw new Error("throwIfNullOrUndefined:"+r)}static throwIfNull(e,r){if(e===null)throw new Error("throwIfNull:"+r)}static throwIfNullOrWhitespace(e,r){if(Pe.throwIfNullOrUndefined(e,r),(""+e).trim().length<1)throw new Error("throwIfNullOrWhitespace:"+r)}static throwIfNullOrTooLong(e,r,o){if(Pe.throwIfNullOrUndefined(e,r),(""+e).length>o)throw new Error("throwIfNullOrTooLong:"+r+" (more than "+o.toString()+" characters)")}static throwIfNullOrTooShort(e,r,o){if(Pe.throwIfNullOrUndefined(e,r),(""+e).length<o)throw new Error("throwIfNullOrTooShort:"+r+" (less than "+o.toString()+" characters)")}static throwIfDisposed(e){if(e)throw new Error("the object is already disposed")}static throwIfArrayEmptyOrWhitespace(e,r){if(Pe.throwIfNullOrUndefined(e,r),e.length===0)throw new Error("throwIfArrayEmptyOrWhitespace:"+r);for(const o of e)Pe.throwIfNullOrWhitespace(o,r)}static throwIfFileDoesNotExist(e,r){Pe.throwIfNullOrWhitespace(e,r)}static throwIfNotUndefined(e,r){if(e!==void 0)throw new Error("throwIfNotUndefined:"+r)}}b.Contracts=Pe;var cl=k&&k.__createBinding||(Object.create?function(t,e,r,o){o===void 0&&(o=r),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,o){o===void 0&&(o=r),t[o]=e[r]}),pl=k&&k.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),ul=k&&k.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&cl(e,t,r);return pl(e,t),e};Object.defineProperty(Ni,"__esModule",{value:!0});Ni.ConsoleLoggingListener=void 0;const $s=ul($e),ct=ss,dl=b;class hl{constructor(e=ct.LogLevel.None){this.privLogPath=void 0,this.privEnableConsoleOutput=!0,this.privLogLevelFilter=e}set logPath(e){dl.Contracts.throwIfNullOrUndefined($s.openSync,`
File System access not available`),this.privLogPath=e}set enableConsoleOutput(e){this.privEnableConsoleOutput=e}onEvent(e){if(e.eventType>=this.privLogLevelFilter){const r=this.toString(e);if(this.logCallback&&this.logCallback(r),this.privLogPath&&$s.writeFileSync(this.privLogPath,r+`
`,{flag:"a+"}),this.privEnableConsoleOutput)switch(e.eventType){case ct.LogLevel.Debug:console.debug(r);break;case ct.LogLevel.Info:console.info(r);break;case ct.LogLevel.Warning:console.warn(r);break;case ct.LogLevel.Error:console.error(r);break;default:console.log(r);break}}}toString(e){const r=[`${e.eventTime}`,`${e.name}`],o=e;for(const p in o)if(p&&e.hasOwnProperty(p)&&p!=="eventTime"&&p!=="eventType"&&p!=="eventId"&&p!=="name"&&p!=="constructor"){const a=o[p];let n="<NULL>";a!=null&&(typeof a=="number"||typeof a=="string"?n=a.toString():n=JSON.stringify(a)),r.push(`${p}: ${n}`)}return r.join(" | ")}}Ni.ConsoleLoggingListener=hl;var Dc={};Object.defineProperty(Dc,"__esModule",{value:!0});var Bn={},we={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AudioStreamFormatImpl=t.AudioStreamFormat=t.AudioFormatTag=void 0;var e;(function(p){p[p.PCM=1]="PCM",p[p.MuLaw=2]="MuLaw",p[p.Siren=3]="Siren",p[p.MP3=4]="MP3",p[p.SILKSkype=5]="SILKSkype",p[p.OGG_OPUS=6]="OGG_OPUS",p[p.WEBM_OPUS=7]="WEBM_OPUS",p[p.ALaw=8]="ALaw",p[p.FLAC=9]="FLAC",p[p.OPUS=10]="OPUS",p[p.AMR_WB=11]="AMR_WB",p[p.G722=12]="G722"})(e=t.AudioFormatTag||(t.AudioFormatTag={}));class r{static getDefaultInputFormat(){return o.getDefaultInputFormat()}static getWaveFormat(a,n,i,s){return new o(a,n,i,s)}static getWaveFormatPCM(a,n,i){return new o(a,n,i)}}t.AudioStreamFormat=r;class o extends r{constructor(a=16e3,n=16,i=1,s=e.PCM){super();let c=!0;switch(s){case e.PCM:this.formatTag=1;break;case e.ALaw:this.formatTag=6;break;case e.MuLaw:this.formatTag=7;break;default:c=!1}if(this.bitsPerSample=n,this.samplesPerSec=a,this.channels=i,this.avgBytesPerSec=this.samplesPerSec*this.channels*(this.bitsPerSample/8),this.blockAlign=this.channels*Math.max(this.bitsPerSample,8),c){this.privHeader=new ArrayBuffer(44);const u=new DataView(this.privHeader);this.setString(u,0,"RIFF"),u.setUint32(4,0,!0),this.setString(u,8,"WAVEfmt "),u.setUint32(16,16,!0),u.setUint16(20,this.formatTag,!0),u.setUint16(22,this.channels,!0),u.setUint32(24,this.samplesPerSec,!0),u.setUint32(28,this.avgBytesPerSec,!0),u.setUint16(32,this.channels*(this.bitsPerSample/8),!0),u.setUint16(34,this.bitsPerSample,!0),this.setString(u,36,"data"),u.setUint32(40,0,!0)}}static getDefaultInputFormat(){return new o}static getAudioContext(a){const n=window.AudioContext||window.webkitAudioContext||!1;if(n)return a!==void 0&&navigator.mediaDevices.getSupportedConstraints().sampleRate?new n({sampleRate:a}):new n;throw new Error("Browser does not support Web Audio API (AudioContext is not available).")}close(){}get header(){return this.privHeader}setString(a,n,i){for(let s=0;s<i.length;s++)a.setUint8(n+s,i.charCodeAt(s))}}t.AudioStreamFormatImpl=o})(we);var Ks;function ll(){return Ks||(Ks=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.MicAudioSource=t.AudioWorkletSourceURLPropertyName=void 0;const e=T(),r=A(),o=we;t.AudioWorkletSourceURLPropertyName="MICROPHONE-WorkletSourceUrl";class p{constructor(n,i,s,c){this.privRecorder=n,this.deviceId=i,this.privStreams={},this.privOutputChunkSize=p.AUDIOFORMAT.avgBytesPerSec/10,this.privId=s||(0,r.createNoDashGuid)(),this.privEvents=new r.EventSource,this.privMediaStream=c||null,this.privIsClosing=!1}get format(){return Promise.resolve(p.AUDIOFORMAT)}turnOn(){if(this.privInitializeDeferral)return this.privInitializeDeferral.promise;this.privInitializeDeferral=new r.Deferred;try{this.createAudioContext()}catch(s){if(s instanceof Error){const c=s;this.privInitializeDeferral.reject(c.name+": "+c.message)}else this.privInitializeDeferral.reject(s);return this.privInitializeDeferral.promise}const n=window.navigator;let i=n.getUserMedia||n.webkitGetUserMedia||n.mozGetUserMedia||n.msGetUserMedia;if(n.mediaDevices&&(i=(s,c,u)=>{n.mediaDevices.getUserMedia(s).then(c).catch(u)}),i){const s=()=>{this.onEvent(new r.AudioSourceInitializingEvent(this.privId)),this.privMediaStream&&this.privMediaStream.active?(this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()):i({audio:this.deviceId?{deviceId:this.deviceId}:!0,video:!1},c=>{this.privMediaStream=c,this.onEvent(new r.AudioSourceReadyEvent(this.privId)),this.privInitializeDeferral.resolve()},c=>{const u=`Error occurred during microphone initialization: ${c}`;this.privInitializeDeferral.reject(u),this.onEvent(new r.AudioSourceErrorEvent(this.privId,u))})};this.privContext.state==="suspended"?this.privContext.resume().then(s).catch(c=>{this.privInitializeDeferral.reject(`Failed to initialize audio context: ${c}`)}):s()}else{const s="Browser does not support getUserMedia.";this.privInitializeDeferral.reject(s),this.onEvent(new r.AudioSourceErrorEvent(s,""))}return this.privInitializeDeferral.promise}id(){return this.privId}attach(n){return this.onEvent(new r.AudioStreamNodeAttachingEvent(this.privId,n)),this.listen(n).then(i=>(this.onEvent(new r.AudioStreamNodeAttachedEvent(this.privId,n)),{detach:async()=>(i.readEnded(),delete this.privStreams[n],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,n)),this.turnOff()),id:()=>n,read:()=>i.read()}))}detach(n){n&&this.privStreams[n]&&(this.privStreams[n].close(),delete this.privStreams[n],this.onEvent(new r.AudioStreamNodeDetachedEvent(this.privId,n)))}async turnOff(){for(const n in this.privStreams)if(n){const i=this.privStreams[n];i&&i.close()}this.onEvent(new r.AudioSourceOffEvent(this.privId)),this.privInitializeDeferral&&(await this.privInitializeDeferral,this.privInitializeDeferral=null),await this.destroyAudioContext()}get events(){return this.privEvents}get deviceInfo(){return this.getMicrophoneLabel().then(n=>({bitspersample:p.AUDIOFORMAT.bitsPerSample,channelcount:p.AUDIOFORMAT.channels,connectivity:e.connectivity.Unknown,manufacturer:"Speech SDK",model:n,samplerate:p.AUDIOFORMAT.samplesPerSec,type:e.type.Microphones}))}setProperty(n,i){if(n===t.AudioWorkletSourceURLPropertyName)this.privRecorder.setWorkletUrl(i);else throw new Error("Property '"+n+"' is not supported on Microphone.")}getMicrophoneLabel(){const n="microphone";if(this.privMicrophoneLabel!==void 0)return Promise.resolve(this.privMicrophoneLabel);if(this.privMediaStream===void 0||!this.privMediaStream.active)return Promise.resolve(n);this.privMicrophoneLabel=n;const i=this.privMediaStream.getTracks()[0].getSettings().deviceId;if(i===void 0)return Promise.resolve(this.privMicrophoneLabel);const s=new r.Deferred;return navigator.mediaDevices.enumerateDevices().then(c=>{for(const u of c)if(u.deviceId===i){this.privMicrophoneLabel=u.label;break}s.resolve(this.privMicrophoneLabel)},()=>s.resolve(this.privMicrophoneLabel)),s.promise}async listen(n){await this.turnOn();const i=new r.ChunkedArrayBufferStream(this.privOutputChunkSize,n);this.privStreams[n]=i;try{this.privRecorder.record(this.privContext,this.privMediaStream,i)}catch(c){throw this.onEvent(new r.AudioStreamNodeErrorEvent(this.privId,n,c)),c}return i}onEvent(n){this.privEvents.onEvent(n),r.Events.instance.onEvent(n)}createAudioContext(){this.privContext||(this.privContext=o.AudioStreamFormatImpl.getAudioContext(p.AUDIOFORMAT.samplesPerSec))}async destroyAudioContext(){if(!this.privContext)return;this.privRecorder.releaseMediaResources(this.privContext);let n=!1;"close"in this.privContext&&(n=!0),n?this.privIsClosing||(this.privIsClosing=!0,await this.privContext.close(),this.privContext=null,this.privIsClosing=!1):this.privContext!==null&&this.privContext.state==="running"&&await this.privContext.suspend()}}t.MicAudioSource=p,p.AUDIOFORMAT=o.AudioStreamFormat.getDefaultInputFormat()}(Bn)),Bn}var pt={},Js;function vl(){if(Js)return pt;Js=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.FileAudioSource=void 0;const t=T(),e=A(),r=we;let o=class{constructor(a,n,i){this.privStreams={},this.privHeaderEnd=44,this.privId=i||(0,e.createNoDashGuid)(),this.privEvents=new e.EventSource,this.privSource=a,typeof window<"u"&&typeof Blob<"u"&&this.privSource instanceof Blob?this.privFilename=a.name:this.privFilename=n||"unknown.wav",this.privAudioFormatPromise=this.readHeader()}get format(){return this.privAudioFormatPromise}turnOn(){if(this.privFilename.lastIndexOf(".wav")!==this.privFilename.length-4){const a=this.privFilename+" is not supported. Only WAVE files are allowed at the moment.";return this.onEvent(new e.AudioSourceErrorEvent(a,"")),Promise.reject(a)}this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}id(){return this.privId}async attach(a){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,a));const n=await this.upload(a);return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,a)),Promise.resolve({detach:async()=>{n.readEnded(),delete this.privStreams[a],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,a)),await this.turnOff()},id:()=>a,read:()=>n.read()})}detach(a){a&&this.privStreams[a]&&(this.privStreams[a].close(),delete this.privStreams[a],this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,a)))}turnOff(){for(const a in this.privStreams)if(a){const n=this.privStreams[a];n&&!n.isClosed&&n.close()}return this.onEvent(new e.AudioSourceOffEvent(this.privId)),Promise.resolve()}get events(){return this.privEvents}get deviceInfo(){return this.privAudioFormatPromise.then(a=>Promise.resolve({bitspersample:a.bitsPerSample,channelcount:a.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:"File",samplerate:a.samplesPerSec,type:t.type.File}))}readHeader(){const n=this.privSource.slice(0,4296),i=new e.Deferred,s=c=>{const u=new DataView(c),d=v=>String.fromCharCode(u.getUint8(v),u.getUint8(v+1),u.getUint8(v+2),u.getUint8(v+3));if(d(0)!=="RIFF"){i.reject("Invalid WAV header in file, RIFF was not found");return}if(d(8)!=="WAVE"||d(12)!=="fmt "){i.reject("Invalid WAV header in file, WAVEfmt was not found");return}const h=u.getInt32(16,!0),l=u.getUint16(22,!0),f=u.getUint32(24,!0),g=u.getUint16(34,!0);let S=36+Math.max(h-16,0);for(;d(S)!=="data";S+=2)if(S>4288){i.reject("Invalid WAV header in file, data block was not found");return}this.privHeaderEnd=S+8,i.resolve(r.AudioStreamFormat.getWaveFormatPCM(f,g,l))};if(typeof window<"u"&&typeof Blob<"u"&&n instanceof Blob){const c=new FileReader;c.onload=u=>{const d=u.target.result;s(d)},c.readAsArrayBuffer(n)}else{const c=n;s(c.buffer.slice(c.byteOffset,c.byteOffset+c.byteLength))}return i.promise}async upload(a){const n=i=>{const s=`Error occurred while processing '${this.privFilename}'. ${i}`;throw this.onEvent(new e.AudioStreamNodeErrorEvent(this.privId,a,s)),new Error(s)};try{await this.turnOn();const i=await this.privAudioFormatPromise,s=new e.ChunkedArrayBufferStream(i.avgBytesPerSec/10,a);this.privStreams[a]=s;const c=this.privSource.slice(this.privHeaderEnd),u=d=>{s.isClosed||(s.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()}),s.close())};if(typeof window<"u"&&typeof Blob<"u"&&c instanceof Blob){const d=new FileReader;d.onerror=h=>n(h.toString()),d.onload=h=>{const l=h.target.result;u(l)},d.readAsArrayBuffer(c)}else{const d=c;u(d.buffer.slice(d.byteOffset,d.byteOffset+d.byteLength))}return s}catch(i){n(i)}}onEvent(a){this.privEvents.onEvent(a),e.Events.instance.onEvent(a)}};return pt.FileAudioSource=o,pt}var zi={};Object.defineProperty(zi,"__esModule",{value:!0});zi.PcmRecorder=void 0;const fl=A();class gl{constructor(e){this.privStopInputOnRelease=e}record(e,r,o){const a=new fl.RiffPcmEncoder(e.sampleRate,16e3),n=e.createMediaStreamSource(r),i=()=>{const c=(()=>{let u=0;try{return e.createScriptProcessor(u,1,1)}catch{u=2048;let h=e.sampleRate;for(;u<16384&&h>=32e3;)u<<=1,h>>=1;return e.createScriptProcessor(u,1,1)}})();c.onaudioprocess=u=>{const d=u.inputBuffer.getChannelData(0);if(o&&!o.isClosed){const h=a.encode(d);h&&o.writeStreamChunk({buffer:h,isEnd:!1,timeReceived:Date.now()})}},n.connect(c),c.connect(e.destination),this.privMediaResources={scriptProcessorNode:c,source:n,stream:r}},s=!!this.privSpeechProcessorScript&&this.privSpeechProcessorScript.toLowerCase()==="ignore";if(e.audioWorklet&&!s){if(!this.privSpeechProcessorScript){const c=`class SP extends AudioWorkletProcessor {
                    constructor(options) {
                      super(options);
                    }
                    process(inputs, outputs) {
                      const input = inputs[0];
                      const output = [];
                      for (let channel = 0; channel < input.length; channel += 1) {
                        output[channel] = input[channel];
                      }
                      this.port.postMessage(output[0]);
                      return true;
                    }
                  }
                  registerProcessor('speech-processor', SP);`,u=new Blob([c],{type:"application/javascript; charset=utf-8"});this.privSpeechProcessorScript=URL.createObjectURL(u)}e.audioWorklet.addModule(this.privSpeechProcessorScript).then(()=>{const c=new AudioWorkletNode(e,"speech-processor");c.port.onmessage=u=>{const d=u.data;if(o&&!o.isClosed){const h=a.encode(d);h&&o.writeStreamChunk({buffer:h,isEnd:!1,timeReceived:Date.now()})}},n.connect(c),c.connect(e.destination),this.privMediaResources={scriptProcessorNode:c,source:n,stream:r}}).catch(()=>{i()})}else try{i()}catch(c){throw new Error(`Unable to start audio worklet node for PCMRecorder: ${c}`)}}releaseMediaResources(e){this.privMediaResources&&(this.privMediaResources.scriptProcessorNode&&(this.privMediaResources.scriptProcessorNode.disconnect(e.destination),this.privMediaResources.scriptProcessorNode=null),this.privMediaResources.source&&(this.privMediaResources.source.disconnect(),this.privStopInputOnRelease&&this.privMediaResources.stream.getTracks().forEach(r=>r.stop()),this.privMediaResources.source=null))}setWorkletUrl(e){this.privSpeechProcessorScript=e}}zi.PcmRecorder=gl;var ji={},Zr={},ml=k&&k.__createBinding||(Object.create?function(t,e,r,o){o===void 0&&(o=r),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,o){o===void 0&&(o=r),t[o]=e[r]}),Sl=k&&k.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),kc=k&&k.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ml(e,t,r);return Sl(e,t),e},os=k&&k.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.WebsocketMessageAdapter=void 0;const Cl=kc($e),yl=kc($e),Pl=os($e),Rl=os($e),El=os($e),Il=F,M=A();class $r{constructor(e,r,o,p,a,n){if(!e)throw new M.ArgumentNullError("uri");if(!o)throw new M.ArgumentNullError("messageFormatter");this.proxyInfo=p,this.privConnectionEvents=new M.EventSource,this.privConnectionId=r,this.privMessageFormatter=o,this.privConnectionState=M.ConnectionState.None,this.privUri=e,this.privHeaders=a,this.privEnableCompression=n,this.privHeaders[Il.HeaderNames.ConnectionId]=this.privConnectionId,this.privHeaders.connectionId=this.privConnectionId,this.privLastErrorReceived=""}get state(){return this.privConnectionState}open(){if(this.privConnectionState===M.ConnectionState.Disconnected)return Promise.reject(`Cannot open a connection that is in ${this.privConnectionState} state`);if(this.privConnectionEstablishDeferral)return this.privConnectionEstablishDeferral.promise;this.privConnectionEstablishDeferral=new M.Deferred,this.privCertificateValidatedDeferral=new M.Deferred,this.privConnectionState=M.ConnectionState.Connecting;try{if(typeof WebSocket<"u"&&!$r.forceNpmWebSocket)this.privCertificateValidatedDeferral.resolve(),this.privWebsocketClient=new WebSocket(this.privUri);else{let r=new URL(this.privUri).protocol;(r==null?void 0:r.toLocaleLowerCase())==="wss:"?r="https:":(r==null?void 0:r.toLocaleLowerCase())==="ws:"&&(r="http:");const o={headers:this.privHeaders,perMessageDeflate:this.privEnableCompression,followRedirects:r.toLocaleLowerCase()==="https:"};this.privCertificateValidatedDeferral.resolve(),o.agent=this.getAgent(),o.agent.protocol=r,this.privWebsocketClient=new El.default(this.privUri,o),this.privWebsocketClient.on("redirect",p=>{const a=new M.ConnectionRedirectEvent(this.privConnectionId,p,this.privUri,`Getting redirect URL from endpoint ${this.privUri} with redirect URL '${p}'`);M.Events.instance.onEvent(a)})}this.privWebsocketClient.binaryType="arraybuffer",this.privReceivingMessageQueue=new M.Queue,this.privDisconnectDeferral=new M.Deferred,this.privSendMessageQueue=new M.Queue,this.processSendQueue().catch(e=>{M.Events.instance.onEvent(new M.BackgroundEvent(e))})}catch(e){return this.privConnectionEstablishDeferral.resolve(new M.ConnectionOpenResponse(500,e)),this.privConnectionEstablishDeferral.promise}return this.onEvent(new M.ConnectionStartEvent(this.privConnectionId,this.privUri)),this.privWebsocketClient.onopen=()=>{this.privCertificateValidatedDeferral.promise.then(()=>{this.privConnectionState=M.ConnectionState.Connected,this.onEvent(new M.ConnectionEstablishedEvent(this.privConnectionId)),this.privConnectionEstablishDeferral.resolve(new M.ConnectionOpenResponse(200,""))},e=>{this.privConnectionEstablishDeferral.reject(e)})},this.privWebsocketClient.onerror=e=>{this.onEvent(new M.ConnectionErrorEvent(this.privConnectionId,e.message,e.type)),this.privLastErrorReceived=e.message},this.privWebsocketClient.onclose=e=>{this.privConnectionState===M.ConnectionState.Connecting?(this.privConnectionState=M.ConnectionState.Disconnected,this.privConnectionEstablishDeferral.resolve(new M.ConnectionOpenResponse(e.code,e.reason+" "+this.privLastErrorReceived))):(this.privConnectionState=M.ConnectionState.Disconnected,this.privWebsocketClient=null,this.onEvent(new M.ConnectionClosedEvent(this.privConnectionId,e.code,e.reason))),this.onClose(e.code,e.reason).catch(r=>{M.Events.instance.onEvent(new M.BackgroundEvent(r))})},this.privWebsocketClient.onmessage=e=>{const r=new Date().toISOString();if(this.privConnectionState===M.ConnectionState.Connected){const o=new M.Deferred;if(this.privReceivingMessageQueue.enqueueFromPromise(o.promise),e.data instanceof ArrayBuffer){const p=new M.RawWebsocketMessage(M.MessageType.Binary,e.data);this.privMessageFormatter.toConnectionMessage(p).then(a=>{this.onEvent(new M.ConnectionMessageReceivedEvent(this.privConnectionId,r,a)),o.resolve(a)},a=>{o.reject(`Invalid binary message format. Error: ${a}`)})}else{const p=new M.RawWebsocketMessage(M.MessageType.Text,e.data);this.privMessageFormatter.toConnectionMessage(p).then(a=>{this.onEvent(new M.ConnectionMessageReceivedEvent(this.privConnectionId,r,a)),o.resolve(a)},a=>{o.reject(`Invalid text message format. Error: ${a}`)})}}},this.privConnectionEstablishDeferral.promise}send(e){if(this.privConnectionState!==M.ConnectionState.Connected)return Promise.reject(`Cannot send on connection that is in ${M.ConnectionState[this.privConnectionState]} state`);const r=new M.Deferred,o=new M.Deferred;return this.privSendMessageQueue.enqueueFromPromise(o.promise),this.privMessageFormatter.fromConnectionMessage(e).then(p=>{o.resolve({Message:e,RawWebsocketMessage:p,sendStatusDeferral:r})},p=>{o.reject(`Error formatting the message. ${p}`)}),r.promise}read(){return this.privConnectionState!==M.ConnectionState.Connected?Promise.reject(`Cannot read on connection that is in ${this.privConnectionState} state`):this.privReceivingMessageQueue.dequeue()}close(e){if(this.privWebsocketClient)this.privConnectionState!==M.ConnectionState.Disconnected&&this.privWebsocketClient.close(1e3,e||"Normal closure by client");else return Promise.resolve();return this.privDisconnectDeferral.promise}get events(){return this.privConnectionEvents}sendRawMessage(e){try{if(!e)return Promise.resolve();if(this.onEvent(new M.ConnectionMessageSentEvent(this.privConnectionId,new Date().toISOString(),e.Message)),this.isWebsocketOpen)this.privWebsocketClient.send(e.RawWebsocketMessage.payload);else return Promise.reject("websocket send error: Websocket not ready "+this.privConnectionId+" "+e.Message.id+" "+new Error().stack);return Promise.resolve()}catch(r){return Promise.reject(`websocket send error: ${r}`)}}async onClose(e,r){const o=`Connection closed. ${e}: ${r}`;this.privConnectionState=M.ConnectionState.Disconnected,this.privDisconnectDeferral.resolve(),await this.privReceivingMessageQueue.drainAndDispose(()=>{},o),await this.privSendMessageQueue.drainAndDispose(p=>{p.sendStatusDeferral.reject(o)},o)}async processSendQueue(){for(;;){const r=await this.privSendMessageQueue.dequeue();if(!r)return;try{await this.sendRawMessage(r),r.sendStatusDeferral.resolve()}catch(o){r.sendStatusDeferral.reject(o)}}}onEvent(e){this.privConnectionEvents.onEvent(e),M.Events.instance.onEvent(e)}getAgent(){const e=new Pl.default.Agent(this.createConnection);return this.proxyInfo!==void 0&&this.proxyInfo.HostName!==void 0&&this.proxyInfo.Port>0&&(e.proxyInfo=this.proxyInfo),e}static GetProxyAgent(e){const r={host:e.HostName,port:e.Port};return e.UserName?r.headers={"Proxy-Authentication":"Basic "+new Buffer(`${e.UserName}:${e.Password===void 0?"":e.Password}`).toString("base64")}:r.headers={},r.headers.requestOCSP="true",new Rl.default(r)}createConnection(e,r){let o;if(r={...r,requestOCSP:!0,servername:r.host},this.proxyInfo){const a=$r.GetProxyAgent(this.proxyInfo);o=new Promise((n,i)=>{a.callback(e,r,(s,c)=>{s?i(s):n(c)})})}else r.secureEndpoint?o=Promise.resolve(yl.connect(r)):o=Promise.resolve(Cl.connect(r));return o}get isWebsocketOpen(){return this.privWebsocketClient&&this.privWebsocketClient.readyState===this.privWebsocketClient.OPEN}}Zr.WebsocketMessageAdapter=$r;$r.forceNpmWebSocket=!1;Object.defineProperty(ji,"__esModule",{value:!0});ji.WebsocketConnection=void 0;const qn=A(),Tl=Zr;class Al{constructor(e,r,o,p,a,n=!1,i){if(this.privIsDisposed=!1,!e)throw new qn.ArgumentNullError("uri");if(!p)throw new qn.ArgumentNullError("messageFormatter");this.privMessageFormatter=p;let s="",c=0;if(r){for(const u in r)if(u){s+=c===0&&e.indexOf("?")===-1?"?":"&";const d=encodeURIComponent(u);s+=d;let h=r[u];h&&(h=encodeURIComponent(h),s+=`=${h}`),c++}}if(o){for(const u in o)if(u){s+=c===0&&e.indexOf("?")===-1?"?":"&";const d=encodeURIComponent(o[u]);s+=`${u}=${d}`,c++}}this.privUri=e+s,this.privId=i||(0,qn.createNoDashGuid)(),this.privConnectionMessageAdapter=new Tl.WebsocketMessageAdapter(this.privUri,this.id,this.privMessageFormatter,a,o,n)}async dispose(){this.privIsDisposed=!0,this.privConnectionMessageAdapter&&await this.privConnectionMessageAdapter.close()}isDisposed(){return this.privIsDisposed}get id(){return this.privId}get uri(){return this.privUri}state(){return this.privConnectionMessageAdapter.state}open(){return this.privConnectionMessageAdapter.open()}send(e){return this.privConnectionMessageAdapter.send(e)}read(){return this.privConnectionMessageAdapter.read()}get events(){return this.privConnectionMessageAdapter.events}}ji.WebsocketConnection=Al;var Li={};Object.defineProperty(Li,"__esModule",{value:!0});Li.ReplayableAudioNode=void 0;class wl{constructor(e,r){this.privBuffers=[],this.privReplayOffset=0,this.privLastShrinkOffset=0,this.privBufferStartOffset=0,this.privBufferSerial=0,this.privBufferedBytes=0,this.privReplay=!1,this.privLastChunkAcquiredTime=0,this.privAudioNode=e,this.privBytesPerSecond=r}id(){return this.privAudioNode.id()}read(){if(this.privReplay&&this.privBuffers.length!==0){const e=this.privReplayOffset-this.privBufferStartOffset;let r=Math.round(e*this.privBytesPerSecond*1e-7);r%2!==0&&r++;let o=0;for(;o<this.privBuffers.length&&r>=this.privBuffers[o].chunk.buffer.byteLength;)r-=this.privBuffers[o++].chunk.buffer.byteLength;if(o<this.privBuffers.length){const p=this.privBuffers[o].chunk.buffer.slice(r);return this.privReplayOffset+=p.byteLength/this.privBytesPerSecond*1e7,o===this.privBuffers.length-1&&(this.privReplay=!1),Promise.resolve({buffer:p,isEnd:!1,timeReceived:this.privBuffers[o].chunk.timeReceived})}}return this.privAudioNode.read().then(e=>(e&&e.buffer&&this.privBuffers&&(this.privBuffers.push(new _l(e,this.privBufferSerial++,this.privBufferedBytes)),this.privBufferedBytes+=e.buffer.byteLength),e))}detach(){return this.privBuffers=void 0,this.privAudioNode.detach()}replay(){this.privBuffers&&this.privBuffers.length!==0&&(this.privReplay=!0,this.privReplayOffset=this.privLastShrinkOffset)}shrinkBuffers(e){if(this.privBuffers===void 0||this.privBuffers.length===0)return;this.privLastShrinkOffset=e;const r=e-this.privBufferStartOffset;let o=Math.round(r*this.privBytesPerSecond*1e-7),p=0;for(;p<this.privBuffers.length&&o>=this.privBuffers[p].chunk.buffer.byteLength;)o-=this.privBuffers[p++].chunk.buffer.byteLength;this.privBufferStartOffset=Math.round(e-o/this.privBytesPerSecond*1e7),this.privBuffers=this.privBuffers.slice(p)}findTimeAtOffset(e){if(e<this.privBufferStartOffset||this.privBuffers===void 0)return 0;for(const r of this.privBuffers){const o=r.byteOffset/this.privBytesPerSecond*1e7,p=o+r.chunk.buffer.byteLength/this.privBytesPerSecond*1e7;if(e>=o&&e<=p)return r.chunk.timeReceived}return 0}}Li.ReplayableAudioNode=wl;class _l{constructor(e,r,o){this.chunk=e,this.serial=r,this.byteOffset=o}}var ut={},Fn={},he={},Yr={},bl=k&&k.__createBinding||(Object.create?function(t,e,r,o){o===void 0&&(o=r),Object.defineProperty(t,o,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,o){o===void 0&&(o=r),t[o]=e[r]}),Ml=k&&k.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Ol=k&&k.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&bl(e,t,r);return Ml(e,t),e};Object.defineProperty(Yr,"__esModule",{value:!0});Yr.AudioFileWriter=void 0;const dt=Ol($e),xn=b;class Dl{constructor(e){xn.Contracts.throwIfNullOrUndefined(dt.openSync,`
File System access not available, please use Push or PullAudioOutputStream`),this.privFd=dt.openSync(e,"w")}set format(e){xn.Contracts.throwIfNotUndefined(this.privAudioFormat,"format is already set"),this.privAudioFormat=e;let r=0;this.privAudioFormat.hasHeader&&(r=this.privAudioFormat.header.byteLength),this.privFd!==void 0&&(this.privWriteStream=dt.createWriteStream("",{fd:this.privFd,start:r,autoClose:!1}))}write(e){xn.Contracts.throwIfNullOrUndefined(this.privAudioFormat,"must set format before writing."),this.privWriteStream!==void 0&&this.privWriteStream.write(new Uint8Array(e.slice(0)))}close(){this.privFd!==void 0&&(this.privWriteStream.on("finish",()=>{this.privAudioFormat.hasHeader&&(this.privAudioFormat.updateHeader(this.privWriteStream.bytesWritten),dt.writeSync(this.privFd,new Int8Array(this.privAudioFormat.header),0,this.privAudioFormat.header.byteLength,0)),dt.closeSync(this.privFd),this.privFd=void 0}),this.privWriteStream.end())}id(){return this.privId}}Yr.AudioFileWriter=Dl;var ie={},Gs;function Nc(){if(Gs)return ie;Gs=1,Object.defineProperty(ie,"__esModule",{value:!0}),ie.PullAudioInputStreamImpl=ie.PullAudioInputStream=ie.PushAudioInputStreamImpl=ie.PushAudioInputStream=ie.AudioInputStream=void 0;const t=T(),e=A(),r=ae,o=P(),p=we;let a=class{constructor(){}static createPushStream(d){return n.create(d)}static createPullStream(d,h){return s.create(d,h)}};ie.AudioInputStream=a;class n extends a{static create(d){return new i(d)}}ie.PushAudioInputStream=n;class i extends n{constructor(d){super(),d===void 0?this.privFormat=p.AudioStreamFormatImpl.getDefaultInputFormat():this.privFormat=d,this.privEvents=new e.EventSource,this.privId=(0,r.createNoDashGuid)(),this.privStream=new e.ChunkedArrayBufferStream(this.privFormat.avgBytesPerSec/10)}get format(){return Promise.resolve(this.privFormat)}write(d){this.privStream.writeStreamChunk({buffer:d,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(d){this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn();const h=this.privStream;return this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:async()=>(this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>h.read()}}detach(d){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:"PushStream",samplerate:this.privFormat.samplesPerSec,type:t.type.Stream})}onEvent(d){this.privEvents.onEvent(d),e.Events.instance.onEvent(d)}toBuffer(d){const h=Buffer.alloc(d.byteLength),l=new Uint8Array(d);for(let f=0;f<h.length;++f)h[f]=l[f];return h}}ie.PushAudioInputStreamImpl=i;class s extends a{constructor(){super()}static create(d,h){return new c(d,h)}}ie.PullAudioInputStream=s;class c extends s{constructor(d,h){super(),h===void 0?this.privFormat=o.AudioStreamFormat.getDefaultInputFormat():this.privFormat=h,this.privEvents=new e.EventSource,this.privId=(0,r.createNoDashGuid)(),this.privCallback=d,this.privIsClosed=!1,this.privBufferSize=this.privFormat.avgBytesPerSec/10}get format(){return Promise.resolve(this.privFormat)}close(){this.privIsClosed=!0,this.privCallback.close()}id(){return this.privId}turnOn(){this.onEvent(new e.AudioSourceInitializingEvent(this.privId)),this.onEvent(new e.AudioSourceReadyEvent(this.privId))}async attach(d){return this.onEvent(new e.AudioStreamNodeAttachingEvent(this.privId,d)),await this.turnOn(),this.onEvent(new e.AudioStreamNodeAttachedEvent(this.privId,d)),{detach:()=>(this.privCallback.close(),this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,d)),this.turnOff()),id:()=>d,read:()=>{let h=0,l;for(;h<this.privBufferSize;){const f=new ArrayBuffer(this.privBufferSize-h),g=this.privCallback.read(f);if(l===void 0?l=f:new Int8Array(l).set(new Int8Array(f),h),g===0)break;h+=g}return Promise.resolve({buffer:l.slice(0,h),isEnd:this.privIsClosed||h===0,timeReceived:Date.now()})}}}detach(d){this.onEvent(new e.AudioStreamNodeDetachedEvent(this.privId,d))}turnOff(){}get events(){return this.privEvents}get deviceInfo(){return Promise.resolve({bitspersample:this.privFormat.bitsPerSample,channelcount:this.privFormat.channels,connectivity:t.connectivity.Unknown,manufacturer:"Speech SDK",model:"PullStream",samplerate:this.privFormat.samplesPerSec,type:t.type.Stream})}onEvent(d){this.privEvents.onEvent(d),e.Events.instance.onEvent(d)}}return ie.PullAudioInputStreamImpl=c,ie}var W={},_e={},as={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechSynthesisOutputFormat=void 0,function(e){e[e.Raw8Khz8BitMonoMULaw=0]="Raw8Khz8BitMonoMULaw",e[e.Riff16Khz16KbpsMonoSiren=1]="Riff16Khz16KbpsMonoSiren",e[e.Audio16Khz16KbpsMonoSiren=2]="Audio16Khz16KbpsMonoSiren",e[e.Audio16Khz32KBitRateMonoMp3=3]="Audio16Khz32KBitRateMonoMp3",e[e.Audio16Khz128KBitRateMonoMp3=4]="Audio16Khz128KBitRateMonoMp3",e[e.Audio16Khz64KBitRateMonoMp3=5]="Audio16Khz64KBitRateMonoMp3",e[e.Audio24Khz48KBitRateMonoMp3=6]="Audio24Khz48KBitRateMonoMp3",e[e.Audio24Khz96KBitRateMonoMp3=7]="Audio24Khz96KBitRateMonoMp3",e[e.Audio24Khz160KBitRateMonoMp3=8]="Audio24Khz160KBitRateMonoMp3",e[e.Raw16Khz16BitMonoTrueSilk=9]="Raw16Khz16BitMonoTrueSilk",e[e.Riff16Khz16BitMonoPcm=10]="Riff16Khz16BitMonoPcm",e[e.Riff8Khz16BitMonoPcm=11]="Riff8Khz16BitMonoPcm",e[e.Riff24Khz16BitMonoPcm=12]="Riff24Khz16BitMonoPcm",e[e.Riff8Khz8BitMonoMULaw=13]="Riff8Khz8BitMonoMULaw",e[e.Raw16Khz16BitMonoPcm=14]="Raw16Khz16BitMonoPcm",e[e.Raw24Khz16BitMonoPcm=15]="Raw24Khz16BitMonoPcm",e[e.Raw8Khz16BitMonoPcm=16]="Raw8Khz16BitMonoPcm",e[e.Ogg16Khz16BitMonoOpus=17]="Ogg16Khz16BitMonoOpus",e[e.Ogg24Khz16BitMonoOpus=18]="Ogg24Khz16BitMonoOpus",e[e.Raw48Khz16BitMonoPcm=19]="Raw48Khz16BitMonoPcm",e[e.Riff48Khz16BitMonoPcm=20]="Riff48Khz16BitMonoPcm",e[e.Audio48Khz96KBitRateMonoMp3=21]="Audio48Khz96KBitRateMonoMp3",e[e.Audio48Khz192KBitRateMonoMp3=22]="Audio48Khz192KBitRateMonoMp3",e[e.Ogg48Khz16BitMonoOpus=23]="Ogg48Khz16BitMonoOpus",e[e.Webm16Khz16BitMonoOpus=24]="Webm16Khz16BitMonoOpus",e[e.Webm24Khz16BitMonoOpus=25]="Webm24Khz16BitMonoOpus",e[e.Raw24Khz16BitMonoTrueSilk=26]="Raw24Khz16BitMonoTrueSilk",e[e.Raw8Khz8BitMonoALaw=27]="Raw8Khz8BitMonoALaw",e[e.Riff8Khz8BitMonoALaw=28]="Riff8Khz8BitMonoALaw",e[e.Webm24Khz16Bit24KbpsMonoOpus=29]="Webm24Khz16Bit24KbpsMonoOpus",e[e.Audio16Khz16Bit32KbpsMonoOpus=30]="Audio16Khz16Bit32KbpsMonoOpus",e[e.Audio24Khz16Bit48KbpsMonoOpus=31]="Audio24Khz16Bit48KbpsMonoOpus",e[e.Audio24Khz16Bit24KbpsMonoOpus=32]="Audio24Khz16Bit24KbpsMonoOpus",e[e.Raw22050Hz16BitMonoPcm=33]="Raw22050Hz16BitMonoPcm",e[e.Riff22050Hz16BitMonoPcm=34]="Riff22050Hz16BitMonoPcm",e[e.Raw44100Hz16BitMonoPcm=35]="Raw44100Hz16BitMonoPcm",e[e.Riff44100Hz16BitMonoPcm=36]="Riff44100Hz16BitMonoPcm",e[e.AmrWb16000Hz=37]="AmrWb16000Hz",e[e.G72216Khz64Kbps=38]="G72216Khz64Kbps"}(t.SpeechSynthesisOutputFormat||(t.SpeechSynthesisOutputFormat={}))})(as);Object.defineProperty(_e,"__esModule",{value:!0});_e.AudioOutputFormatImpl=void 0;const D=as,O=we;class _ extends O.AudioStreamFormatImpl{constructor(e,r,o,p,a,n,i,s,c){super(o,n,r,e),this.formatTag=e,this.avgBytesPerSec=p,this.blockAlign=a,this.priAudioFormatString=i,this.priRequestAudioFormatString=s,this.priHasHeader=c}static fromSpeechSynthesisOutputFormat(e){return e===void 0?_.getDefaultOutputFormat():_.fromSpeechSynthesisOutputFormatString(_.SpeechSynthesisOutputFormatToString[e])}static fromSpeechSynthesisOutputFormatString(e){switch(e){case"raw-8khz-8bit-mono-mulaw":return new _(O.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,e,!1);case"riff-16khz-16kbps-mono-siren":return new _(O.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,"audio-16khz-16kbps-mono-siren",!0);case"audio-16khz-16kbps-mono-siren":return new _(O.AudioFormatTag.Siren,1,16e3,2e3,40,0,e,e,!1);case"audio-16khz-32kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,16e3,4096,2,16,e,e,!1);case"audio-16khz-128kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,16e3,16384,2,16,e,e,!1);case"audio-16khz-64kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,16e3,8192,2,16,e,e,!1);case"audio-24khz-48kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,24e3,6144,2,16,e,e,!1);case"audio-24khz-96kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,24e3,12288,2,16,e,e,!1);case"audio-24khz-160kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,24e3,20480,2,16,e,e,!1);case"raw-16khz-16bit-mono-truesilk":return new _(O.AudioFormatTag.SILKSkype,1,16e3,32e3,2,16,e,e,!1);case"riff-8khz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!0);case"riff-24khz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!0);case"riff-8khz-8bit-mono-mulaw":return new _(O.AudioFormatTag.MuLaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-mulaw",!0);case"raw-16khz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,16e3,32e3,2,16,e,"raw-16khz-16bit-mono-pcm",!1);case"raw-24khz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,24e3,48e3,2,16,e,"raw-24khz-16bit-mono-pcm",!1);case"raw-8khz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,8e3,16e3,2,16,e,"raw-8khz-16bit-mono-pcm",!1);case"ogg-16khz-16bit-mono-opus":return new _(O.AudioFormatTag.OGG_OPUS,1,16e3,8192,2,16,e,e,!1);case"ogg-24khz-16bit-mono-opus":return new _(O.AudioFormatTag.OGG_OPUS,1,24e3,8192,2,16,e,e,!1);case"raw-48khz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!1);case"riff-48khz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,48e3,96e3,2,16,e,"raw-48khz-16bit-mono-pcm",!0);case"audio-48khz-96kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,48e3,12288,2,16,e,e,!1);case"audio-48khz-192kbitrate-mono-mp3":return new _(O.AudioFormatTag.MP3,1,48e3,24576,2,16,e,e,!1);case"ogg-48khz-16bit-mono-opus":return new _(O.AudioFormatTag.OGG_OPUS,1,48e3,12e3,2,16,e,e,!1);case"webm-16khz-16bit-mono-opus":return new _(O.AudioFormatTag.WEBM_OPUS,1,16e3,4e3,2,16,e,e,!1);case"webm-24khz-16bit-mono-opus":return new _(O.AudioFormatTag.WEBM_OPUS,1,24e3,6e3,2,16,e,e,!1);case"webm-24khz-16bit-24kbps-mono-opus":return new _(O.AudioFormatTag.WEBM_OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-16khz-16bit-32kbps-mono-opus":return new _(O.AudioFormatTag.OPUS,1,16e3,4e3,2,16,e,e,!1);case"audio-24khz-16bit-48kbps-mono-opus":return new _(O.AudioFormatTag.OPUS,1,24e3,6e3,2,16,e,e,!1);case"audio-24khz-16bit-24kbps-mono-opus":return new _(O.AudioFormatTag.OPUS,1,24e3,3e3,2,16,e,e,!1);case"audio-24khz-16bit-mono-flac":return new _(O.AudioFormatTag.FLAC,1,24e3,24e3,2,16,e,e,!1);case"audio-48khz-16bit-mono-flac":return new _(O.AudioFormatTag.FLAC,1,48e3,3e4,2,16,e,e,!1);case"raw-24khz-16bit-mono-truesilk":return new _(O.AudioFormatTag.SILKSkype,1,24e3,48e3,2,16,e,e,!1);case"raw-8khz-8bit-mono-alaw":return new _(O.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,e,!1);case"riff-8khz-8bit-mono-alaw":return new _(O.AudioFormatTag.ALaw,1,8e3,8e3,1,8,e,"raw-8khz-8bit-mono-alaw",!0);case"raw-22050hz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,22050,44100,2,16,e,e,!1);case"riff-22050hz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,22050,44100,2,16,e,"raw-22050hz-16bit-mono-pcm",!0);case"raw-44100hz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,44100,88200,2,16,e,e,!1);case"riff-44100hz-16bit-mono-pcm":return new _(O.AudioFormatTag.PCM,1,44100,88200,2,16,e,"raw-44100hz-16bit-mono-pcm",!0);case"amr-wb-16000h":return new _(O.AudioFormatTag.AMR_WB,1,16e3,3052,2,16,e,e,!1);case"g722-16khz-64kbps":return new _(O.AudioFormatTag.G722,1,16e3,8e3,2,16,e,e,!1);case"riff-16khz-16bit-mono-pcm":default:return new _(O.AudioFormatTag.PCM,1,16e3,32e3,2,16,"riff-16khz-16bit-mono-pcm","raw-16khz-16bit-mono-pcm",!0)}}static getDefaultOutputFormat(){return _.fromSpeechSynthesisOutputFormatString(typeof window<"u"?"audio-24khz-48kbitrate-mono-mp3":"riff-16khz-16bit-mono-pcm")}get hasHeader(){return this.priHasHeader}get header(){if(this.hasHeader)return this.privHeader}updateHeader(e){if(this.priHasHeader){const r=new DataView(this.privHeader);r.setUint32(4,e+this.privHeader.byteLength-8,!0),r.setUint32(40,e,!0)}}get requestAudioFormatString(){return this.priRequestAudioFormatString}addHeader(e){if(!this.hasHeader)return e;this.updateHeader(e.byteLength);const r=new Uint8Array(e.byteLength+this.header.byteLength);return r.set(new Uint8Array(this.header),0),r.set(new Uint8Array(e),this.header.byteLength),r.buffer}}_e.AudioOutputFormatImpl=_;_.SpeechSynthesisOutputFormatToString={[D.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoMULaw]:"raw-8khz-8bit-mono-mulaw",[D.SpeechSynthesisOutputFormat.Riff16Khz16KbpsMonoSiren]:"riff-16khz-16kbps-mono-siren",[D.SpeechSynthesisOutputFormat.Audio16Khz16KbpsMonoSiren]:"audio-16khz-16kbps-mono-siren",[D.SpeechSynthesisOutputFormat.Audio16Khz32KBitRateMonoMp3]:"audio-16khz-32kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Audio16Khz128KBitRateMonoMp3]:"audio-16khz-128kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Audio16Khz64KBitRateMonoMp3]:"audio-16khz-64kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Audio24Khz48KBitRateMonoMp3]:"audio-24khz-48kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Audio24Khz96KBitRateMonoMp3]:"audio-24khz-96kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Audio24Khz160KBitRateMonoMp3]:"audio-24khz-160kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoTrueSilk]:"raw-16khz-16bit-mono-truesilk",[D.SpeechSynthesisOutputFormat.Riff16Khz16BitMonoPcm]:"riff-16khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Riff8Khz16BitMonoPcm]:"riff-8khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm]:"riff-24khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoMULaw]:"riff-8khz-8bit-mono-mulaw",[D.SpeechSynthesisOutputFormat.Raw16Khz16BitMonoPcm]:"raw-16khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoPcm]:"raw-24khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Raw8Khz16BitMonoPcm]:"raw-8khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Ogg16Khz16BitMonoOpus]:"ogg-16khz-16bit-mono-opus",[D.SpeechSynthesisOutputFormat.Ogg24Khz16BitMonoOpus]:"ogg-24khz-16bit-mono-opus",[D.SpeechSynthesisOutputFormat.Raw48Khz16BitMonoPcm]:"raw-48khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Riff48Khz16BitMonoPcm]:"riff-48khz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Audio48Khz96KBitRateMonoMp3]:"audio-48khz-96kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Audio48Khz192KBitRateMonoMp3]:"audio-48khz-192kbitrate-mono-mp3",[D.SpeechSynthesisOutputFormat.Ogg48Khz16BitMonoOpus]:"ogg-48khz-16bit-mono-opus",[D.SpeechSynthesisOutputFormat.Webm16Khz16BitMonoOpus]:"webm-16khz-16bit-mono-opus",[D.SpeechSynthesisOutputFormat.Webm24Khz16BitMonoOpus]:"webm-24khz-16bit-mono-opus",[D.SpeechSynthesisOutputFormat.Webm24Khz16Bit24KbpsMonoOpus]:"webm-24khz-16bit-24kbps-mono-opus",[D.SpeechSynthesisOutputFormat.Raw24Khz16BitMonoTrueSilk]:"raw-24khz-16bit-mono-truesilk",[D.SpeechSynthesisOutputFormat.Raw8Khz8BitMonoALaw]:"raw-8khz-8bit-mono-alaw",[D.SpeechSynthesisOutputFormat.Riff8Khz8BitMonoALaw]:"riff-8khz-8bit-mono-alaw",[D.SpeechSynthesisOutputFormat.Audio16Khz16Bit32KbpsMonoOpus]:"audio-16khz-16bit-32kbps-mono-opus",[D.SpeechSynthesisOutputFormat.Audio24Khz16Bit48KbpsMonoOpus]:"audio-24khz-16bit-48kbps-mono-opus",[D.SpeechSynthesisOutputFormat.Audio24Khz16Bit24KbpsMonoOpus]:"audio-24khz-16bit-24kbps-mono-opus",[D.SpeechSynthesisOutputFormat.Raw22050Hz16BitMonoPcm]:"raw-22050hz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Riff22050Hz16BitMonoPcm]:"riff-22050hz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Raw44100Hz16BitMonoPcm]:"raw-44100hz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.Riff44100Hz16BitMonoPcm]:"riff-44100hz-16bit-mono-pcm",[D.SpeechSynthesisOutputFormat.AmrWb16000Hz]:"amr-wb-16000hz",[D.SpeechSynthesisOutputFormat.G72216Khz64Kbps]:"g722-16khz-64kbps"};Object.defineProperty(W,"__esModule",{value:!0});W.PushAudioOutputStreamImpl=W.PushAudioOutputStream=W.PullAudioOutputStreamImpl=W.PullAudioOutputStream=W.AudioOutputStream=void 0;const Xn=A(),kl=b,Nl=_e;class cs{constructor(){}static createPullStream(){return ps.create()}}W.AudioOutputStream=cs;class ps extends cs{static create(){return new zc}}W.PullAudioOutputStream=ps;class zc extends ps{constructor(){super(),this.privId=(0,Xn.createNoDashGuid)(),this.privStream=new Xn.Stream}set format(e){e==null&&(this.privFormat=Nl.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privFormat=e}get format(){return this.privFormat}get isClosed(){return this.privStream.isClosed}id(){return this.privId}async read(e){const r=new Int8Array(e);let o=0;if(this.privLastChunkView!==void 0){if(this.privLastChunkView.length>e.byteLength)return r.set(this.privLastChunkView.slice(0,e.byteLength)),this.privLastChunkView=this.privLastChunkView.slice(e.byteLength),Promise.resolve(e.byteLength);r.set(this.privLastChunkView),o=this.privLastChunkView.length,this.privLastChunkView=void 0}for(;o<e.byteLength&&!this.privStream.isReadEnded;){const p=await this.privStream.read();if(p!==void 0&&!p.isEnd){let a;p.buffer.byteLength>e.byteLength-o?(a=p.buffer.slice(0,e.byteLength-o),this.privLastChunkView=new Int8Array(p.buffer.slice(e.byteLength-o))):a=p.buffer,r.set(new Int8Array(a),o),o+=a.byteLength}else this.privStream.readEnded()}return o}write(e){kl.Contracts.throwIfNullOrUndefined(this.privStream,"must set format before writing"),this.privStream.writeStreamChunk({buffer:e,isEnd:!1,timeReceived:Date.now()})}close(){this.privStream.close()}}W.PullAudioOutputStreamImpl=zc;class jc extends cs{constructor(){super()}static create(e){return new Lc(e)}}W.PushAudioOutputStream=jc;class Lc extends jc{constructor(e){super(),this.privId=(0,Xn.createNoDashGuid)(),this.privCallback=e}set format(e){}write(e){this.privCallback.write&&this.privCallback.write(e)}close(){this.privCallback.close&&this.privCallback.close()}id(){return this.privId}}W.PushAudioOutputStreamImpl=Lc;var Qs;function qc(){if(Qs)return he;Qs=1,Object.defineProperty(he,"__esModule",{value:!0}),he.AudioOutputConfigImpl=he.AudioConfigImpl=he.AudioConfig=void 0;const t=x(),e=b,r=P(),o=Yr,p=Nc(),a=W;let n=class Bc{static fromDefaultMicrophoneInput(){const u=new t.PcmRecorder(!0);return new i(new t.MicAudioSource(u))}static fromMicrophoneInput(u){const d=new t.PcmRecorder(!0);return new i(new t.MicAudioSource(d,u))}static fromWavFileInput(u,d="unnamedBuffer.wav"){return new i(new t.FileAudioSource(u,d))}static fromStreamInput(u){if(u instanceof r.PullAudioInputStreamCallback)return new i(new p.PullAudioInputStreamImpl(u));if(u instanceof r.AudioInputStream)return new i(u);if(typeof MediaStream<"u"&&u instanceof MediaStream){const d=new t.PcmRecorder(!1);return new i(new t.MicAudioSource(d,null,null,u))}throw new Error("Not Supported Type")}static fromDefaultSpeakerOutput(){return new s(new r.SpeakerAudioDestination)}static fromSpeakerOutput(u){if(u===void 0)return Bc.fromDefaultSpeakerOutput();if(u instanceof r.SpeakerAudioDestination)return new s(u);throw new Error("Not Supported Type")}static fromAudioFileOutput(u){return new s(new o.AudioFileWriter(u))}static fromStreamOutput(u){if(u instanceof r.PushAudioOutputStreamCallback)return new s(new a.PushAudioOutputStreamImpl(u));if(u instanceof r.PushAudioOutputStream)return new s(u);if(u instanceof r.PullAudioOutputStream)return new s(u);throw new Error("Not Supported Type")}};he.AudioConfig=n;class i extends n{constructor(u){super(),this.privSource=u}get format(){return this.privSource.format}close(u,d){this.privSource.turnOff().then(()=>{u&&u()},h=>{d&&d(h)})}id(){return this.privSource.id()}turnOn(){return this.privSource.turnOn()}attach(u){return this.privSource.attach(u)}detach(u){return this.privSource.detach(u)}turnOff(){return this.privSource.turnOff()}get events(){return this.privSource.events}setProperty(u,d){if(e.Contracts.throwIfNull(d,"value"),this.privSource.setProperty!==void 0)this.privSource.setProperty(u,d);else throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(u,d){if(this.privSource.getProperty!==void 0)return this.privSource.getProperty(u,d);throw new Error("This AudioConfig instance does not support getting properties.")}get deviceInfo(){return this.privSource.deviceInfo}}he.AudioConfigImpl=i;class s extends n{constructor(u){super(),this.privDestination=u}set format(u){this.privDestination.format=u}write(u){this.privDestination.write(u)}close(){this.privDestination.close()}id(){return this.privDestination.id()}setProperty(){throw new Error("This AudioConfig instance does not support setting properties.")}getProperty(){throw new Error("This AudioConfig instance does not support getting properties.")}}return he.AudioOutputConfigImpl=s,he}var Fc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationReason=void 0,function(e){e[e.Error=0]="Error",e[e.EndOfStream=1]="EndOfStream"}(t.CancellationReason||(t.CancellationReason={}))})(Fc);var Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});Bi.PullAudioInputStreamCallback=void 0;class zl{}Bi.PullAudioInputStreamCallback=zl;var qi={};Object.defineProperty(qi,"__esModule",{value:!0});qi.PushAudioOutputStreamCallback=void 0;class jl{}qi.PushAudioOutputStreamCallback=jl;var Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});Fi.KeywordRecognitionModel=void 0;const Xs=b;class Ll{constructor(){this.privDisposed=!1}static fromFile(e){throw Xs.Contracts.throwIfFileDoesNotExist(e,"fileName"),new Error("Not yet implemented.")}static fromStream(e){throw Xs.Contracts.throwIfNull(e,"file"),new Error("Not yet implemented.")}close(){this.privDisposed||(this.privDisposed=!0)}}Fi.KeywordRecognitionModel=Ll;var xi={};Object.defineProperty(xi,"__esModule",{value:!0});xi.SessionEventArgs=void 0;class Bl{constructor(e){this.privSessionId=e}get sessionId(){return this.privSessionId}}xi.SessionEventArgs=Bl;var ht={},Zs;function ql(){if(Zs)return ht;Zs=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.RecognitionEventArgs=void 0;const t=P();let e=class extends t.SessionEventArgs{constructor(o,p){super(p),this.privOffset=o}get offset(){return this.privOffset}};return ht.RecognitionEventArgs=e,ht}var xc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OutputFormat=void 0,function(e){e[e.Simple=0]="Simple",e[e.Detailed=1]="Detailed"}(t.OutputFormat||(t.OutputFormat={}))})(xc);var lt={},Ys;function Fl(){if(Ys)return lt;Ys=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.IntentRecognitionEventArgs=void 0;const t=P();let e=class extends t.RecognitionEventArgs{constructor(o,p,a){super(p,a),this.privResult=o}get result(){return this.privResult}};return lt.IntentRecognitionEventArgs=e,lt}var Ui={};Object.defineProperty(Ui,"__esModule",{value:!0});Ui.RecognitionResult=void 0;class xl{constructor(e,r,o,p,a,n,i,s,c,u){this.privResultId=e,this.privReason=r,this.privText=o,this.privDuration=p,this.privOffset=a,this.privLanguage=n,this.privLanguageDetectionConfidence=i,this.privErrorDetails=s,this.privJson=c,this.privProperties=u}get resultId(){return this.privResultId}get reason(){return this.privReason}get text(){return this.privText}get duration(){return this.privDuration}get offset(){return this.privOffset}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}get errorDetails(){return this.privErrorDetails}get json(){return this.privJson}get properties(){return this.privProperties}}Ui.RecognitionResult=xl;var vt={},eo;function Ul(){if(eo)return vt;eo=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.SpeechRecognitionResult=void 0;const t=P();let e=class extends t.RecognitionResult{constructor(o,p,a,n,i,s,c,u,d,h,l){super(o,p,a,n,i,s,c,d,h,l),this.privSpeakerId=u}get speakerId(){return this.privSpeakerId}};return vt.SpeechRecognitionResult=e,vt}var ft={},to;function Wl(){if(to)return ft;to=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.IntentRecognitionResult=void 0;const t=P();let e=class extends t.SpeechRecognitionResult{constructor(o,p,a,n,i,s,c,u,d,h,l){super(p,a,n,i,s,c,u,void 0,d,h,l),this.privIntentId=o}get intentId(){return this.privIntentId}};return ft.IntentRecognitionResult=e,ft}var Qe={};Object.defineProperty(Qe,"__esModule",{value:!0});Qe.LanguageUnderstandingModelImpl=Qe.LanguageUnderstandingModel=void 0;const Je=b;class Uc{constructor(){}static fromEndpoint(e){Je.Contracts.throwIfNull(e,"uri"),Je.Contracts.throwIfNullOrWhitespace(e.hostname,"uri");const r=new ci,o=e.host.indexOf(".");if(o===-1)throw new Error("Could not determine region from endpoint");r.region=e.host.substr(0,o);const p=e.pathname.lastIndexOf("/")+1;if(p===-1)throw new Error("Could not determine appId from endpoint");if(r.appId=e.pathname.substr(p),r.subscriptionKey=e.searchParams.get("subscription-key"),r.subscriptionKey===void 0)throw new Error("Could not determine subscription key from endpoint");return r}static fromAppId(e){Je.Contracts.throwIfNullOrWhitespace(e,"appId");const r=new ci;return r.appId=e,r}static fromSubscription(e,r,o){Je.Contracts.throwIfNullOrWhitespace(e,"subscriptionKey"),Je.Contracts.throwIfNullOrWhitespace(r,"appId"),Je.Contracts.throwIfNullOrWhitespace(o,"region");const p=new ci;return p.appId=r,p.region=o,p.subscriptionKey=e,p}}Qe.LanguageUnderstandingModel=Uc;class ci extends Uc{}Qe.LanguageUnderstandingModelImpl=ci;var le={},ro;function Vl(){if(ro)return le;ro=1,Object.defineProperty(le,"__esModule",{value:!0}),le.MeetingTranscriptionEventArgs=le.ConversationTranscriptionEventArgs=le.SpeechRecognitionEventArgs=void 0;const t=P();let e=class extends t.RecognitionEventArgs{constructor(a,n,i){super(n,i),this.privResult=a}get result(){return this.privResult}};le.SpeechRecognitionEventArgs=e;class r extends t.RecognitionEventArgs{constructor(a,n,i){super(n,i),this.privResult=a}get result(){return this.privResult}}le.ConversationTranscriptionEventArgs=r;class o extends e{}return le.MeetingTranscriptionEventArgs=o,le}var gt={},mt={},io;function ei(){if(io)return mt;io=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.CancellationEventArgsBase=void 0;const t=P();let e=class extends t.RecognitionEventArgs{constructor(o,p,a,n,i){super(n,i),this.privReason=o,this.privErrorDetails=p,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return mt.CancellationEventArgsBase=e,mt}var no;function Hl(){if(no)return gt;no=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.SpeechRecognitionCanceledEventArgs=void 0;const t=ei();let e=class extends t.CancellationEventArgsBase{};return gt.SpeechRecognitionCanceledEventArgs=e,gt}var St={},so;function $l(){if(so)return St;so=1,Object.defineProperty(St,"__esModule",{value:!0}),St.TranslationRecognitionEventArgs=void 0;const t=P();let e=class extends t.RecognitionEventArgs{constructor(o,p,a){super(p,a),this.privResult=o}get result(){return this.privResult}};return St.TranslationRecognitionEventArgs=e,St}var Ct={},oo;function Kl(){if(oo)return Ct;oo=1,Object.defineProperty(Ct,"__esModule",{value:!0}),Ct.TranslationSynthesisEventArgs=void 0;const t=P();let e=class extends t.SessionEventArgs{constructor(o,p){super(p),this.privResult=o}get result(){return this.privResult}};return Ct.TranslationSynthesisEventArgs=e,Ct}var yt={},ao;function Vc(){if(ao)return yt;ao=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.TranslationRecognitionResult=void 0;const t=P();let e=class Wc extends t.SpeechRecognitionResult{constructor(o,p,a,n,i,s,c,u,d,h,l){super(p,a,n,i,s,c,u,void 0,d,h,l),this.privTranslations=o}static fromSpeechRecognitionResult(o){return new Wc(void 0,o.resultId,o.reason,o.text,o.duration,o.offset,o.language,o.languageDetectionConfidence,o.errorDetails,o.json,o.properties)}get translations(){return this.privTranslations}};return yt.TranslationRecognitionResult=e,yt}var Wi={};Object.defineProperty(Wi,"__esModule",{value:!0});Wi.TranslationSynthesisResult=void 0;class Jl{constructor(e,r){this.privReason=e,this.privAudio=r}get audio(){return this.privAudio}get reason(){return this.privReason}}Wi.TranslationSynthesisResult=Jl;var Hc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ResultReason=void 0,function(e){e[e.NoMatch=0]="NoMatch",e[e.Canceled=1]="Canceled",e[e.RecognizingSpeech=2]="RecognizingSpeech",e[e.RecognizedSpeech=3]="RecognizedSpeech",e[e.RecognizedKeyword=4]="RecognizedKeyword",e[e.RecognizingIntent=5]="RecognizingIntent",e[e.RecognizedIntent=6]="RecognizedIntent",e[e.TranslatingSpeech=7]="TranslatingSpeech",e[e.TranslatedSpeech=8]="TranslatedSpeech",e[e.SynthesizingAudio=9]="SynthesizingAudio",e[e.SynthesizingAudioCompleted=10]="SynthesizingAudioCompleted",e[e.SynthesizingAudioStarted=11]="SynthesizingAudioStarted",e[e.EnrollingVoiceProfile=12]="EnrollingVoiceProfile",e[e.EnrolledVoiceProfile=13]="EnrolledVoiceProfile",e[e.RecognizedSpeakers=14]="RecognizedSpeakers",e[e.RecognizedSpeaker=15]="RecognizedSpeaker",e[e.ResetVoiceProfile=16]="ResetVoiceProfile",e[e.DeletedVoiceProfile=17]="DeletedVoiceProfile",e[e.VoicesListRetrieved=18]="VoicesListRetrieved",e[e.TranslatingParticipantSpeech=19]="TranslatingParticipantSpeech",e[e.TranslatedParticipantSpeech=20]="TranslatedParticipantSpeech",e[e.TranslatedInstantMessage=21]="TranslatedInstantMessage",e[e.TranslatedParticipantInstantMessage=22]="TranslatedParticipantInstantMessage"}(t.ResultReason||(t.ResultReason={}))})(Hc);var be={},co;function Gl(){if(co)return be;co=1,Object.defineProperty(be,"__esModule",{value:!0}),be.SpeechConfigImpl=be.SpeechConfig=void 0;const t=T(),e=b,r=P();let o=class{constructor(){}static fromSubscription(n,i){e.Contracts.throwIfNullOrWhitespace(n,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(i,"region");const s=new p;return s.setProperty(r.PropertyId.SpeechServiceConnection_Region,i),s.setProperty(r.PropertyId.SpeechServiceConnection_IntentRegion,i),s.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),s}static fromEndpoint(n,i){e.Contracts.throwIfNull(n,"endpoint");const s=typeof i=="string"&&i.trim().length>0,c=typeof i=="object"&&i!==null&&typeof i.getToken=="function";if(i!==void 0&&!s&&!c)throw new Error("Invalid 'auth' parameter: must be a non-empty key string or a valid TokenCredential object.");const u=typeof i=="object"?new p(i):new p;return u.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,n.href),typeof i=="string"&&i.trim().length>0&&u.setProperty(r.PropertyId.SpeechServiceConnection_Key,i),u}static fromHost(n,i){e.Contracts.throwIfNull(n,"hostName");const s=new p;return s.setProperty(r.PropertyId.SpeechServiceConnection_Host,n.protocol+"//"+n.hostname+(n.port===""?"":":"+n.port)),s.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),i!==void 0&&s.setProperty(r.PropertyId.SpeechServiceConnection_Key,i),s}static fromAuthorizationToken(n,i){e.Contracts.throwIfNull(n,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(i,"region");const s=new p;return s.setProperty(r.PropertyId.SpeechServiceConnection_Region,i),s.setProperty(r.PropertyId.SpeechServiceConnection_IntentRegion,i),s.authorizationToken=n,s}close(){}};be.SpeechConfig=o;class p extends o{constructor(n){super(),this.privProperties=new r.PropertyCollection,this.speechRecognitionLanguage="en-US",this.outputFormat=r.OutputFormat.Simple,this.privTokenCredential=n}get properties(){return this.privProperties}get endPoint(){return new URL(this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint))}get subscriptionKey(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Key)}get region(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}get authorizationToken(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,n)}get speechRecognitionLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}set speechRecognitionLanguage(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,n)}get autoDetectSourceLanguages(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)}set autoDetectSourceLanguages(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n)}get outputFormat(){return r.OutputFormat[this.privProperties.getProperty(t.OutputFormatPropertyName,void 0)]}set outputFormat(n){this.privProperties.setProperty(t.OutputFormatPropertyName,r.OutputFormat[n])}get endpointId(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,n)}get tokenCredential(){return this.privTokenCredential}setProperty(n,i){e.Contracts.throwIfNull(i,"value"),this.privProperties.setProperty(n,i)}getProperty(n,i){return this.privProperties.getProperty(n,i)}setProxy(n,i,s,c){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],n),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],i),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],s),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],c)}setServiceProperty(n,i){const s=JSON.parse(this.privProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));s[n]=i,this.privProperties.setProperty(t.ServicePropertiesPropertyName,JSON.stringify(s))}setProfanity(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[n])}enableAudioLogging(){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true"),this.privProperties.setProperty(t.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Detailed])}enableDictation(){this.privProperties.setProperty(t.ForceDictationPropertyName,"true")}clone(){const n=new p(this.tokenCredential);return n.privProperties=this.privProperties.clone(),n}get speechSynthesisLanguage(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,n)}get speechSynthesisVoiceName(){return this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,n)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(n){this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[n])}}return be.SpeechConfigImpl=p,be}var Me={},po;function Ql(){if(po)return Me;po=1,Object.defineProperty(Me,"__esModule",{value:!0}),Me.SpeechTranslationConfigImpl=Me.SpeechTranslationConfig=void 0;const t=T(),e=b,r=P();let o=class extends r.SpeechConfig{constructor(){super()}static fromSubscription(n,i){e.Contracts.throwIfNullOrWhitespace(n,"subscriptionKey"),e.Contracts.throwIfNullOrWhitespace(i,"region");const s=new p;return s.properties.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),s.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,i),s}static fromAuthorizationToken(n,i){e.Contracts.throwIfNullOrWhitespace(n,"authorizationToken"),e.Contracts.throwIfNullOrWhitespace(i,"region");const s=new p;return s.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,n),s.properties.setProperty(r.PropertyId.SpeechServiceConnection_Region,i),s}static fromHost(n,i){e.Contracts.throwIfNull(n,"hostName");const s=new p;return s.setProperty(r.PropertyId.SpeechServiceConnection_Host,n.protocol+"//"+n.hostname+(n.port===""?"":":"+n.port)),i!==void 0&&s.setProperty(r.PropertyId.SpeechServiceConnection_Key,i),s}static fromEndpoint(n,i){e.Contracts.throwIfNull(n,"endpoint");const s=typeof i=="string"&&i.trim().length>0,c=typeof i=="object"&&i!==null&&typeof i.getToken=="function";if(i!==void 0&&!s&&!c)throw new Error("Invalid 'auth' parameter: must be a non-empty key string or a valid TokenCredential object.");const u=typeof i=="object"?new p(i):new p;return u.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,n.href),typeof i=="string"&&i.trim().length>0&&u.setProperty(r.PropertyId.SpeechServiceConnection_Key,i),u}};Me.SpeechTranslationConfig=o;class p extends o{constructor(n){super(),this.privSpeechProperties=new r.PropertyCollection,this.outputFormat=r.OutputFormat.Simple,this.privTokenCredential=n}set authorizationToken(n){e.Contracts.throwIfNullOrWhitespace(n,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,n)}set speechRecognitionLanguage(n){e.Contracts.throwIfNullOrWhitespace(n,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,n)}get speechRecognitionLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage])}get subscriptionKey(){return this.privSpeechProperties.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_Key])}get outputFormat(){return r.OutputFormat[this.privSpeechProperties.getProperty(t.OutputFormatPropertyName,void 0)]}set outputFormat(n){this.privSpeechProperties.setProperty(t.OutputFormatPropertyName,r.OutputFormat[n])}get endpointId(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId)}set endpointId(n){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EndpointId,n)}addTargetLanguage(n){e.Contracts.throwIfNullOrWhitespace(n,"value");const i=this.targetLanguages;i.includes(n)||(i.push(n),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,i.join(",")))}get targetLanguages(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","):[]}get voiceName(){return this.getProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_TranslationVoice])}set voiceName(n){e.Contracts.throwIfNullOrWhitespace(n,"value"),this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,n)}get region(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_Region)}get tokenCredential(){return this.privTokenCredential}setProxy(n,i,s,c){this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyHostName],n),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPort],i),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyUserName],s),this.setProperty(r.PropertyId[r.PropertyId.SpeechServiceConnection_ProxyPassword],c)}getProperty(n,i){return this.privSpeechProperties.getProperty(n,i)}setProperty(n,i){this.privSpeechProperties.setProperty(n,i)}get properties(){return this.privSpeechProperties}close(){}setServiceProperty(n,i){const s=JSON.parse(this.privSpeechProperties.getProperty(t.ServicePropertiesPropertyName,"{}"));s[n]=i,this.privSpeechProperties.setProperty(t.ServicePropertiesPropertyName,JSON.stringify(s))}setProfanity(n){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_ProfanityOption,r.ProfanityOption[n])}enableAudioLogging(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_EnableAudioLogging,"true")}requestWordLevelTimestamps(){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"true")}enableDictation(){this.privSpeechProperties.setProperty(t.ForceDictationPropertyName,"true")}get speechSynthesisLanguage(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage)}set speechSynthesisLanguage(n){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthLanguage,n)}get speechSynthesisVoiceName(){return this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthVoice)}set speechSynthesisVoiceName(n){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthVoice,n)}get speechSynthesisOutputFormat(){return r.SpeechSynthesisOutputFormat[this.privSpeechProperties.getProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)]}set speechSynthesisOutputFormat(n){this.privSpeechProperties.setProperty(r.PropertyId.SpeechServiceConnection_SynthOutputFormat,r.SpeechSynthesisOutputFormat[n])}}return Me.SpeechTranslationConfigImpl=p,Me}var Pt={},uo;function Kc(){if(uo)return Pt;uo=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.PropertyCollection=void 0;const t=P();let e=class $c{constructor(){this.privKeys=[],this.privValues=[]}getProperty(o,p){let a;typeof o=="string"?a=o:a=t.PropertyId[o];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===a)return this.privValues[n];if(p!==void 0)return String(p)}setProperty(o,p){let a;typeof o=="string"?a=o:a=t.PropertyId[o];for(let n=0;n<this.privKeys.length;n++)if(this.privKeys[n]===a){this.privValues[n]=p;return}this.privKeys.push(a),this.privValues.push(p)}clone(){const o=new $c;for(let p=0;p<this.privKeys.length;p++)o.privKeys.push(this.privKeys[p]),o.privValues.push(this.privValues[p]);return o}mergeTo(o){this.privKeys.forEach(p=>{if(o.getProperty(p,void 0)===void 0){const a=this.getProperty(p);o.setProperty(p,a)}})}get keys(){return this.privKeys}};return Pt.PropertyCollection=e,Pt}var Vi={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyId=void 0,function(e){e[e.SpeechServiceConnection_Key=0]="SpeechServiceConnection_Key",e[e.SpeechServiceConnection_Endpoint=1]="SpeechServiceConnection_Endpoint",e[e.SpeechServiceConnection_Region=2]="SpeechServiceConnection_Region",e[e.SpeechServiceAuthorization_Token=3]="SpeechServiceAuthorization_Token",e[e.SpeechServiceAuthorization_Type=4]="SpeechServiceAuthorization_Type",e[e.SpeechServiceConnection_EndpointId=5]="SpeechServiceConnection_EndpointId",e[e.SpeechServiceConnection_TranslationToLanguages=6]="SpeechServiceConnection_TranslationToLanguages",e[e.SpeechServiceConnection_TranslationVoice=7]="SpeechServiceConnection_TranslationVoice",e[e.SpeechServiceConnection_TranslationFeatures=8]="SpeechServiceConnection_TranslationFeatures",e[e.SpeechServiceConnection_TranslationCategoryId=9]="SpeechServiceConnection_TranslationCategoryId",e[e.SpeechServiceConnection_IntentRegion=10]="SpeechServiceConnection_IntentRegion",e[e.SpeechServiceConnection_ProxyHostName=11]="SpeechServiceConnection_ProxyHostName",e[e.SpeechServiceConnection_ProxyPort=12]="SpeechServiceConnection_ProxyPort",e[e.SpeechServiceConnection_ProxyUserName=13]="SpeechServiceConnection_ProxyUserName",e[e.SpeechServiceConnection_ProxyPassword=14]="SpeechServiceConnection_ProxyPassword",e[e.SpeechServiceConnection_RecoMode=15]="SpeechServiceConnection_RecoMode",e[e.SpeechServiceConnection_RecoLanguage=16]="SpeechServiceConnection_RecoLanguage",e[e.Speech_SessionId=17]="Speech_SessionId",e[e.SpeechServiceConnection_SynthLanguage=18]="SpeechServiceConnection_SynthLanguage",e[e.SpeechServiceConnection_SynthVoice=19]="SpeechServiceConnection_SynthVoice",e[e.SpeechServiceConnection_SynthOutputFormat=20]="SpeechServiceConnection_SynthOutputFormat",e[e.SpeechServiceConnection_AutoDetectSourceLanguages=21]="SpeechServiceConnection_AutoDetectSourceLanguages",e[e.SpeechServiceResponse_RequestDetailedResultTrueFalse=22]="SpeechServiceResponse_RequestDetailedResultTrueFalse",e[e.SpeechServiceResponse_RequestProfanityFilterTrueFalse=23]="SpeechServiceResponse_RequestProfanityFilterTrueFalse",e[e.SpeechServiceResponse_JsonResult=24]="SpeechServiceResponse_JsonResult",e[e.SpeechServiceResponse_JsonErrorDetails=25]="SpeechServiceResponse_JsonErrorDetails",e[e.CancellationDetails_Reason=26]="CancellationDetails_Reason",e[e.CancellationDetails_ReasonText=27]="CancellationDetails_ReasonText",e[e.CancellationDetails_ReasonDetailedText=28]="CancellationDetails_ReasonDetailedText",e[e.LanguageUnderstandingServiceResponse_JsonResult=29]="LanguageUnderstandingServiceResponse_JsonResult",e[e.SpeechServiceConnection_Url=30]="SpeechServiceConnection_Url",e[e.SpeechServiceConnection_InitialSilenceTimeoutMs=31]="SpeechServiceConnection_InitialSilenceTimeoutMs",e[e.SpeechServiceConnection_EndSilenceTimeoutMs=32]="SpeechServiceConnection_EndSilenceTimeoutMs",e[e.Speech_SegmentationSilenceTimeoutMs=33]="Speech_SegmentationSilenceTimeoutMs",e[e.Speech_SegmentationMaximumTimeMs=34]="Speech_SegmentationMaximumTimeMs",e[e.Speech_SegmentationStrategy=35]="Speech_SegmentationStrategy",e[e.SpeechServiceConnection_EnableAudioLogging=36]="SpeechServiceConnection_EnableAudioLogging",e[e.SpeechServiceConnection_LanguageIdMode=37]="SpeechServiceConnection_LanguageIdMode",e[e.SpeechServiceConnection_RecognitionEndpointVersion=38]="SpeechServiceConnection_RecognitionEndpointVersion",e[e.SpeechServiceConnection_SpeakerIdMode=39]="SpeechServiceConnection_SpeakerIdMode",e[e.SpeechServiceResponse_ProfanityOption=40]="SpeechServiceResponse_ProfanityOption",e[e.SpeechServiceResponse_PostProcessingOption=41]="SpeechServiceResponse_PostProcessingOption",e[e.SpeechServiceResponse_RequestWordLevelTimestamps=42]="SpeechServiceResponse_RequestWordLevelTimestamps",e[e.SpeechServiceResponse_StablePartialResultThreshold=43]="SpeechServiceResponse_StablePartialResultThreshold",e[e.SpeechServiceResponse_OutputFormatOption=44]="SpeechServiceResponse_OutputFormatOption",e[e.SpeechServiceResponse_TranslationRequestStablePartialResult=45]="SpeechServiceResponse_TranslationRequestStablePartialResult",e[e.SpeechServiceResponse_RequestWordBoundary=46]="SpeechServiceResponse_RequestWordBoundary",e[e.SpeechServiceResponse_RequestPunctuationBoundary=47]="SpeechServiceResponse_RequestPunctuationBoundary",e[e.SpeechServiceResponse_RequestSentenceBoundary=48]="SpeechServiceResponse_RequestSentenceBoundary",e[e.SpeechServiceResponse_DiarizeIntermediateResults=49]="SpeechServiceResponse_DiarizeIntermediateResults",e[e.Conversation_ApplicationId=50]="Conversation_ApplicationId",e[e.Conversation_DialogType=51]="Conversation_DialogType",e[e.Conversation_Initial_Silence_Timeout=52]="Conversation_Initial_Silence_Timeout",e[e.Conversation_From_Id=53]="Conversation_From_Id",e[e.Conversation_Conversation_Id=54]="Conversation_Conversation_Id",e[e.Conversation_Custom_Voice_Deployment_Ids=55]="Conversation_Custom_Voice_Deployment_Ids",e[e.Conversation_Speech_Activity_Template=56]="Conversation_Speech_Activity_Template",e[e.Conversation_Request_Bot_Status_Messages=57]="Conversation_Request_Bot_Status_Messages",e[e.Conversation_Agent_Connection_Id=58]="Conversation_Agent_Connection_Id",e[e.SpeechServiceConnection_Host=59]="SpeechServiceConnection_Host",e[e.ConversationTranslator_Host=60]="ConversationTranslator_Host",e[e.ConversationTranslator_Name=61]="ConversationTranslator_Name",e[e.ConversationTranslator_CorrelationId=62]="ConversationTranslator_CorrelationId",e[e.ConversationTranslator_Token=63]="ConversationTranslator_Token",e[e.PronunciationAssessment_ReferenceText=64]="PronunciationAssessment_ReferenceText",e[e.PronunciationAssessment_GradingSystem=65]="PronunciationAssessment_GradingSystem",e[e.PronunciationAssessment_Granularity=66]="PronunciationAssessment_Granularity",e[e.PronunciationAssessment_EnableMiscue=67]="PronunciationAssessment_EnableMiscue",e[e.PronunciationAssessment_Json=68]="PronunciationAssessment_Json",e[e.PronunciationAssessment_Params=69]="PronunciationAssessment_Params",e[e.SpeakerRecognition_Api_Version=70]="SpeakerRecognition_Api_Version",e[e.WebWorkerLoadType=71]="WebWorkerLoadType",e[e.TalkingAvatarService_WebRTC_SDP=72]="TalkingAvatarService_WebRTC_SDP"}(t.PropertyId||(t.PropertyId={}))})(Vi);var Rt={},ho;function Xl(){if(ho)return Rt;ho=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.Recognizer=void 0;const t=T(),e=A(),r=b,o=P();let p=class Jc{constructor(n,i,s,c){this.audioConfig=n!==void 0?n:o.AudioConfig.fromDefaultMicrophoneInput(),this.privDisposed=!1,this.privProperties=i.clone(),this.privConnectionFactory=s,this.tokenCredential=c,this.implCommonRecognizerSetup()}close(n,i){r.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),n,i)}get internalData(){return this.privReco}async dispose(n){this.privDisposed||(this.privDisposed=!0,n&&this.privReco&&(await this.privReco.audioSource.turnOff(),await this.privReco.dispose()))}static get telemetryEnabled(){return t.ServiceRecognizerBase.telemetryDataEnabled}static enableTelemetry(n){t.ServiceRecognizerBase.telemetryDataEnabled=n}implCommonRecognizerSetup(){let n=typeof window<"u"?"Browser":"Node",i="unknown",s="unknown";typeof navigator<"u"&&(n=n+"/"+navigator.platform,i=navigator.userAgent,s=navigator.appVersion);const c=this.createRecognizerConfig(new t.SpeechServiceConfig(new t.Context(new t.OS(n,i,s))));this.privReco=this.createServiceRecognizer(Jc.getAuth(this.privProperties,this.tokenCredential),this.privConnectionFactory,this.audioConfig,c)}async recognizeOnceAsyncImpl(n){r.Contracts.throwIfDisposed(this.privDisposed);const i=new e.Deferred;await this.implRecognizerStop(),await this.privReco.recognize(n,i.resolve,i.reject);const s=await i.promise;return await this.implRecognizerStop(),s}async startContinuousRecognitionAsyncImpl(n){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop(),await this.privReco.recognize(n,void 0,void 0)}async stopContinuousRecognitionAsyncImpl(){r.Contracts.throwIfDisposed(this.privDisposed),await this.implRecognizerStop()}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}static getAuth(n,i){const s=n.getProperty(o.PropertyId.SpeechServiceConnection_Key,void 0);return s&&s!==""?new t.CognitiveSubscriptionKeyAuthentication(s):i?new t.CognitiveTokenAuthentication(async()=>{try{const c=await i.getToken("https://cognitiveservices.azure.com/.default");return(c==null?void 0:c.token)??""}catch(c){throw c}},async()=>{try{const c=await i.getToken("https://cognitiveservices.azure.com/.default");return(c==null?void 0:c.token)??""}catch(c){throw c}}):new t.CognitiveTokenAuthentication(()=>{const c=n.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)},()=>{const c=n.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(c)})}};return Rt.Recognizer=p,Rt}var Et={},ne={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.RecognitionMode=void 0,function(e){e.Interactive="Interactive",e.Dictation="Dictation",e.Conversation="Conversation",e.None="None"}(t.RecognitionMode||(t.RecognitionMode={}))})(ne);var lo;function Zl(){if(lo)return Et;lo=1,Object.defineProperty(Et,"__esModule",{value:!0}),Et.SpeechRecognizer=void 0;const t=T(),e=ne,r=A(),o=b,p=P();let a=class Gc extends p.Recognizer{constructor(i,s){const c=i;o.Contracts.throwIfNull(c,"speechConfig"),o.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(p.PropertyId.SpeechServiceConnection_RecoLanguage),p.PropertyId[p.PropertyId.SpeechServiceConnection_RecoLanguage]),super(s,c.properties,new t.SpeechConnectionFactory,i.tokenCredential),this.privDisposedRecognizer=!1}static FromConfig(i,s,c){const u=i;return s.properties.mergeTo(u.properties),new Gc(i,c)}get endpointId(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(p.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(p.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){o.Contracts.throwIfNullOrWhitespace(i,"token"),this.properties.setProperty(p.PropertyId.SpeechServiceAuthorization_Token,i)}get speechRecognitionLanguage(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(p.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(t.OutputFormatPropertyName,p.OutputFormat[p.OutputFormat.Simple])===p.OutputFormat[p.OutputFormat.Simple]?p.OutputFormat.Simple:p.OutputFormat.Detailed}get properties(){return this.privProperties}recognizeOnceAsync(i,s){(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),i,s)}startContinuousRecognitionAsync(i,s){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(this.properties.getProperty(t.ForceDictationPropertyName,void 0)===void 0?e.RecognitionMode.Conversation:e.RecognitionMode.Dictation),i,s)}stopContinuousRecognitionAsync(i,s){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),i,s)}startKeywordRecognitionAsync(i,s,c){o.Contracts.throwIfNull(i,"model"),c&&c("Not yet implemented.")}stopKeywordRecognitionAsync(i){i&&i()}close(i,s){o.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),i,s)}async dispose(i){this.privDisposedRecognizer||(i&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(i))}createRecognizerConfig(i){return new t.RecognizerConfig(i,this.privProperties)}createServiceRecognizer(i,s,c,u){const d=c;return new t.SpeechServiceRecognizer(i,s,d,u,this)}};return Et.SpeechRecognizer=a,Et}var It={},vo;function Yl(){if(vo)return It;vo=1,Object.defineProperty(It,"__esModule",{value:!0}),It.IntentRecognizer=void 0;const t=T(),e=ne,r=A(),o=b,p=P();let a=class extends p.Recognizer{constructor(i,s){o.Contracts.throwIfNullOrUndefined(i,"speechConfig");const c=i;o.Contracts.throwIfNullOrUndefined(c,"speechConfig"),super(s,c.properties,new t.IntentConnectionFactory),this.privAddedIntents=[],this.privAddedLmIntents={},this.privDisposedIntentRecognizer=!1,this.privProperties=c.properties,o.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(p.PropertyId.SpeechServiceConnection_RecoLanguage),p.PropertyId[p.PropertyId.SpeechServiceConnection_RecoLanguage])}get speechRecognitionLanguage(){return o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),this.properties.getProperty(p.PropertyId.SpeechServiceConnection_RecoLanguage)}get authorizationToken(){return this.properties.getProperty(p.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){this.properties.setProperty(p.PropertyId.SpeechServiceAuthorization_Token,i)}get properties(){return this.privProperties}recognizeOnceAsync(i,s){if(o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const c=this.buildSpeechContext();this.privReco.speechContext.getContext().intent=c.Intent,this.privReco.dynamicGrammar.addReferenceGrammar(c.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),i,s)}startContinuousRecognitionAsync(i,s){if(Object.keys(this.privAddedLmIntents).length!==0||this.privUmbrellaIntent!==void 0){const c=this.buildSpeechContext();this.privReco.speechContext.getContext().intent=c.Intent,this.privReco.dynamicGrammar.addReferenceGrammar(c.ReferenceGrammars),this.privReco.setIntents(this.privAddedLmIntents,this.privUmbrellaIntent)}(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),i,s)}stopContinuousRecognitionAsync(i,s){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),i,s)}startKeywordRecognitionAsync(i,s,c){o.Contracts.throwIfNull(i,"model"),c&&c("Not yet implemented.")}stopKeywordRecognitionAsync(i,s){if(i)try{i()}catch(c){s&&s(c)}}addIntent(i,s){o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),o.Contracts.throwIfNullOrWhitespace(s,"intentId"),o.Contracts.throwIfNullOrWhitespace(i,"simplePhrase"),this.privAddedIntents.push([s,i])}addIntentWithLanguageModel(i,s,c){o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),o.Contracts.throwIfNullOrWhitespace(i,"intentId"),o.Contracts.throwIfNull(s,"model");const u=s;o.Contracts.throwIfNullOrWhitespace(u.appId,"model.appId"),this.privAddedLmIntents[i]=new t.AddedLmIntent(u,c)}addAllIntents(i,s){o.Contracts.throwIfNull(i,"model");const c=i;o.Contracts.throwIfNullOrWhitespace(c.appId,"model.appId"),this.privUmbrellaIntent=new t.AddedLmIntent(c,s)}close(i,s){o.Contracts.throwIfDisposed(this.privDisposedIntentRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),i,s)}createRecognizerConfig(i){return new t.RecognizerConfig(i,this.privProperties)}createServiceRecognizer(i,s,c,u){const d=c;return new t.IntentServiceRecognizer(i,s,d,u,this)}async dispose(i){this.privDisposedIntentRecognizer||i&&(this.privDisposedIntentRecognizer=!0,await super.dispose(i))}buildSpeechContext(){let i,s,c;const u=[];this.privUmbrellaIntent!==void 0&&(i=this.privUmbrellaIntent.modelImpl.appId,s=this.privUmbrellaIntent.modelImpl.region,c=this.privUmbrellaIntent.modelImpl.subscriptionKey);for(const d of Object.keys(this.privAddedLmIntents)){const h=this.privAddedLmIntents[d];if(i===void 0)i=h.modelImpl.appId;else if(i!==h.modelImpl.appId)throw new Error("Intents must all be from the same LUIS model");if(s===void 0)s=h.modelImpl.region;else if(s!==h.modelImpl.region)throw new Error("Intents must all be from the same LUIS model in a single region");if(c===void 0)c=h.modelImpl.subscriptionKey;else if(c!==h.modelImpl.subscriptionKey)throw new Error("Intents must all use the same subscription key");const l="luis/"+i+"-PRODUCTION#"+d;u.push(l)}return{Intent:{id:i,key:c===void 0?this.privProperties.getProperty(p.PropertyId[p.PropertyId.SpeechServiceConnection_Key]):c,provider:"LUIS"},ReferenceGrammars:this.privUmbrellaIntent===void 0?u:["luis/"+i+"-PRODUCTION"]}}};return It.IntentRecognizer=a,It}var Qc={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceProfileType=void 0,function(e){e[e.TextIndependentIdentification=0]="TextIndependentIdentification",e[e.TextDependentVerification=1]="TextDependentVerification",e[e.TextIndependentVerification=2]="TextIndependentVerification"}(t.VoiceProfileType||(t.VoiceProfileType={}))})(Qc);var Tt={},At={},Oe={},fo;function Xc(){if(fo)return Oe;fo=1,Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.ConnectionMessageImpl=Oe.ConnectionMessage=void 0;const t=F,e=A(),r=Kc(),o=Vi;let p=class{};Oe.ConnectionMessage=p;class a{constructor(i){this.privConnectionMessage=i,this.privProperties=new r.PropertyCollection,this.privConnectionMessage.headers[t.HeaderNames.ConnectionId]&&this.privProperties.setProperty(o.PropertyId.Speech_SessionId,this.privConnectionMessage.headers[t.HeaderNames.ConnectionId]),Object.keys(this.privConnectionMessage.headers).forEach(s=>{this.privProperties.setProperty(s,this.privConnectionMessage.headers[s])})}get path(){return this.privConnectionMessage.headers[Object.keys(this.privConnectionMessage.headers).find(i=>i.toLowerCase()==="path".toLowerCase())]}get isTextMessage(){return this.privConnectionMessage.messageType===e.MessageType.Text}get isBinaryMessage(){return this.privConnectionMessage.messageType===e.MessageType.Binary}get TextMessage(){return this.privConnectionMessage.textBody}get binaryMessage(){return this.privConnectionMessage.binaryBody}get properties(){return this.privProperties}toString(){return""}}return Oe.ConnectionMessageImpl=a,Oe}var go;function Zc(){if(go)return At;go=1,Object.defineProperty(At,"__esModule",{value:!0}),At.Connection=void 0;const t=T(),e=A(),r=Xc(),o=b,p=P();let a=class Zn{static fromRecognizer(i){const s=i.internalData,c=new Zn;return c.privInternalData=s,c.setupEvents(),c}static fromSynthesizer(i){const s=i.internalData,c=new Zn;return c.privInternalData=s,c.setupEvents(),c}openConnection(i,s){(0,e.marshalPromiseToCallbacks)(this.privInternalData.connect(),i,s)}closeConnection(i,s){if(this.privInternalData instanceof t.SynthesisAdapterBase)throw new Error("Disconnecting a synthesizer's connection is currently not supported");(0,e.marshalPromiseToCallbacks)(this.privInternalData.disconnect(),i,s)}setMessageProperty(i,s,c){if(o.Contracts.throwIfNullOrWhitespace(s,"propertyName"),this.privInternalData instanceof t.ServiceRecognizerBase){if(i.toLowerCase()!=="speech.context")throw new Error("Only speech.context message property sets are currently supported for recognizer");{const u=this.privInternalData.speechContext.getContext();u[s]=c}}else if(this.privInternalData instanceof t.SynthesisAdapterBase){if(i.toLowerCase()!=="synthesis.context")throw new Error("Only synthesis.context message property sets are currently supported for synthesizer");this.privInternalData.synthesisContext.setSection(s,c)}}sendMessageAsync(i,s,c,u){(0,e.marshalPromiseToCallbacks)(this.privInternalData.sendNetworkMessage(i,s),c,u)}close(){}setupEvents(){this.privEventListener=this.privInternalData.connectionEvents.attach(i=>{i.name==="ConnectionEstablishedEvent"?this.connected&&this.connected(new p.ConnectionEventArgs(i.connectionId)):i.name==="ConnectionClosedEvent"?this.disconnected&&this.disconnected(new p.ConnectionEventArgs(i.connectionId)):i.name==="ConnectionMessageSentEvent"?this.messageSent&&this.messageSent(new p.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(i.message))):i.name==="ConnectionMessageReceivedEvent"&&this.messageReceived&&this.messageReceived(new p.ConnectionMessageEventArgs(new r.ConnectionMessageImpl(i.message)))}),this.privServiceEventListener=this.privInternalData.serviceEvents.attach(i=>{this.receivedServiceMessage&&this.receivedServiceMessage(new p.ServiceEventArgs(i.jsonString,i.name))})}};return At.Connection=a,At}var mo;function ev(){if(mo)return Tt;mo=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.TranslationRecognizer=void 0;const t=T(),e=ne,r=A(),o=Zc(),p=b,a=P();let n=class Yc extends a.Recognizer{constructor(s,c,u){const d=s;p.Contracts.throwIfNull(d,"speechConfig"),super(c,d.properties,u||new t.TranslationConnectionFactory,s.tokenCredential),this.privDisposedTranslationRecognizer=!1,this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&p.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationVoice]),p.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages),a.PropertyId[a.PropertyId.SpeechServiceConnection_TranslationToLanguages]),p.Contracts.throwIfNullOrWhitespace(this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage),a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage])}static FromConfig(s,c,u){const d=s;return c.properties.mergeTo(d.properties),c.properties.getProperty(a.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)===t.AutoDetectSourceLanguagesOpenRangeOptionName&&d.properties.setProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),new Yc(s,u)}get speechRecognitionLanguage(){return p.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_RecoLanguage)}get targetLanguages(){return p.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(",")}get voiceName(){return p.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(a.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(s){this.properties.setProperty(a.PropertyId.SpeechServiceAuthorization_Token,s)}recognizeOnceAsync(s,c){p.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,r.marshalPromiseToCallbacks)(this.recognizeOnceAsyncImpl(e.RecognitionMode.Interactive),s,c)}startContinuousRecognitionAsync(s,c){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),s,c)}stopContinuousRecognitionAsync(s,c){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),s,c)}removeTargetLanguage(s){if(p.Contracts.throwIfNullOrUndefined(s,"language to be removed"),this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0){const c=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),u=c.indexOf(s);u>-1&&(c.splice(u,1),this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")),this.updateLanguages(c))}}addTargetLanguage(s){p.Contracts.throwIfNullOrUndefined(s,"language to be added");let c=[];this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0?(c=this.properties.getProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages).split(","),c.includes(s)||(c.push(s),this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,c.join(",")))):(this.properties.setProperty(a.PropertyId.SpeechServiceConnection_TranslationToLanguages,s),c=[s]),this.updateLanguages(c)}close(s,c){p.Contracts.throwIfDisposed(this.privDisposedTranslationRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),s,c)}onConnection(){}async dispose(s){this.privDisposedTranslationRecognizer||(this.privDisposedTranslationRecognizer=!0,s&&(await this.implRecognizerStop(),await super.dispose(s)))}createRecognizerConfig(s){return new t.RecognizerConfig(s,this.privProperties)}createServiceRecognizer(s,c,u,d){const h=u;return new t.TranslationServiceRecognizer(s,c,h,d,this)}updateLanguages(s){const c=o.Connection.fromRecognizer(this);c&&(c.setMessageProperty("speech.context","translationcontext",{to:s}),c.sendMessageAsync("event",JSON.stringify({id:"translation",name:"updateLanguage",to:s})))}};return Tt.TranslationRecognizer=n,Tt}var wt={},So;function tv(){if(So)return wt;So=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.Translations=void 0;const t=P();let e=class{constructor(){this.privMap=new t.PropertyCollection}get languages(){return this.privMap.keys}get(o,p){return this.privMap.getProperty(o,p)}set(o,p){this.privMap.setProperty(o,p)}};return wt.Translations=e,wt}var ep={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.NoMatchReason=void 0,function(e){e[e.NotRecognized=0]="NotRecognized",e[e.InitialSilenceTimeout=1]="InitialSilenceTimeout",e[e.InitialBabbleTimeout=2]="InitialBabbleTimeout"}(t.NoMatchReason||(t.NoMatchReason={}))})(ep);var _t={},Co;function rv(){if(Co)return _t;Co=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.NoMatchDetails=void 0;const t=T(),e=P();let r=class tp{constructor(p){this.privReason=p}static fromResult(p){const a=t.SimpleSpeechPhrase.fromJSON(p.json,0);let n=e.NoMatchReason.NotRecognized;switch(a.RecognitionStatus){case t.RecognitionStatus.BabbleTimeout:n=e.NoMatchReason.InitialBabbleTimeout;break;case t.RecognitionStatus.InitialSilenceTimeout:n=e.NoMatchReason.InitialSilenceTimeout;break;default:n=e.NoMatchReason.NotRecognized;break}return new tp(n)}get reason(){return this.privReason}};return _t.NoMatchDetails=r,_t}var Hi={};Object.defineProperty(Hi,"__esModule",{value:!0});Hi.TranslationRecognitionCanceledEventArgs=void 0;class iv{constructor(e,r,o,p,a){this.privCancelReason=r,this.privErrorDetails=o,this.privResult=a,this.privSessionId=e,this.privErrorCode=p}get result(){return this.privResult}get sessionId(){return this.privSessionId}get reason(){return this.privCancelReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}}Hi.TranslationRecognitionCanceledEventArgs=iv;var bt={},yo;function nv(){if(yo)return bt;yo=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.IntentRecognitionCanceledEventArgs=void 0;const t=P();let e=class extends t.IntentRecognitionEventArgs{constructor(o,p,a,n,i,s){super(n,i,s),this.privReason=o,this.privErrorDetails=p,this.privErrorCode=a}get reason(){return this.privReason}get errorCode(){return this.privErrorCode}get errorDetails(){return this.privErrorDetails}};return bt.IntentRecognitionCanceledEventArgs=e,bt}var ti={};Object.defineProperty(ti,"__esModule",{value:!0});ti.CancellationDetailsBase=void 0;class sv{constructor(e,r,o){this.privReason=e,this.privErrorDetails=r,this.privErrorCode=o}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get ErrorCode(){return this.privErrorCode}}ti.CancellationDetailsBase=sv;var Mt={},Po;function ov(){if(Po)return Mt;Po=1,Object.defineProperty(Mt,"__esModule",{value:!0}),Mt.CancellationDetails=void 0;const t=T(),e=ti,r=P();let o=class rp extends e.CancellationDetailsBase{constructor(a,n,i){super(a,n,i)}static fromResult(a){let n=r.CancellationReason.Error,i=r.CancellationErrorCode.NoError;if(a instanceof r.RecognitionResult&&a.json){const s=t.SimpleSpeechPhrase.fromJSON(a.json,0);n=t.EnumTranslation.implTranslateCancelResult(s.RecognitionStatus)}return a.properties&&(i=r.CancellationErrorCode[a.properties.getProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new rp(n,a.errorDetails||t.EnumTranslation.implTranslateErrorDetails(i),i)}};return Mt.CancellationDetails=o,Mt}var ip={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.CancellationErrorCode=void 0,function(e){e[e.NoError=0]="NoError",e[e.AuthenticationFailure=1]="AuthenticationFailure",e[e.BadRequestParameters=2]="BadRequestParameters",e[e.TooManyRequests=3]="TooManyRequests",e[e.ConnectionFailure=4]="ConnectionFailure",e[e.ServiceTimeout=5]="ServiceTimeout",e[e.ServiceError=6]="ServiceError",e[e.RuntimeError=7]="RuntimeError",e[e.Forbidden=8]="Forbidden"}(t.CancellationErrorCode||(t.CancellationErrorCode={}))})(ip);var Ot={},Ro;function av(){if(Ro)return Ot;Ro=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.ConnectionEventArgs=void 0;const t=P();let e=class extends t.SessionEventArgs{};return Ot.ConnectionEventArgs=e,Ot}var Dt={},Eo;function cv(){if(Eo)return Dt;Eo=1,Object.defineProperty(Dt,"__esModule",{value:!0}),Dt.ServiceEventArgs=void 0;const t=P();let e=class extends t.SessionEventArgs{constructor(o,p,a){super(a),this.privJsonResult=o,this.privEventName=p}get jsonString(){return this.privJsonResult}get eventName(){return this.privEventName}};return Dt.ServiceEventArgs=e,Dt}var $i={};Object.defineProperty($i,"__esModule",{value:!0});$i.PhraseListGrammar=void 0;class us{constructor(e){this.privGrammerBuilder=e.dynamicGrammar}static fromRecognizer(e){const r=e.internalData;return new us(r)}addPhrase(e){this.privGrammerBuilder.addPhrase(e)}addPhrases(e){this.privGrammerBuilder.addPhrase(e)}clear(){this.privGrammerBuilder.clearPhrases()}}$i.PhraseListGrammar=us;var De={},Io;function ds(){if(Io)return De;Io=1,Object.defineProperty(De,"__esModule",{value:!0}),De.DialogServiceConfigImpl=De.DialogServiceConfig=void 0;const t=b,e=P();let r=class{constructor(){}set applicationId(a){}static get DialogTypes(){return{BotFramework:"bot_framework",CustomCommands:"custom_commands"}}};De.DialogServiceConfig=r;class o extends r{constructor(){super(),this.privSpeechConfig=new e.SpeechConfigImpl}get properties(){return this.privSpeechConfig.properties}get speechRecognitionLanguage(){return this.privSpeechConfig.speechRecognitionLanguage}set speechRecognitionLanguage(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.privSpeechConfig.speechRecognitionLanguage=a}get outputFormat(){return this.privSpeechConfig.outputFormat}set outputFormat(a){this.privSpeechConfig.outputFormat=a}setProperty(a,n){this.privSpeechConfig.setProperty(a,n)}getProperty(a,n){return this.privSpeechConfig.getProperty(a)}setProxy(a,n,i,s){this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyHostName,a),this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPort,`${n}`),i&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyUserName,i),s&&this.setProperty(e.PropertyId.SpeechServiceConnection_ProxyPassword,s)}setServiceProperty(a,n,i){this.privSpeechConfig.setServiceProperty(a,n)}close(){}}return De.DialogServiceConfigImpl=o,De}var kt={},To;function pv(){if(To)return kt;To=1,Object.defineProperty(kt,"__esModule",{value:!0}),kt.BotFrameworkConfig=void 0;const t=b,e=ds(),r=P();let o=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,n,i){t.Contracts.throwIfNullOrWhitespace(a,"subscription"),t.Contracts.throwIfNullOrWhitespace(n,"region");const s=new e.DialogServiceConfigImpl;return s.setProperty(r.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(r.PropertyId.SpeechServiceConnection_Key,a),s.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),i&&s.setProperty(r.PropertyId.Conversation_ApplicationId,i),s}static fromAuthorizationToken(a,n,i){t.Contracts.throwIfNullOrWhitespace(a,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(n,"region");const s=new e.DialogServiceConfigImpl;return s.setProperty(r.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),s.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a),s.setProperty(r.PropertyId.SpeechServiceConnection_Region,n),i&&s.setProperty(r.PropertyId.Conversation_ApplicationId,i),s}static fromHost(a,n,i){t.Contracts.throwIfNullOrUndefined(a,"host");const s=a instanceof URL?a:new URL(`wss://${a}.convai.speech.azure.us`);t.Contracts.throwIfNullOrUndefined(s,"resolvedHost");const c=new e.DialogServiceConfigImpl;return c.setProperty(r.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),c.setProperty(r.PropertyId.SpeechServiceConnection_Host,s.toString()),n!==void 0&&c.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),c}static fromEndpoint(a,n){t.Contracts.throwIfNull(a,"endpoint");const i=new e.DialogServiceConfigImpl;return i.setProperty(r.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.BotFramework),i.setProperty(r.PropertyId.SpeechServiceConnection_Endpoint,a.toString()),n!==void 0&&i.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),i}};return kt.BotFrameworkConfig=o,kt}var Nt={},Ao;function uv(){if(Ao)return Nt;Ao=1,Object.defineProperty(Nt,"__esModule",{value:!0}),Nt.CustomCommandsConfig=void 0;const t=b,e=ds(),r=P();let o=class extends e.DialogServiceConfigImpl{constructor(){super()}static fromSubscription(a,n,i){t.Contracts.throwIfNullOrWhitespace(a,"applicationId"),t.Contracts.throwIfNullOrWhitespace(n,"subscription"),t.Contracts.throwIfNullOrWhitespace(i,"region");const s=new e.DialogServiceConfigImpl;return s.setProperty(r.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),s.setProperty(r.PropertyId.Conversation_ApplicationId,a),s.setProperty(r.PropertyId.SpeechServiceConnection_Key,n),s.setProperty(r.PropertyId.SpeechServiceConnection_Region,i),s}static fromAuthorizationToken(a,n,i){t.Contracts.throwIfNullOrWhitespace(a,"applicationId"),t.Contracts.throwIfNullOrWhitespace(n,"authorizationToken"),t.Contracts.throwIfNullOrWhitespace(i,"region");const s=new e.DialogServiceConfigImpl;return s.setProperty(r.PropertyId.Conversation_DialogType,e.DialogServiceConfig.DialogTypes.CustomCommands),s.setProperty(r.PropertyId.Conversation_ApplicationId,a),s.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,n),s.setProperty(r.PropertyId.SpeechServiceConnection_Region,i),s}set applicationId(a){t.Contracts.throwIfNullOrWhitespace(a,"value"),this.setProperty(r.PropertyId.Conversation_ApplicationId,a)}get applicationId(){return this.getProperty(r.PropertyId.Conversation_ApplicationId)}};return Nt.CustomCommandsConfig=o,Nt}var zt={},jt={},Lt={},pe={};Object.defineProperty(pe,"__esModule",{value:!0});pe.QueryParameterNames=void 0;class j{}pe.QueryParameterNames=j;j.BotId="botid";j.CustomSpeechDeploymentId="cid";j.CustomVoiceDeploymentId="deploymentId";j.EnableAudioLogging="storeAudio";j.EnableLanguageId="lidEnabled";j.EnableWordLevelTimestamps="wordLevelTimestamps";j.EndSilenceTimeoutMs="endSilenceTimeoutMs";j.SegmentationSilenceTimeoutMs="segmentationSilenceTimeoutMs";j.SegmentationMaximumTimeMs="segmentationMaximumTimeMs";j.SegmentationStrategy="segmentationStrategy";j.Format="format";j.InitialSilenceTimeoutMs="initialSilenceTimeoutMs";j.Language="language";j.Profanity="profanity";j.RequestBotStatusMessages="enableBotMessageStatus";j.StableIntermediateThreshold="stableIntermediateThreshold";j.StableTranslation="stableTranslation";j.TestHooks="testhooks";j.Postprocessing="postprocessing";j.CtsMeetingId="meetingId";j.CtsDeviceId="deviceId";j.CtsIsParticipant="isParticipant";j.EnableAvatar="enableTalkingAvatar";var wo;function ue(){if(wo)return Lt;wo=1,Object.defineProperty(Lt,"__esModule",{value:!0}),Lt.ConnectionFactoryBase=void 0;const t=T(),e=A(),r=P(),o=pe;let p=class{static getHostSuffix(n){if(n){if(n.toLowerCase().startsWith("china"))return".azure.cn";if(n.toLowerCase().startsWith("usgov"))return".azure.us"}return".microsoft.com"}setCommonUrlParams(n,i,s){new Map([[r.PropertyId.Speech_SegmentationSilenceTimeoutMs,o.QueryParameterNames.SegmentationSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_EnableAudioLogging,o.QueryParameterNames.EnableAudioLogging],[r.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,o.QueryParameterNames.EndSilenceTimeoutMs],[r.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,o.QueryParameterNames.InitialSilenceTimeoutMs],[r.PropertyId.SpeechServiceResponse_PostProcessingOption,o.QueryParameterNames.Postprocessing],[r.PropertyId.SpeechServiceResponse_ProfanityOption,o.QueryParameterNames.Profanity],[r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,o.QueryParameterNames.EnableWordLevelTimestamps],[r.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,o.QueryParameterNames.StableIntermediateThreshold]]).forEach((d,h)=>{this.setUrlParameter(h,d,n,i,s)});const u=JSON.parse(n.parameters.getProperty(t.ServicePropertiesPropertyName,"{}"));Object.keys(u).forEach(d=>{i[d]=u[d]})}setUrlParameter(n,i,s,c,u){const d=s.parameters.getProperty(n,void 0);d&&(!u||u.search(i)===-1)&&(c[i]=d.toLocaleLowerCase())}static async getRedirectUrlFromEndpoint(n){let i;if(typeof window<"u"&&typeof window.fetch<"u"){const s=new URL(n);s.protocol="https:",s.port="443",s.searchParams.append("GenerateRedirectResponse","true");const u=s.toString();e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",u,void 0,"ConnectionFactoryBase: redirectUrl request"));const d=await fetch(u);if(d.status!==200)return n;i=await d.text()}else i=n;e.Events.instance.onEvent(new e.ConnectionRedirectEvent("",i,n,"ConnectionFactoryBase: redirectUrlString"));try{return new URL(i.trim()).toString()}catch{return n}}};return Lt.ConnectionFactoryBase=p,Lt}var _o;function dv(){if(_o)return jt;_o=1,Object.defineProperty(jt,"__esModule",{value:!0}),jt.DialogConnectionFactory=void 0;const t=x(),e=T(),r=P(),o=ue(),p=T(),a=F,n=pe;class i extends o.ConnectionFactoryBase{create(c,u,d){const h=c.parameters.getProperty(r.PropertyId.Conversation_ApplicationId,""),l=c.parameters.getProperty(r.PropertyId.Conversation_DialogType),f=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),g=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),S=c.parameters.getProperty(r.PropertyId.Conversation_Request_Bot_Status_Messages,"true"),v={};v[a.HeaderNames.ConnectionId]=d,v[n.QueryParameterNames.Format]=c.parameters.getProperty(e.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase(),v[n.QueryParameterNames.Language]=g,v[n.QueryParameterNames.RequestBotStatusMessages]=S,h&&(v[n.QueryParameterNames.BotId]=h,l===r.DialogServiceConfig.DialogTypes.CustomCommands&&(v[a.HeaderNames.CustomCommandsAppId]=h));const m=l===r.DialogServiceConfig.DialogTypes.CustomCommands?"commands/":"",C=l===r.DialogServiceConfig.DialogTypes.CustomCommands?"v1":l===r.DialogServiceConfig.DialogTypes.BotFramework?"v3":"v0",y={};u.token!=null&&u.token!==""&&(y[u.headerName]=u.token);let E=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,"");if(!E){const w=o.ConnectionFactoryBase.getHostSuffix(f),R=c.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,`wss://${f}.${i.BaseUrl}${w}`);E=`${R.endsWith("/")?R:R+"/"}${m}${i.ApiKey}/${C}`}this.setCommonUrlParams(c,v,E);const I=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new t.WebsocketConnection(E,v,y,new p.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(c),I,d))}}return jt.DialogConnectionFactory=i,i.ApiKey="api",i.BaseUrl="convai.speech",jt}var bo;function hv(){if(bo)return zt;bo=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.DialogServiceConnector=void 0;const t=dv(),e=T(),r=ne,o=A(),p=b,a=P(),n=Vi;let i=class extends a.Recognizer{constructor(c,u){const d=c;p.Contracts.throwIfNull(c,"dialogConfig"),super(u,d.properties,new t.DialogConnectionFactory),this.isTurnComplete=!0,this.privIsDisposed=!1,this.privProperties=d.properties.clone();const h=this.buildAgentConfig();this.privReco.agentConfig.set(h)}connect(c,u){(0,o.marshalPromiseToCallbacks)(this.privReco.connect(),c,u)}disconnect(c,u){(0,o.marshalPromiseToCallbacks)(this.privReco.disconnect(),c,u)}get authorizationToken(){return this.properties.getProperty(n.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(c){p.Contracts.throwIfNullOrWhitespace(c,"token"),this.properties.setProperty(n.PropertyId.SpeechServiceAuthorization_Token,c)}get properties(){return this.privProperties}get speechActivityTemplate(){return this.properties.getProperty(n.PropertyId.Conversation_Speech_Activity_Template)}set speechActivityTemplate(c){this.properties.setProperty(n.PropertyId.Conversation_Speech_Activity_Template,c)}listenOnceAsync(c,u){if(this.isTurnComplete){p.Contracts.throwIfDisposed(this.privIsDisposed);const h=(async()=>{await this.privReco.connect(),await this.implRecognizerStop(),this.isTurnComplete=!1;const l=new o.Deferred;await this.privReco.recognize(r.RecognitionMode.Conversation,l.resolve,l.reject);const f=await l.promise;return await this.implRecognizerStop(),f})();h.catch(()=>{this.dispose(!0).catch(()=>{})}),(0,o.marshalPromiseToCallbacks)(h.finally(()=>{this.isTurnComplete=!0}),c,u)}}sendActivityAsync(c,u,d){(0,o.marshalPromiseToCallbacks)(this.privReco.sendMessage(c),u,d)}close(c,u){p.Contracts.throwIfDisposed(this.privIsDisposed),(0,o.marshalPromiseToCallbacks)(this.dispose(!0),c,u)}async dispose(c){this.privIsDisposed||c&&(this.privIsDisposed=!0,await this.implRecognizerStop(),await super.dispose(c))}createRecognizerConfig(c){return new e.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,u,d,h){const l=d;return new e.DialogServiceAdapter(c,u,l,h,this)}buildAgentConfig(){return{botInfo:{commType:this.properties.getProperty("Conversation_Communication_Type","Default"),commandsCulture:void 0,connectionId:this.properties.getProperty(n.PropertyId.Conversation_Agent_Connection_Id),conversationId:this.properties.getProperty(n.PropertyId.Conversation_Conversation_Id,void 0),fromId:this.properties.getProperty(n.PropertyId.Conversation_From_Id,void 0),ttsAudioFormat:this.properties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)},version:.2}}};return zt.DialogServiceConnector=i,zt}var Ki={};Object.defineProperty(Ki,"__esModule",{value:!0});Ki.ActivityReceivedEventArgs=void 0;class lv{constructor(e,r){this.privActivity=e,this.privAudioStream=r}get activity(){return this.privActivity}get audioStream(){return this.privAudioStream}}Ki.ActivityReceivedEventArgs=lv;var Ji={},Gi={};Object.defineProperty(Gi,"__esModule",{value:!0});Gi.TurnStatusResponsePayload=void 0;class hs{constructor(e){this.privMessageStatusResponse=JSON.parse(e)}static fromJSON(e){return new hs(e)}get interactionId(){return this.privMessageStatusResponse.interactionId}get conversationId(){return this.privMessageStatusResponse.conversationId}get statusCode(){switch(this.privMessageStatusResponse.statusCode){case"Success":return 200;case"Failed":return 400;case"TimedOut":return 429;default:return this.privMessageStatusResponse.statusCode}}}Gi.TurnStatusResponsePayload=hs;Object.defineProperty(Ji,"__esModule",{value:!0});Ji.TurnStatusReceivedEventArgs=void 0;const vv=Gi;class fv{constructor(e){this.privTurnStatus=vv.TurnStatusResponsePayload.fromJSON(e)}get interactionId(){return this.privTurnStatus.interactionId}get conversationId(){return this.privTurnStatus.conversationId}get statusCode(){return this.privTurnStatus.statusCode}}Ji.TurnStatusReceivedEventArgs=fv;var np={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ServicePropertyChannel=void 0,function(e){e[e.UriQueryParameter=0]="UriQueryParameter"}(t.ServicePropertyChannel||(t.ServicePropertyChannel={}))})(np);var sp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ProfanityOption=void 0,function(e){e[e.Masked=0]="Masked",e[e.Removed=1]="Removed",e[e.Raw=2]="Raw"}(t.ProfanityOption||(t.ProfanityOption={}))})(sp);var Bt={},Mo;function gv(){if(Mo)return Bt;Mo=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.BaseAudioPlayer=void 0;const t=V,e=P(),r=we;let o=class{constructor(a){this.audioContext=null,this.gainNode=null,this.autoUpdateBufferTimer=0,a===void 0&&(a=e.AudioStreamFormat.getDefaultInputFormat()),this.init(a)}playAudioSample(a,n,i){try{this.ensureInitializedContext();const s=this.formatAudioData(a),c=new Float32Array(this.samples.length+s.length);c.set(this.samples,0),c.set(s,this.samples.length),this.samples=c,n&&n()}catch(s){i&&i(s)}}stopAudio(a,n){this.audioContext!==null&&(this.samples=new Float32Array,clearInterval(this.autoUpdateBufferTimer),this.audioContext.close().then(()=>{a&&a()},i=>{n&&n(i)}),this.audioContext=null)}init(a){this.audioFormat=a,this.samples=new Float32Array}ensureInitializedContext(){if(this.audioContext===null){this.createAudioContext();const a=200;this.autoUpdateBufferTimer=setInterval(()=>{this.updateAudioBuffer()},a)}}createAudioContext(){this.audioContext=r.AudioStreamFormatImpl.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=1,this.gainNode.connect(this.audioContext.destination),this.startTime=this.audioContext.currentTime}formatAudioData(a){switch(this.audioFormat.bitsPerSample){case 8:return this.formatArrayBuffer(new Int8Array(a),128);case 16:return this.formatArrayBuffer(new Int16Array(a),32768);case 32:return this.formatArrayBuffer(new Int32Array(a),2147483648);default:throw new t.InvalidOperationError("Only WAVE_FORMAT_PCM (8/16/32 bps) format supported at this time")}}formatArrayBuffer(a,n){const i=new Float32Array(a.length);for(let s=0;s<a.length;s++)i[s]=a[s]/n;return i}updateAudioBuffer(){if(this.samples.length===0)return;const a=this.audioFormat.channels,n=this.audioContext.createBufferSource(),i=this.samples.length/a,s=this.audioContext.createBuffer(a,i,this.audioFormat.samplesPerSec);for(let c=0;c<a;c++){let u=c;const d=s.getChannelData(c);for(let h=0;h<this.samples.length;h++,u+=a)d[h]=this.samples[u]}this.startTime<this.audioContext.currentTime&&(this.startTime=this.audioContext.currentTime),n.buffer=s,n.connect(this.gainNode),n.start(this.startTime),this.startTime+=s.duration,this.samples=new Float32Array}async playAudio(a){this.audioContext===null&&this.createAudioContext();const n=this.audioContext.createBufferSource(),i=this.audioContext.destination;await this.audioContext.decodeAudioData(a,s=>{n.buffer=s,n.connect(i),n.start(0)})}};return Bt.BaseAudioPlayer=o,Bt}var Qi={};Object.defineProperty(Qi,"__esModule",{value:!0});Qi.ConnectionMessageEventArgs=void 0;class mv{constructor(e){this.privConnectionMessage=e}get message(){return this.privConnectionMessage}toString(){return"Message: "+this.privConnectionMessage.toString()}}Qi.ConnectionMessageEventArgs=mv;var Xi={};Object.defineProperty(Xi,"__esModule",{value:!0});Xi.VoiceProfile=void 0;class Sv{constructor(e,r){this.privId=e,this.privProfileType=r}get profileId(){return this.privId}get profileType(){return this.privProfileType}}Xi.VoiceProfile=Sv;var ke={},Oo;function Cv(){if(Oo)return ke;Oo=1,Object.defineProperty(ke,"__esModule",{value:!0}),ke.VoiceProfileEnrollmentCancellationDetails=ke.VoiceProfileEnrollmentResult=void 0;const t=T(),e=P();let r=class Yn{constructor(a,n,i){this.privReason=a,this.privProperties=new e.PropertyCollection,this.privReason!==e.ResultReason.Canceled?n&&(this.privDetails=JSON.parse(n),this.privDetails.enrollmentStatus.toLowerCase()==="enrolling"&&(this.privReason=e.ResultReason.EnrollingVoiceProfile)):(this.privErrorDetails=i,this.privProperties.setProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[e.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get enrollmentsCount(){return this.privDetails.enrollmentsCount}get enrollmentsLength(){return this.privDetails.enrollmentsLength}get properties(){return this.privProperties}get enrollmentResultDetails(){return this.privDetails}get errorDetails(){return this.privErrorDetails}static FromIdentificationProfileList(a){const n=[];for(const i of a.value){const s=i.enrollmentStatus.toLowerCase()==="enrolling"?e.ResultReason.EnrollingVoiceProfile:i.enrollmentStatus.toLowerCase()==="enrolled"?e.ResultReason.EnrolledVoiceProfile:e.ResultReason.Canceled,c=new Yn(s,null,null);c.privDetails=this.getIdentificationDetails(i),n.push(c)}return n}static FromVerificationProfileList(a){const n=[];for(const i of a.value){const s=i.enrollmentStatus.toLowerCase()==="enrolling"?e.ResultReason.EnrollingVoiceProfile:i.enrollmentStatus.toLowerCase()==="enrolled"?e.ResultReason.EnrolledVoiceProfile:e.ResultReason.Canceled,c=new Yn(s,null,null);c.privDetails=this.getVerificationDetails(i),n.push(c)}return n}static getIdentificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount||0,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.identificationProfileId,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}static getVerificationDetails(a){return{audioLength:a.audioLength?parseFloat(a.audioLength):0,audioSpeechLength:a.audioSpeechLength?parseFloat(a.audioSpeechLength):0,enrollmentStatus:a.enrollmentStatus,enrollmentsCount:a.enrollmentsCount,enrollmentsLength:a.enrollmentsLength?parseFloat(a.enrollmentsLength):0,enrollmentsSpeechLength:a.enrollmentsSpeechLength?parseFloat(a.enrollmentsSpeechLength):0,profileId:a.profileId||a.verificationProfileId,remainingEnrollmentsCount:a.remainingEnrollments||a.remainingEnrollmentsCount,remainingEnrollmentsSpeechLength:a.remainingEnrollmentsSpeechLength?parseFloat(a.remainingEnrollmentsSpeechLength):0}}};ke.VoiceProfileEnrollmentResult=r;class o extends e.CancellationDetailsBase{constructor(a,n,i){super(a,n,i)}static fromResult(a){const n=e.CancellationReason.Error;let i=e.CancellationErrorCode.NoError;return a.properties&&(i=e.CancellationErrorCode[a.properties.getProperty(t.CancellationErrorCodePropertyName,e.CancellationErrorCode[e.CancellationErrorCode.NoError])]),new o(n,a.errorDetails,i)}}return ke.VoiceProfileEnrollmentCancellationDetails=o,ke}var Ne={},Do;function yv(){if(Do)return Ne;Do=1,Object.defineProperty(Ne,"__esModule",{value:!0}),Ne.VoiceProfileCancellationDetails=Ne.VoiceProfileResult=void 0;const t=T(),e=b,r=P();let o=class{constructor(n,i){this.privReason=n,this.privProperties=new r.PropertyCollection,n===r.ResultReason.Canceled&&(e.Contracts.throwIfNullOrUndefined(i,"statusText"),this.privErrorDetails=i,this.privProperties.setProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.ServiceError]))}get reason(){return this.privReason}get properties(){return this.privProperties}get errorDetails(){return this.privErrorDetails}};Ne.VoiceProfileResult=o;class p extends r.CancellationDetailsBase{constructor(n,i,s){super(n,i,s)}static fromResult(n){const i=r.CancellationReason.Error;let s=r.CancellationErrorCode.NoError;return n.properties&&(s=r.CancellationErrorCode[n.properties.getProperty(t.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new p(i,n.errorDetails,s)}}return Ne.VoiceProfileCancellationDetails=p,Ne}var qt={},ko;function Pv(){if(ko)return qt;ko=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.VoiceProfilePhraseResult=void 0;const t=b,e=P();let r=class extends e.VoiceProfileResult{constructor(p,a,n,i){super(p,a),this.privPhrases=[],t.Contracts.throwIfNullOrUndefined(i,"phrase array"),this.privType=n,i&&i[0]&&(this.privPhrases=i)}get phrases(){return this.privPhrases}get type(){return this.privType}};return qt.VoiceProfilePhraseResult=r,qt}var Ft={},No;function Rv(){if(No)return Ft;No=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.VoiceProfileClient=void 0;const t=T(),e=qc(),r=b,o=P();let p=class extends o.Recognizer{constructor(n){r.Contracts.throwIfNullOrUndefined(n,"speechConfig");const i=n;r.Contracts.throwIfNull(i,"speechConfig"),super(e.AudioConfig.fromStreamInput(o.AudioInputStream.createPushStream()),i.properties,new t.VoiceProfileConnectionFactory),this.privProperties=i.properties.clone(),this.privVoiceAdapter=this.privReco,this.privDisposedVoiceAdapter=!1}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(n){r.Contracts.throwIfNullOrWhitespace(n,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,n)}async createProfileAsync(n,i){const s=await this.privVoiceAdapter.createProfile(n,i);return new o.VoiceProfile(s[0],n)}async retrieveEnrollmentResultAsync(n){return this.privVoiceAdapter.retrieveEnrollmentResult(n)}async getAllProfilesAsync(n){return this.privVoiceAdapter.getAllProfiles(n)}async getActivationPhrasesAsync(n,i){return this.privVoiceAdapter.getActivationPhrases(n,i)}async enrollProfileAsync(n,i){const s=i;return r.Contracts.throwIfNullOrUndefined(s,"audioConfig"),this.audioConfig=i,this.privVoiceAdapter.SpeakerAudioSource=s,this.privVoiceAdapter.enrollProfile(n)}async deleteProfileAsync(n){return this.privVoiceAdapter.deleteProfile(n)}async resetProfileAsync(n){return this.privVoiceAdapter.resetProfile(n)}async close(){await this.dispose(!0)}createServiceRecognizer(n,i,s,c){const u=s;return new t.VoiceServiceRecognizer(n,i,u,c,this)}async dispose(n){this.privDisposedVoiceAdapter||(this.privDisposedVoiceAdapter=!0,n&&await super.dispose(n))}createRecognizerConfig(n){return new t.RecognizerConfig(n,this.properties)}getResult(n,i){return new o.VoiceProfileResult(n.ok?i:o.ResultReason.Canceled,n.statusText)}};return Ft.VoiceProfileClient=p,Ft}var xt={},zo;function Ev(){if(zo)return xt;zo=1,Object.defineProperty(xt,"__esModule",{value:!0}),xt.SpeakerRecognizer=void 0;const t=T(),e=b,r=P();let o=class extends r.Recognizer{constructor(a,n){e.Contracts.throwIfNullOrUndefined(a,"speechConfig");const i=a;e.Contracts.throwIfNullOrUndefined(i,"speechConfig"),super(n,i.properties,new t.SpeakerRecognitionConnectionFactory),this.privAudioConfigImpl=n,e.Contracts.throwIfNull(this.privAudioConfigImpl,"audioConfig"),this.privDisposedSpeakerRecognizer=!1,this.privProperties=i.properties}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(a){e.Contracts.throwIfNullOrWhitespace(a,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,a)}get properties(){return this.privProperties}async recognizeOnceAsync(a){return e.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),this.recognizeSpeakerOnceAsyncImpl(a)}async close(){e.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.dispose(!0)}async recognizeSpeakerOnceAsyncImpl(a){e.Contracts.throwIfDisposed(this.privDisposedSpeakerRecognizer),await this.implRecognizerStop();const n=await this.privReco.recognizeSpeaker(a);return await this.implRecognizerStop(),n}async implRecognizerStop(){this.privReco&&await this.privReco.stopRecognizing()}createRecognizerConfig(a){return new t.RecognizerConfig(a,this.privProperties)}createServiceRecognizer(a,n,i,s){const c=i;return new t.SpeakerServiceRecognizer(a,n,c,s,this)}async dispose(a){this.privDisposedSpeakerRecognizer||a&&(this.privDisposedSpeakerRecognizer=!0,await super.dispose(a))}};return xt.SpeakerRecognizer=o,xt}var Ut={},jo;function Iv(){if(jo)return Ut;jo=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.SpeakerIdentificationModel=void 0;const t=b,e=P();let r=class op{constructor(p){if(this.privVoiceProfiles=[],this.privProfileIds=[],t.Contracts.throwIfNullOrUndefined(p,"VoiceProfiles"),p.length===0)throw new Error("Empty Voice Profiles array");for(const a of p){if(a.profileType!==e.VoiceProfileType.TextIndependentIdentification)throw new Error("Identification model can only be created from Identification profile: "+a.profileId);this.privVoiceProfiles.push(a),this.privProfileIds.push(a.profileId)}}static fromProfiles(p){return new op(p)}get voiceProfileIds(){return this.privProfileIds.join(",")}get profileIds(){return this.privProfileIds}get scenario(){return"TextIndependentIdentification"}};return Ut.SpeakerIdentificationModel=r,Ut}var Wt={},Lo;function Tv(){if(Lo)return Wt;Lo=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.SpeakerVerificationModel=void 0;const t=b,e=P();let r=class ap{constructor(p){if(t.Contracts.throwIfNullOrUndefined(p,"VoiceProfile"),p.profileType===e.VoiceProfileType.TextIndependentIdentification)throw new Error("Verification model cannot be created from Identification profile");this.privVoiceProfile=p}static fromProfile(p){return new ap(p)}get voiceProfile(){return this.privVoiceProfile}get profileIds(){return[this.voiceProfile.profileId]}get scenario(){return this.voiceProfile.profileType===e.VoiceProfileType.TextDependentVerification?"TextDependentVerification":"TextIndependentVerification"}};return Wt.SpeakerVerificationModel=r,Wt}var Vt={},ls={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageIdMode=void 0,function(e){e[e.AtStart=0]="AtStart",e[e.Continuous=1]="Continuous"}(t.LanguageIdMode||(t.LanguageIdMode={}))})(ls);var Bo;function Av(){if(Bo)return Vt;Bo=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.AutoDetectSourceLanguageConfig=void 0;const t=T(),e=b,r=P(),o=ls;let p=class pi{constructor(){this.privProperties=new r.PropertyCollection,this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart"),this.privLanguageIdMode=o.LanguageIdMode.AtStart}static fromOpenRange(){const n=new pi;return n.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,t.AutoDetectSourceLanguagesOpenRangeOptionName),n.properties.setProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,"en-US"),n}static fromLanguages(n){e.Contracts.throwIfArrayEmptyOrWhitespace(n,"languages");const i=new pi;return i.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,n.join()),i}static fromSourceLanguageConfigs(n){if(n.length<1)throw new Error("Expected non-empty SourceLanguageConfig array.");const i=new pi,s=[];return n.forEach(c=>{if(s.push(c.language),c.endpointId!==void 0&&c.endpointId!==""){const u=c.language+r.PropertyId.SpeechServiceConnection_EndpointId.toString();i.properties.setProperty(u,c.endpointId)}}),i.properties.setProperty(r.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,s.join()),i}get properties(){return this.privProperties}set mode(n){n===o.LanguageIdMode.Continuous?(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"Continuous")):(this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"1"),this.privProperties.setProperty(r.PropertyId.SpeechServiceConnection_LanguageIdMode,"AtStart")),this.privLanguageIdMode=n}};return Vt.AutoDetectSourceLanguageConfig=p,Vt}var Zi={};Object.defineProperty(Zi,"__esModule",{value:!0});Zi.AutoDetectSourceLanguageResult=void 0;const qo=b;class ui{constructor(e,r){qo.Contracts.throwIfNullOrUndefined(e,"language"),qo.Contracts.throwIfNullOrUndefined(r,"languageDetectionConfidence"),this.privLanguage=e,this.privLanguageDetectionConfidence=r}static fromResult(e){return new ui(e.language,e.languageDetectionConfidence)}static fromConversationTranscriptionResult(e){return new ui(e.language,e.languageDetectionConfidence)}get language(){return this.privLanguage}get languageDetectionConfidence(){return this.privLanguageDetectionConfidence}}Zi.AutoDetectSourceLanguageResult=ui;var Yi={};Object.defineProperty(Yi,"__esModule",{value:!0});Yi.SourceLanguageConfig=void 0;const wv=b;class vs{constructor(e,r){wv.Contracts.throwIfNullOrUndefined(e,"language"),this.privLanguage=e,this.privEndpointId=r}static fromLanguage(e,r){return new vs(e,r)}get language(){return this.privLanguage}get endpointId(){return this.privEndpointId}}Yi.SourceLanguageConfig=vs;var Un={},Fo;function _v(){return Fo||(Fo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpeakerRecognitionCancellationDetails=t.SpeakerRecognitionResult=t.SpeakerRecognitionResultType=void 0;const e=T(),r=P();var o;(function(n){n[n.Verify=0]="Verify",n[n.Identify=1]="Identify"})(o=t.SpeakerRecognitionResultType||(t.SpeakerRecognitionResultType={}));class p{constructor(i,s=r.ResultReason.RecognizedSpeaker,c=r.CancellationErrorCode.NoError,u=""){this.privProperties=new r.PropertyCollection;const d=i.scenario==="TextIndependentIdentification"?o.Identify:o.Verify;this.privReason=s,this.privReason!==r.ResultReason.Canceled?d===o.Identify?(this.privProfileId=i.identificationResult.identifiedProfile.profileId,this.privScore=i.identificationResult.identifiedProfile.score,this.privReason=r.ResultReason.RecognizedSpeakers):(this.privScore=i.verificationResult.score,i.verificationResult.recognitionResult.toLowerCase()!=="accept"&&(this.privReason=r.ResultReason.NoMatch),i.verificationResult.profileId!==void 0&&i.verificationResult.profileId!==""&&(this.privProfileId=i.verificationResult.profileId)):(this.privErrorDetails=u,this.privProperties.setProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[c])),this.privProperties.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,JSON.stringify(i))}get properties(){return this.privProperties}get reason(){return this.privReason}get profileId(){return this.privProfileId}get errorDetails(){return this.privErrorDetails}get score(){return this.privScore}}t.SpeakerRecognitionResult=p;class a extends r.CancellationDetailsBase{constructor(i,s,c){super(i,s,c)}static fromResult(i){const s=r.CancellationReason.Error;let c=r.CancellationErrorCode.NoError;return i.properties&&(c=r.CancellationErrorCode[i.properties.getProperty(e.CancellationErrorCodePropertyName,r.CancellationErrorCode[r.CancellationErrorCode.NoError])]),new a(s,i.errorDetails,c)}}t.SpeakerRecognitionCancellationDetails=a}(Un)),Un}var Wn={},ze={},xo;function cp(){if(xo)return ze;xo=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.ConversationImpl=ze.Conversation=void 0;const t=T(),e=A(),r=b,o=P();let p=class{constructor(){}static createConversationAsync(i,s,c,u){r.Contracts.throwIfNullOrUndefined(i,t.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(i.region,t.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),!i.subscriptionKey&&!i.getProperty(o.PropertyId[o.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(i.subscriptionKey,t.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));let d,h,l;return typeof s=="string"?(d=new a(i,s),(0,e.marshalPromiseToCallbacks)((async()=>{})(),c,u)):(d=new a(i),h=s,l=c,d.createConversationAsync(()=>{h&&h()},f=>{l&&l(f)})),d}};ze.Conversation=p;class a extends p{constructor(i,s){if(super(),this.privErrors=t.ConversationConnectionConfig.restErrors,this.onConnected=d=>{var h;this.privIsConnected=!0;try{(h=this.privConversationTranslator)!=null&&h.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{var h;try{(h=this.privConversationTranslator)!=null&&h.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,h)=>{var l;try{(l=this.privConversationTranslator)!=null&&l.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,h)}catch{}},this.onParticipantUpdateCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.id);if(l!==void 0){switch(h.key){case t.ConversationTranslatorCommandTypes.changeNickname:l.displayName=h.value;break;case t.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=h.value;break;case t.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=h.value;break;case t.ConversationTranslatorCommandTypes.setMute:l.isMuted=h.value;break;case t.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=h.value;break}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,[this.toParticipant(l)],h.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,h)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=l.isHost?!1:h.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,this.toParticipants(!1),h.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,h)=>{try{const l=this.privParticipants.addOrUpdateParticipant(h.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],h.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(h.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],h.sessionId)))}catch{}},this.onTranslationReceived=(d,h)=>{try{switch(h.command){case t.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new o.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case t.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new o.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case t.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new o.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,h)=>{var l;try{if(h.sessionToken!==void 0&&h.sessionToken!==null&&(this.privRoom.token=h.sessionToken),this.privParticipants.participants=[...h.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),h.sessionId)),this.me.isHost){const f=(l=this.privConversationTranslator)==null?void 0:l.properties.getProperty(o.PropertyId.ConversationTranslator_Name);f!==void 0&&f.length>0&&f!==this.me.displayName&&this.changeNicknameAsync(f)}}catch{}},this.onConversationExpiration=(d,h)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,h)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new o.PropertyCollection,this.privManager=new t.ConversationManager,i.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage])||i.setProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage],t.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=i.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage]),s)this.privConversationId=s;else{i.targetLanguages.length===0&&i.addTargetLanguage(this.privLanguage),i.getProperty(o.PropertyId[o.PropertyId.SpeechServiceResponse_ProfanityOption])||i.setProfanity(o.ProfanityOption.Masked);let h=i.getProperty(o.PropertyId[o.PropertyId.ConversationTranslator_Name]);h==null&&(h="Host"),r.Contracts.throwIfNullOrTooLong(h,"nickname",50),r.Contracts.throwIfNullOrTooShort(h,"nickname",2),i.setProperty(o.PropertyId[o.PropertyId.ConversationTranslator_Name],h)}this.privConfig=i;const u=i;r.Contracts.throwIfNull(u,"speechConfig"),this.privProperties=u.properties.clone(),this.privIsConnected=!1,this.privParticipants=new t.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get conversationId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var i,s;return(i=this.privParticipants.me)!=null&&i.isHost?!1:(s=this.privParticipants.me)==null?void 0:s.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get conversationInfo(){const i=this.conversationId,s=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),c={};for(const d of t.ConversationConnectionConfig.transcriptionEventKeys){const h=this.properties.getProperty(d,"");h!==""&&(c[d]=h)}return{id:i,participants:s,conversationProperties:c}}get canSend(){var i;return this.privIsConnected&&!((i=this.privParticipants.me)!=null&&i.isMuted)}get canSendAsHost(){var i;return this.privIsConnected&&((i=this.privParticipants.me)==null?void 0:i.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(i){r.Contracts.throwIfNullOrWhitespace(i,"authorizationToken"),this.privToken=i}set conversationTranslator(i){this.privConversationTranslator=i}onToken(i){this.privConversationTranslator.onToken(i)}createConversationAsync(i,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),this.privManager.createOrJoin(this.privProperties,void 0,c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),s),this.privRoom=c,this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}startConversationAsync(i,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer=t.ConversationRecognizerFactory.fromConfig(this,this.privConfig),this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}addParticipantAsync(i,s,c){r.Contracts.throwIfNullOrUndefined(i,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(i),s,c)}joinConversationAsync(i,s,c,u,d){try{r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,i,h=>{r.Contracts.throwIfNullOrUndefined(h,this.privErrors.permissionDeniedConnect),this.privRoom=h,this.privConfig.authorizationToken=h.cognitiveSpeechAuthToken,u&&u(h.cognitiveSpeechAuthToken)},h=>{this.handleError(h,d)})}catch(h){this.handleError(h,d)}}deleteConversationAsync(i,s){(0,e.marshalPromiseToCallbacks)(this.deleteConversationImplAsync(),i,s)}async deleteConversationImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endConversationAsync(i,s){(0,e.marshalPromiseToCallbacks)(this.endConversationImplAsync(),i,s)}endConversationImplAsync(){return this.close(!0)}lockConversationAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteAllParticipantsAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteParticipantAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==i&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(i)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(i,!0),()=>{this.handleCallback(s,c)},d=>{this.handleError(d,c)})}catch(u){this.handleError(u,c)}}removeParticipantAsync(i,s,c){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&i.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(i),s,c);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let u="";typeof i=="string"?u=i:i.hasOwnProperty("id")?u=i.id:i.hasOwnProperty("userId")&&(u=i.userId),r.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(h=>h.id===u)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(u),()=>{this.handleCallback(s,c)},h=>{this.handleError(h,c)})}}catch(u){this.handleError(u,c)}}unlockConversationAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteAllParticipantsAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteParticipantAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==i&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(i)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(i,!1),()=>{this.handleCallback(s,c)},d=>{this.handleError(d,c)})}catch(u){this.handleError(u,c)}}sendTextMessageAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),i.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(i),()=>{this.handleCallback(s,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}setTranslatedLanguagesAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(i),()=>{this.handleCallback(s,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}changeNicknameAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(i),()=>{this.handleCallback(s,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(i){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await i.enforceAudioGating(),this.privTranscriberRecognizer=i,this.privTranscriberRecognizer.conversation=this}getKeepAlive(){const i=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:i,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(i){if(this.privParticipants.addOrUpdateParticipant(i)!==void 0&&this.privTranscriberRecognizer){const c=this.conversationInfo;return c.participants=[i],this.privTranscriberRecognizer.pushConversationEvent(c,"join")}}removeParticipantImplAsync(i){this.privParticipants.deleteParticipant(i.id);const s=this.conversationInfo;return s.participants=[i],this.privTranscriberRecognizer.pushConversationEvent(s,"leave")}async close(i){var s;try{this.privIsConnected=!1,await((s=this.privConversationRecognizer)==null?void 0:s.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}i&&this.dispose()}handleCallback(i,s){if(i){try{i()}catch(c){s&&s(c)}i=void 0}}handleError(i,s){if(s)if(i instanceof Error){const c=i;s(c.name+": "+c.message)}else s(i)}toParticipants(i){const s=this.privParticipants.participants.map(c=>this.toParticipant(c));return i?s:s.filter(c=>c.isHost===!1)}toParticipant(i){return new o.Participant(i.id,i.avatar,i.displayName,i.isHost,i.isMuted,i.isUsingTts,i.preferredLanguage,i.voice)}getMuteAllCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getMuteCommand(i,s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(i,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setMute,participantId:i,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:s})}getLockCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getEjectCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(i,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.ejectParticipant,participantId:i,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getChangeNicknameCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(i,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.changeNickname,nickname:i,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getMessageCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(i,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:i,type:t.ConversationTranslatorMessageTypes.instantMessage})}}return ze.ConversationImpl=a,ze}var en={};Object.defineProperty(en,"__esModule",{value:!0});en.ConversationCommon=void 0;class bv{constructor(e){this.privAudioConfig=e}handleCallback(e,r){if(e){try{e()}catch(o){r&&r(o)}e=void 0}}handleError(e,r){if(r)if(e instanceof Error){const o=e;r(o.name+": "+o.message)}else r(e)}}en.ConversationCommon=bv;var Ht={},Uo;function Mv(){if(Uo)return Ht;Uo=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.ConversationExpirationEventArgs=void 0;const t=P();let e=class extends t.SessionEventArgs{constructor(o,p){super(p),this.privExpirationTime=o}get expirationTime(){return this.privExpirationTime}};return Ht.ConversationExpirationEventArgs=e,Ht}var $t={},Wo;function Ov(){if(Wo)return $t;Wo=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.ConversationParticipantsChangedEventArgs=void 0;const t=P();let e=class extends t.SessionEventArgs{constructor(o,p,a){super(a),this.privReason=o,this.privParticipant=p}get reason(){return this.privReason}get participants(){return this.privParticipant}};return $t.ConversationParticipantsChangedEventArgs=e,$t}var Kt={},Vo;function Dv(){if(Vo)return Kt;Vo=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.ConversationTranslationCanceledEventArgs=void 0;const t=ei();let e=class extends t.CancellationEventArgsBase{};return Kt.ConversationTranslationCanceledEventArgs=e,Kt}var Jt={},Ho;function kv(){if(Ho)return Jt;Ho=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.ConversationTranslationEventArgs=void 0;const t=P();let e=class extends t.RecognitionEventArgs{constructor(o,p,a){super(p,a),this.privResult=o}get result(){return this.privResult}};return Jt.ConversationTranslationEventArgs=e,Jt}var Gt={},$o;function Nv(){if($o)return Gt;$o=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.ConversationTranslationResult=void 0;const t=Vc();let e=class extends t.TranslationRecognitionResult{constructor(o,p,a,n,i,s,c,u,d,h,l){super(p,n,i,s,c,u,void 0,void 0,d,h,l),this.privId=o,this.privOrigLang=a}get participantId(){return this.privId}get originalLang(){return this.privOrigLang}};return Gt.ConversationTranslationResult=e,Gt}var Vn={},Qt={},ri={};Object.defineProperty(ri,"__esModule",{value:!0});ri.StringUtils=void 0;class zv{static formatString(e,r){if(!e)return"";if(!r)return e;let o="",p="";const a=s=>{o+=s},n=s=>{p+=s};let i=a;for(let s=0;s<e.length;s++){const c=e[s],u=s+1<e.length?e[s+1]:"";switch(c){case"{":u==="{"?(i("{"),s++):i=n;break;case"}":u==="}"?(i("}"),s++):(r.hasOwnProperty(p)&&(o+=r[p]),i=a,p="");break;default:i(c);break}}return o}}ri.StringUtils=zv;var Ko;function jv(){if(Ko)return Qt;Ko=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.ConversationTranslatorConnectionFactory=void 0;const t=x(),e=ri,r=b,o=P(),p=F,a=pe,n=ue(),i=T();let s=class pp extends n.ConnectionFactoryBase{constructor(u){super(),r.Contracts.throwIfNullOrUndefined(u,"convGetter"),this.privConvGetter=u}create(u,d,h){const l=u.parameters.getProperty("ConversationTranslator_MultiChannelAudio","").toUpperCase()==="TRUE",f=this.privConvGetter().room,g=f.cognitiveSpeechRegion||u.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Region,""),S={hostSuffix:n.ConnectionFactoryBase.getHostSuffix(g),path:pp.CTS_VIRT_MIC_PATH,region:encodeURIComponent(g)};S[a.QueryParameterNames.Language]=encodeURIComponent(u.parameters.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage,"")),S[a.QueryParameterNames.CtsMeetingId]=encodeURIComponent(f.roomId),S[a.QueryParameterNames.CtsDeviceId]=encodeURIComponent(f.participantId),S[a.QueryParameterNames.CtsIsParticipant]=f.isHost?"":"&"+a.QueryParameterNames.CtsIsParticipant;let v="";const m={},C={};if(l){v=u.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Endpoint),v||(v="wss://"+u.parameters.getProperty(o.PropertyId.SpeechServiceConnection_Host,"transcribe.{region}.cts.speech{hostSuffix}")+"{path}"),v=e.StringUtils.formatString(v,S);const E=new URL(v);E.searchParams.forEach((w,R)=>{m[R]=w}),new i.TranscriberConnectionFactory().setQueryParams(m,u,v),m[a.QueryParameterNames.CtsMeetingId]=S[a.QueryParameterNames.CtsMeetingId],m[a.QueryParameterNames.CtsDeviceId]=S[a.QueryParameterNames.CtsDeviceId],f.isHost||(m[a.QueryParameterNames.CtsIsParticipant]=""),a.QueryParameterNames.Format in m||(m[a.QueryParameterNames.Format]="simple"),E.searchParams.forEach((w,R)=>{E.searchParams.set(R,m[R]),delete m[R]}),v=E.toString()}else{const E=new i.TranslationConnectionFactory;v=E.getEndpointUrl(u,!0),v=e.StringUtils.formatString(v,S),E.setQueryParams(m,u,v)}C[p.HeaderNames.ConnectionId]=h,C[t.RestConfigBase.configParams.token]=f.token,d.token&&(C[d.headerName]=d.token);const y=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","").toUpperCase()==="TRUE";return Promise.resolve(new t.WebsocketConnection(v,m,C,new i.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(u),y,h))}};return Qt.ConversationTranslatorConnectionFactory=s,s.CTS_VIRT_MIC_PATH="/speech/recognition/dynamicaudio",Qt}var Jo;function Lv(){return Jo||(Jo=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConversationTranslator=t.SpeechState=void 0;const e=T(),r=jv(),o=A(),p=b,a=P(),n=cp(),i=fs();var s;(function(d){d[d.Inactive=0]="Inactive",d[d.Connecting=1]="Connecting",d[d.Connected=2]="Connected"})(s=t.SpeechState||(t.SpeechState={}));class c extends a.TranslationRecognizer{constructor(h,l,f,g){super(h,l,new r.ConversationTranslatorConnectionFactory(g)),this.privSpeechState=s.Inactive,f&&(this.privTranslator=f,this.sessionStarted=()=>{this.privSpeechState=s.Connected},this.sessionStopped=()=>{this.privSpeechState=s.Inactive},this.recognizing=(S,v)=>{this.privTranslator.recognizing&&this.privTranslator.recognizing(this.privTranslator,v)},this.recognized=async(S,v)=>{var m;(m=v.result)!=null&&m.errorDetails?(await this.cancelSpeech(),this.fireCancelEvent(v.result.errorDetails)):this.privTranslator.recognized&&this.privTranslator.recognized(this.privTranslator,v)},this.canceled=async()=>{if(this.privSpeechState!==s.Inactive)try{await this.cancelSpeech()}catch{this.privSpeechState=s.Inactive}})}get state(){return this.privSpeechState}set state(h){this.privSpeechState=h}set authentication(h){this.privReco.authentication=h}onConnection(){this.privSpeechState=s.Connected}async onCancelSpeech(){this.privSpeechState=s.Inactive,await this.cancelSpeech()}fireCancelEvent(h){try{if(this.privTranslator.canceled){const l=new i.ConversationTranslationCanceledEventArgs(a.CancellationReason.Error,h,a.CancellationErrorCode.RuntimeError);this.privTranslator.canceled(this.privTranslator,l)}}catch{}}async cancelSpeech(){var h;try{this.stopContinuousRecognitionAsync(),await((h=this.privReco)==null?void 0:h.disconnect()),this.privSpeechState=s.Inactive}catch{}}}class u extends i.ConversationCommon{constructor(h){super(h),this.privErrors=e.ConversationConnectionConfig.restErrors,this.privIsDisposed=!1,this.privIsSpeaking=!1,this.privPlaceholderKey="abcdefghijklmnopqrstuvwxyz012345",this.privPlaceholderRegion="westus",this.privProperties=new a.PropertyCollection}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get participants(){var h;return(h=this.privConversation)==null?void 0:h.participants}get canSpeak(){return!(!this.privConversation.isConnected||!this.privCTRecognizer||this.privIsSpeaking||this.privCTRecognizer.state===s.Connected||this.privCTRecognizer.state===s.Connecting||this.privConversation.isMutedByHost)}onToken(h){this.privCTRecognizer.authentication=h}setServiceProperty(h,l){const f=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));f[h]=l,this.privProperties.setProperty(e.ServicePropertiesPropertyName,JSON.stringify(f))}joinConversationAsync(h,l,f,g,S){try{if(typeof h=="string"){p.Contracts.throwIfNullOrUndefined(h,this.privErrors.invalidArgs.replace("{arg}","conversation id")),p.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privConversation&&this.handleError(new Error(this.privErrors.permissionDeniedStart),S);let v=f;(v==null||v==="")&&(v=e.ConversationConnectionConfig.defaultLanguageCode),this.privSpeechTranslationConfig=a.SpeechTranslationConfig.fromSubscription(this.privPlaceholderKey,this.privPlaceholderRegion),this.privSpeechTranslationConfig.setProfanity(a.ProfanityOption.Masked),this.privSpeechTranslationConfig.addTargetLanguage(v),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_RecoLanguage],v),this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.ConversationTranslator_Name],l);const m=[a.PropertyId.SpeechServiceConnection_Host,a.PropertyId.ConversationTranslator_Host,a.PropertyId.SpeechServiceConnection_Endpoint,a.PropertyId.SpeechServiceConnection_ProxyHostName,a.PropertyId.SpeechServiceConnection_ProxyPassword,a.PropertyId.SpeechServiceConnection_ProxyPort,a.PropertyId.SpeechServiceConnection_ProxyUserName,"ConversationTranslator_MultiChannelAudio","ConversationTranslator_Region"];for(const y of m){const E=this.privProperties.getProperty(y);if(E){const I=typeof y=="string"?y:a.PropertyId[y];this.privSpeechTranslationConfig.setProperty(I,E)}}const C=JSON.parse(this.privProperties.getProperty(e.ServicePropertiesPropertyName,"{}"));for(const y of Object.keys(C))this.privSpeechTranslationConfig.setServiceProperty(y,C[y],a.ServicePropertyChannel.UriQueryParameter);this.privConversation=new n.ConversationImpl(this.privSpeechTranslationConfig),this.privConversation.conversationTranslator=this,this.privConversation.joinConversationAsync(h,l,v,y=>{y||this.handleError(new Error(this.privErrors.permissionDeniedConnect),S),this.privSpeechTranslationConfig.authorizationToken=y,this.privConversation.room.isHost=!1,this.privConversation.startConversationAsync(()=>{this.handleCallback(g,S)},E=>{this.handleError(E,S)})},y=>{this.handleError(y,S)})}else typeof h=="object"?(p.Contracts.throwIfNullOrUndefined(h,this.privErrors.invalidArgs.replace("{arg}","conversation id")),p.Contracts.throwIfNullOrWhitespace(l,this.privErrors.invalidArgs.replace("{arg}","nickname")),this.privProperties.setProperty(a.PropertyId.ConversationTranslator_Name,l),this.privConversation=h,this.privConversation.conversationTranslator=this,this.privConversation.room.isHost=!0,p.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedConnect),p.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privSpeechTranslationConfig=h.config,this.handleCallback(f,g)):this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","invalid conversation type")),g)}catch(v){this.handleError(v,typeof f=="string"?S:g)}}leaveConversationAsync(h,l){(0,o.marshalPromiseToCallbacks)((async()=>{await this.cancelSpeech(),await this.privConversation.endConversationImplAsync(),await this.privConversation.deleteConversationImplAsync(),this.dispose()})(),h,l)}sendTextMessageAsync(h,l,f){try{p.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),p.Contracts.throwIfNullOrWhitespace(h,this.privErrors.invalidArgs.replace("{arg}",h)),this.privConversation.sendTextMessageAsync(h,l,f)}catch(g){this.handleError(g,f)}}startTranscribingAsync(h,l){(0,o.marshalPromiseToCallbacks)((async()=>{try{p.Contracts.throwIfNullOrUndefined(this.privConversation,this.privErrors.permissionDeniedSend),p.Contracts.throwIfNullOrUndefined(this.privConversation.room.token,this.privErrors.permissionDeniedConnect),this.privCTRecognizer===void 0&&await this.connectTranslatorRecognizer(),p.Contracts.throwIfNullOrUndefined(this.privCTRecognizer,this.privErrors.permissionDeniedSend),this.canSpeak||this.handleError(new Error(this.privErrors.permissionDeniedSend),l),await this.startContinuousRecognition(),this.privIsSpeaking=!0}catch(f){throw this.privIsSpeaking=!1,await this.cancelSpeech(),f}})(),h,l)}stopTranscribingAsync(h,l){(0,o.marshalPromiseToCallbacks)((async()=>{try{if(!this.privIsSpeaking){await this.cancelSpeech();return}this.privIsSpeaking=!1,await new Promise((f,g)=>{this.privCTRecognizer.stopContinuousRecognitionAsync(f,g)})}catch{await this.cancelSpeech()}})(),h,l)}isDisposed(){return this.privIsDisposed}dispose(h,l,f){(0,o.marshalPromiseToCallbacks)((async()=>{this.isDisposed&&!this.privIsSpeaking||(await this.cancelSpeech(),this.privIsDisposed=!0,this.privSpeechTranslationConfig.close(),this.privSpeechRecognitionLanguage=void 0,this.privProperties=void 0,this.privAudioConfig=void 0,this.privSpeechTranslationConfig=void 0,this.privConversation.dispose(),this.privConversation=void 0)})(),l,f)}async cancelSpeech(){var h;try{this.privIsSpeaking=!1,await((h=this.privCTRecognizer)==null?void 0:h.onCancelSpeech()),this.privCTRecognizer=void 0}catch{}}async connectTranslatorRecognizer(){try{this.privAudioConfig===void 0&&(this.privAudioConfig=a.AudioConfig.fromDefaultMicrophoneInput()),this.privSpeechTranslationConfig.getProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key])===this.privPlaceholderKey&&this.privSpeechTranslationConfig.setProperty(a.PropertyId[a.PropertyId.SpeechServiceConnection_Key],"");const h=()=>this.privConversation;this.privCTRecognizer=new c(this.privSpeechTranslationConfig,this.privAudioConfig,this,h)}catch(h){throw await this.cancelSpeech(),h}}startContinuousRecognition(){return new Promise((h,l)=>{this.privCTRecognizer.startContinuousRecognitionAsync(h,l)})}}t.ConversationTranslator=u}(Vn)),Vn}var Xt={},Go;function Bv(){if(Go)return Xt;Go=1,Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.ConversationTranscriber=void 0;const t=T(),e=ne,r=A(),o=b,p=P();let a=class up extends p.Recognizer{constructor(i,s){const c=i;o.Contracts.throwIfNull(c,"speechConfig"),o.Contracts.throwIfNullOrWhitespace(c.properties.getProperty(p.PropertyId.SpeechServiceConnection_RecoLanguage),p.PropertyId[p.PropertyId.SpeechServiceConnection_RecoLanguage]),super(s,c.properties,new t.ConversationTranscriberConnectionFactory,i.tokenCredential),this.privProperties.setProperty(p.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2"),this.privDisposedRecognizer=!1}static FromConfig(i,s,c){const u=i;return s.properties.mergeTo(u.properties),new up(i,c)}get endpointId(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(p.PropertyId.SpeechServiceConnection_EndpointId,"00000000-0000-0000-0000-000000000000")}get authorizationToken(){return this.properties.getProperty(p.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){o.Contracts.throwIfNullOrWhitespace(i,"token"),this.properties.setProperty(p.PropertyId.SpeechServiceAuthorization_Token,i)}get speechRecognitionLanguage(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(p.PropertyId.SpeechServiceConnection_RecoLanguage)}get outputFormat(){return o.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(t.OutputFormatPropertyName,p.OutputFormat[p.OutputFormat.Simple])===p.OutputFormat[p.OutputFormat.Simple]?p.OutputFormat.Simple:p.OutputFormat.Detailed}get properties(){return this.privProperties}startTranscribingAsync(i,s){(0,r.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(e.RecognitionMode.Conversation),i,s)}stopTranscribingAsync(i,s){(0,r.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),i,s)}close(i,s){o.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,r.marshalPromiseToCallbacks)(this.dispose(!0),i,s)}async dispose(i){this.privDisposedRecognizer||(i&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(i))}createRecognizerConfig(i){return new t.RecognizerConfig(i,this.privProperties)}createServiceRecognizer(i,s,c,u){const d=c;return u.isSpeakerDiarizationEnabled=!0,new t.ConversationTranscriptionServiceRecognizer(i,s,d,u,this)}};return Xt.ConversationTranscriber=a,Xt}var je={},Qo;function qv(){if(Qo)return je;Qo=1,Object.defineProperty(je,"__esModule",{value:!0}),je.Participant=je.User=void 0;const t=P();class e{constructor(p){this.privUserId=p}get userId(){return this.privUserId}}je.User=e;class r{constructor(p,a,n,i,s,c,u,d){this.privId=p,this.privAvatar=a,this.privDisplayName=n,this.privIsHost=i,this.privIsMuted=s,this.privIsUsingTts=c,this.privPreferredLanguage=u,this.privVoice=d,this.privProperties=new t.PropertyCollection}get avatar(){return this.privAvatar}get displayName(){return this.privDisplayName}get id(){return this.privId}get preferredLanguage(){return this.privPreferredLanguage}get isHost(){return this.privIsHost}get isMuted(){return this.privIsMuted}get isUsingTts(){return this.privIsUsingTts}get voice(){return this.privVoice}get properties(){return this.privProperties}static From(p,a,n){return new r(p,"",p,!1,!1,!1,a,n)}}return je.Participant=r,je}var dp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ParticipantChangedReason=void 0,function(e){e[e.JoinedConversation=0]="JoinedConversation",e[e.LeftConversation=1]="LeftConversation",e[e.Updated=2]="Updated"}(t.ParticipantChangedReason||(t.ParticipantChangedReason={}))})(dp);var Le={},Xo;function Fv(){if(Xo)return Le;Xo=1,Object.defineProperty(Le,"__esModule",{value:!0}),Le.MeetingImpl=Le.Meeting=void 0;const t=T(),e=A(),r=b,o=P();let p=class{constructor(){}static createMeetingAsync(i,s,c,u){if(r.Contracts.throwIfNullOrUndefined(i,t.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","config")),r.Contracts.throwIfNullOrUndefined(i.region,t.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Region")),r.Contracts.throwIfNull(s,"meetingId"),s.length===0)throw new Error("meetingId cannot be empty");!i.subscriptionKey&&!i.getProperty(o.PropertyId[o.PropertyId.SpeechServiceAuthorization_Token])&&r.Contracts.throwIfNullOrUndefined(i.subscriptionKey,t.ConversationConnectionConfig.restErrors.invalidArgs.replace("{arg}","SpeechServiceConnection_Key"));const d=new a(i,s);return(0,e.marshalPromiseToCallbacks)((async()=>{})(),c,u),d}};Le.Meeting=p;class a extends p{constructor(i,s){super(),this.privErrors=t.ConversationConnectionConfig.restErrors,this.onConnected=d=>{var h;this.privIsConnected=!0;try{(h=this.privConversationTranslator)!=null&&h.sessionStarted&&this.privConversationTranslator.sessionStarted(this.privConversationTranslator,d)}catch{}},this.onDisconnected=d=>{var h;try{(h=this.privConversationTranslator)!=null&&h.sessionStopped&&this.privConversationTranslator.sessionStopped(this.privConversationTranslator,d)}catch{}finally{this.close(!1)}},this.onCanceled=(d,h)=>{var l;try{(l=this.privConversationTranslator)!=null&&l.canceled&&this.privConversationTranslator.canceled(this.privConversationTranslator,h)}catch{}},this.onParticipantUpdateCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.id);if(l!==void 0){switch(h.key){case t.ConversationTranslatorCommandTypes.changeNickname:l.displayName=h.value;break;case t.ConversationTranslatorCommandTypes.setUseTTS:l.isUsingTts=h.value;break;case t.ConversationTranslatorCommandTypes.setProfanityFiltering:l.profanity=h.value;break;case t.ConversationTranslatorCommandTypes.setMute:l.isMuted=h.value;break;case t.ConversationTranslatorCommandTypes.setTranslateToLanguages:l.translateToLanguages=h.value;break}this.privParticipants.addOrUpdateParticipant(l),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,[this.toParticipant(l)],h.sessionId))}}catch{}},this.onLockRoomCommandReceived=()=>{},this.onMuteAllCommandReceived=(d,h)=>{try{this.privParticipants.participants.forEach(l=>l.isMuted=l.isHost?!1:h.isMuted),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.Updated,this.toParticipants(!1),h.sessionId))}catch{}},this.onParticipantJoinCommandReceived=(d,h)=>{try{const l=this.privParticipants.addOrUpdateParticipant(h.participant);l!==void 0&&this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,[this.toParticipant(l)],h.sessionId))}catch{}},this.onParticipantLeaveCommandReceived=(d,h)=>{try{const l=this.privParticipants.getParticipant(h.participant.id);l!==void 0&&(this.privParticipants.deleteParticipant(h.participant.id),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.LeftConversation,[this.toParticipant(l)],h.sessionId)))}catch{}},this.onTranslationReceived=(d,h)=>{try{switch(h.command){case t.ConversationTranslatorMessageTypes.final:this.privConversationTranslator&&this.privConversationTranslator.transcribed(this.privConversationTranslator,new o.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case t.ConversationTranslatorMessageTypes.partial:this.privConversationTranslator&&this.privConversationTranslator.transcribing(this.privConversationTranslator,new o.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break;case t.ConversationTranslatorMessageTypes.instantMessage:this.privConversationTranslator&&this.privConversationTranslator.textMessageReceived(this.privConversationTranslator,new o.ConversationTranslationEventArgs(h.payload,void 0,h.sessionId));break}}catch{}},this.onParticipantsListReceived=(d,h)=>{var l;try{if(h.sessionToken!==void 0&&h.sessionToken!==null&&(this.privRoom.token=h.sessionToken),this.privParticipants.participants=[...h.participants],this.privParticipants.me!==void 0&&(this.privIsReady=!0),this.privConversationTranslator&&this.privConversationTranslator.participantsChanged(this.privConversationTranslator,new o.ConversationParticipantsChangedEventArgs(o.ParticipantChangedReason.JoinedConversation,this.toParticipants(!0),h.sessionId)),this.me.isHost){const f=(l=this.privConversationTranslator)==null?void 0:l.properties.getProperty(o.PropertyId.ConversationTranslator_Name);f!==void 0&&f.length>0&&f!==this.me.displayName&&this.changeNicknameAsync(f)}}catch{}},this.onConversationExpiration=(d,h)=>{try{this.privConversationTranslator&&this.privConversationTranslator.conversationExpiration(this.privConversationTranslator,h)}catch{}},this.privIsConnected=!1,this.privIsDisposed=!1,this.privConversationId="",this.privProperties=new o.PropertyCollection,this.privManager=new t.ConversationManager,i.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage])||i.setProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage],t.ConversationConnectionConfig.defaultLanguageCode),this.privLanguage=i.getProperty(o.PropertyId[o.PropertyId.SpeechServiceConnection_RecoLanguage]),this.privConversationId=s,this.privConfig=i;const u=i;r.Contracts.throwIfNull(u,"speechConfig"),this.privProperties=u.properties.clone(),this.privIsConnected=!1,this.privParticipants=new t.InternalParticipants,this.privIsReady=!1,this.privTextMessageMaxLength=1e3}get room(){return this.privRoom}get connection(){return this.privConversationRecognizer}get config(){return this.privConfig}get meetingId(){return this.privRoom?this.privRoom.roomId:this.privConversationId}get properties(){return this.privProperties}get speechRecognitionLanguage(){return this.privLanguage}get isMutedByHost(){var i,s;return(i=this.privParticipants.me)!=null&&i.isHost?!1:(s=this.privParticipants.me)==null?void 0:s.isMuted}get isConnected(){return this.privIsConnected&&this.privIsReady}get participants(){return this.toParticipants(!0)}get me(){return this.toParticipant(this.privParticipants.me)}get host(){return this.toParticipant(this.privParticipants.host)}get transcriberRecognizer(){return this.privTranscriberRecognizer}get meetingInfo(){const i=this.meetingId,s=this.participants.map(d=>({id:d.id,preferredLanguage:d.preferredLanguage,voice:d.voice})),c={};for(const d of t.ConversationConnectionConfig.transcriptionEventKeys){const h=this.properties.getProperty(d,"");h!==""&&(c[d]=h)}return{id:i,participants:s,meetingProperties:c}}get canSend(){var i;return this.privIsConnected&&!((i=this.privParticipants.me)!=null&&i.isMuted)}get canSendAsHost(){var i;return this.privIsConnected&&((i=this.privParticipants.me)==null?void 0:i.isHost)}get authorizationToken(){return this.privToken}set authorizationToken(i){r.Contracts.throwIfNullOrWhitespace(i,"authorizationToken"),this.privToken=i}createMeetingAsync(i,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),this.privManager.createOrJoin(this.privProperties,void 0,c=>{c||this.handleError(new Error(this.privErrors.permissionDeniedConnect),s),this.privRoom=c,this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}startMeetingAsync(i,s){try{this.privConversationRecognizer&&this.handleError(new Error(this.privErrors.permissionDeniedStart),s),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedConnect),this.privParticipants.meId=this.privRoom.participantId,this.privConversationRecognizer.connected=this.onConnected,this.privConversationRecognizer.disconnected=this.onDisconnected,this.privConversationRecognizer.canceled=this.onCanceled,this.privConversationRecognizer.participantUpdateCommandReceived=this.onParticipantUpdateCommandReceived,this.privConversationRecognizer.lockRoomCommandReceived=this.onLockRoomCommandReceived,this.privConversationRecognizer.muteAllCommandReceived=this.onMuteAllCommandReceived,this.privConversationRecognizer.participantJoinCommandReceived=this.onParticipantJoinCommandReceived,this.privConversationRecognizer.participantLeaveCommandReceived=this.onParticipantLeaveCommandReceived,this.privConversationRecognizer.translationReceived=this.onTranslationReceived,this.privConversationRecognizer.participantsListReceived=this.onParticipantsListReceived,this.privConversationRecognizer.conversationExpiration=this.onConversationExpiration,this.privConversationRecognizer.connect(this.privRoom.token,()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}addParticipantAsync(i,s,c){r.Contracts.throwIfNullOrUndefined(i,"Participant"),(0,e.marshalPromiseToCallbacks)(this.addParticipantImplAsync(i),s,c)}joinMeetingAsync(i,s,c,u,d){try{r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","conversationId")),r.Contracts.throwIfNullOrWhitespace(s,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrWhitespace(c,this.privErrors.invalidArgs.replace("{arg}","language")),this.privManager.createOrJoin(this.privProperties,i,h=>{r.Contracts.throwIfNullOrUndefined(h,this.privErrors.permissionDeniedConnect),this.privRoom=h,this.privConfig.authorizationToken=h.cognitiveSpeechAuthToken,u&&u(h.cognitiveSpeechAuthToken)},h=>{this.handleError(h,d)})}catch(h){this.handleError(h,d)}}deleteMeetingAsync(i,s){(0,e.marshalPromiseToCallbacks)(this.deleteMeetingImplAsync(),i,s)}async deleteMeetingImplAsync(){r.Contracts.throwIfNullOrUndefined(this.privProperties,this.privErrors.permissionDeniedConnect),r.Contracts.throwIfNullOrWhitespace(this.privRoom.token,this.privErrors.permissionDeniedConnect),await this.privManager.leave(this.privProperties,this.privRoom.token),this.dispose()}endMeetingAsync(i,s){(0,e.marshalPromiseToCallbacks)(this.endMeetingImplAsync(),i,s)}endMeetingImplAsync(){return this.close(!0)}lockMeetingAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","lock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!0),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteAllParticipantsAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privConversationRecognizer,this.privErrors.permissionDeniedSend),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","mute")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!0),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}muteParticipantAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==i&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(i)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(i,!0),()=>{this.handleCallback(s,c)},d=>{this.handleError(d,c)})}catch(u){this.handleError(u,c)}}removeParticipantAsync(i,s,c){try{if(r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTranscriberRecognizer&&i.hasOwnProperty("id"))(0,e.marshalPromiseToCallbacks)(this.removeParticipantImplAsync(i),s,c);else{r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","remove")),c);let u="";typeof i=="string"?u=i:i.hasOwnProperty("id")?u=i.id:i.hasOwnProperty("userId")&&(u=i.userId),r.Contracts.throwIfNullOrWhitespace(u,this.privErrors.invalidArgs.replace("{arg}","userId")),this.participants.findIndex(h=>h.id===u)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getEjectCommand(u),()=>{this.handleCallback(s,c)},h=>{this.handleError(h,c)})}}catch(u){this.handleError(u,c)}}unlockMeetingAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unlock")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getLockCommand(!1),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteAllParticipantsAsync(i,s){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSendAsHost||this.handleError(new Error(this.privErrors.permissionDeniedConversation.replace("{command}","unmute all")),s),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteAllCommand(!1),()=>{this.handleCallback(i,s)},c=>{this.handleError(c,s)})}catch(c){this.handleError(c,s)}}unmuteParticipantAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","userId")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),!this.me.isHost&&this.me.id!==i&&this.handleError(new Error(this.privErrors.permissionDeniedParticipant.replace("{command}","mute")),c),this.privParticipants.getParticipantIndex(i)===-1&&this.handleError(new Error(this.privErrors.invalidParticipantRequest),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMuteCommand(i,!1),()=>{this.handleCallback(s,c)},d=>{this.handleError(d,c)})}catch(u){this.handleError(u,c)}}sendTextMessageAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","message")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),i.length>this.privTextMessageMaxLength&&this.handleError(new Error(this.privErrors.invalidArgs.replace("{arg}","message length")),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getMessageCommand(i),()=>{this.handleCallback(s,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}setTranslatedLanguagesAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfArrayEmptyOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","languages")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getSetTranslateToLanguagesCommand(i),()=>{this.handleCallback(s,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}changeNicknameAsync(i,s,c){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfDisposed(this.privConversationRecognizer.isDisposed()),r.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","nickname")),r.Contracts.throwIfNullOrUndefined(this.privRoom,this.privErrors.permissionDeniedSend),this.canSend||this.handleError(new Error(this.privErrors.permissionDeniedSend),c),this.privConversationRecognizer&&this.privConversationRecognizer.sendRequest(this.getChangeNicknameCommand(i),()=>{this.handleCallback(s,c)},u=>{this.handleError(u,c)})}catch(u){this.handleError(u,c)}}isDisposed(){return this.privIsDisposed}dispose(){this.isDisposed||(this.privIsDisposed=!0,this.config&&this.config.close(),this.privConfig=void 0,this.privLanguage=void 0,this.privProperties=void 0,this.privRoom=void 0,this.privToken=void 0,this.privManager=void 0,this.privIsConnected=!1,this.privIsReady=!1,this.privParticipants=void 0)}async connectTranscriberRecognizer(i){this.privTranscriberRecognizer&&await this.privTranscriberRecognizer.close(),await i.enforceAudioGating(),this.privTranscriberRecognizer=i,this.privTranscriberRecognizer.meeting=this}getKeepAlive(){const i=this.me?this.me.displayName:"default_nickname";return JSON.stringify({id:"0",nickname:i,participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.keepAlive})}addParticipantImplAsync(i){if(this.privParticipants.addOrUpdateParticipant(i)!==void 0&&this.privTranscriberRecognizer){const c=this.meetingInfo;return c.participants=[i],this.privTranscriberRecognizer.pushMeetingEvent(c,"join")}}removeParticipantImplAsync(i){this.privParticipants.deleteParticipant(i.id);const s=this.meetingInfo;return s.participants=[i],this.privTranscriberRecognizer.pushMeetingEvent(s,"leave")}async close(i){var s;try{this.privIsConnected=!1,await((s=this.privConversationRecognizer)==null?void 0:s.close()),this.privConversationRecognizer=void 0,this.privConversationTranslator&&this.privConversationTranslator.dispose()}catch(c){throw c}i&&this.dispose()}handleCallback(i,s){if(i){try{i()}catch(c){s&&s(c)}i=void 0}}handleError(i,s){if(s)if(i instanceof Error){const c=i;s(c.name+": "+c.message)}else s(i)}toParticipants(i){const s=this.privParticipants.participants.map(c=>this.toParticipant(c));return i?s:s.filter(c=>c.isHost===!1)}toParticipant(i){return new o.Participant(i.id,i.avatar,i.displayName,i.isHost,i.isMuted,i.isUsingTts,i.preferredLanguage,i.voice)}getMuteAllCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingd"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setMuteAll,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getMuteCommand(i,s){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"conversationId"),r.Contracts.throwIfNullOrWhitespace(i,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setMute,participantId:i,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:s})}getLockCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setLockState,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getEjectCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(i,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.ejectParticipant,participantId:i,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand})}getSetTranslateToLanguagesCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.setTranslateToLanguages,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getChangeNicknameCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(i,"nickname"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),JSON.stringify({command:t.ConversationTranslatorCommandTypes.changeNickname,nickname:i,participantId:this.privRoom.participantId,roomid:this.privRoom.roomId,type:t.ConversationTranslatorMessageTypes.participantCommand,value:i})}getMessageCommand(i){return r.Contracts.throwIfNullOrWhitespace(this.privRoom.roomId,"meetingId"),r.Contracts.throwIfNullOrWhitespace(this.privRoom.participantId,"participantId"),r.Contracts.throwIfNullOrWhitespace(i,"message"),JSON.stringify({participantId:this.privRoom.participantId,roomId:this.privRoom.roomId,text:i,type:t.ConversationTranslatorMessageTypes.instantMessage})}}return Le.MeetingImpl=a,Le}var Zt={},Zo;function xv(){if(Zo)return Zt;Zo=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.MeetingTranscriptionCanceledEventArgs=void 0;const t=ei();class e extends t.CancellationEventArgsBase{}return Zt.MeetingTranscriptionCanceledEventArgs=e,Zt}var Yt={},Yo;function Uv(){if(Yo)return Yt;Yo=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.MeetingTranscriber=void 0;const t=T(),e=A(),r=b,o=P(),p=fs();let a=class{constructor(i){this.privAudioConfig=i,this.privProperties=new o.PropertyCollection,this.privRecognizer=void 0,this.privDisposedRecognizer=!1}get speechRecognitionLanguage(){return r.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(o.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get internalData(){return this.privRecognizer.internalData}get connection(){return o.Connection.fromRecognizer(this.privRecognizer)}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){r.Contracts.throwIfNullOrWhitespace(i,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,i)}joinMeetingAsync(i,s,c){const u=i;r.Contracts.throwIfNullOrUndefined(p.MeetingImpl,"Meeting"),this.privRecognizer=new t.TranscriberRecognizer(i.config,this.privAudioConfig),r.Contracts.throwIfNullOrUndefined(this.privRecognizer,"Recognizer"),this.privRecognizer.connectMeetingCallbacks(this),(0,e.marshalPromiseToCallbacks)(u.connectTranscriberRecognizer(this.privRecognizer),s,c)}startTranscribingAsync(i,s){this.privRecognizer.startContinuousRecognitionAsync(i,s)}stopTranscribingAsync(i,s){this.privRecognizer.stopContinuousRecognitionAsync(i,s)}leaveMeetingAsync(i,s){this.privRecognizer.disconnectCallbacks(),(0,e.marshalPromiseToCallbacks)((async()=>{})(),i,s)}close(i,s){r.Contracts.throwIfDisposed(this.privDisposedRecognizer),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),i,s)}async dispose(i){this.privDisposedRecognizer||(this.privRecognizer&&(await this.privRecognizer.close(),this.privRecognizer=void 0),i&&(this.privDisposedRecognizer=!0))}};return Yt.MeetingTranscriber=a,Yt}var er={},ea;function Wv(){if(ea)return er;ea=1,Object.defineProperty(er,"__esModule",{value:!0}),er.ConversationTranscriptionResult=void 0;const t=P();let e=class extends t.RecognitionResult{constructor(o,p,a,n,i,s,c,u,d,h,l){super(o,p,a,n,i,s,c,d,h,l),this.privSpeakerId=u}get speakerId(){return this.privSpeakerId}};return er.ConversationTranscriptionResult=e,er}var ta;function fs(){return ta||(ta=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConversationTranscriptionResult=t.MeetingTranscriber=t.MeetingTranscriptionCanceledEventArgs=t.MeetingImpl=t.Meeting=t.ParticipantChangedReason=t.User=t.Participant=t.ConversationTranscriber=t.ConversationTranslator=t.ConversationTranslationResult=t.ConversationTranslationEventArgs=t.ConversationTranslationCanceledEventArgs=t.ConversationParticipantsChangedEventArgs=t.ConversationExpirationEventArgs=t.ConversationCommon=t.ConversationImpl=t.Conversation=void 0;var e=cp();Object.defineProperty(t,"Conversation",{enumerable:!0,get:function(){return e.Conversation}}),Object.defineProperty(t,"ConversationImpl",{enumerable:!0,get:function(){return e.ConversationImpl}});var r=en;Object.defineProperty(t,"ConversationCommon",{enumerable:!0,get:function(){return r.ConversationCommon}});var o=Mv();Object.defineProperty(t,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return o.ConversationExpirationEventArgs}});var p=Ov();Object.defineProperty(t,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return p.ConversationParticipantsChangedEventArgs}});var a=Dv();Object.defineProperty(t,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return a.ConversationTranslationCanceledEventArgs}});var n=kv();Object.defineProperty(t,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return n.ConversationTranslationEventArgs}});var i=Nv();Object.defineProperty(t,"ConversationTranslationResult",{enumerable:!0,get:function(){return i.ConversationTranslationResult}});var s=Lv();Object.defineProperty(t,"ConversationTranslator",{enumerable:!0,get:function(){return s.ConversationTranslator}});var c=Bv();Object.defineProperty(t,"ConversationTranscriber",{enumerable:!0,get:function(){return c.ConversationTranscriber}});var u=qv();Object.defineProperty(t,"Participant",{enumerable:!0,get:function(){return u.Participant}}),Object.defineProperty(t,"User",{enumerable:!0,get:function(){return u.User}});var d=dp;Object.defineProperty(t,"ParticipantChangedReason",{enumerable:!0,get:function(){return d.ParticipantChangedReason}});var h=Fv();Object.defineProperty(t,"Meeting",{enumerable:!0,get:function(){return h.Meeting}}),Object.defineProperty(t,"MeetingImpl",{enumerable:!0,get:function(){return h.MeetingImpl}});var l=xv();Object.defineProperty(t,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return l.MeetingTranscriptionCanceledEventArgs}});var f=Uv();Object.defineProperty(t,"MeetingTranscriber",{enumerable:!0,get:function(){return f.MeetingTranscriber}});var g=Wv();Object.defineProperty(t,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return g.ConversationTranscriptionResult}})}(Wn)),Wn}var Be={},ra;function gs(){if(ra)return Be;ra=1,Object.defineProperty(Be,"__esModule",{value:!0}),Be.SynthesisRequest=Be.Synthesizer=void 0;const t=T(),e=A(),r=b,o=P();let p=class hp{constructor(i){const s=i;r.Contracts.throwIfNull(s,"speechConfig"),this.privProperties=s.properties.clone(),this.privDisposed=!1,this.privSynthesizing=!1,this.synthesisRequestQueue=new e.Queue,this.tokenCredential=i.tokenCredential}get authorizationToken(){return this.properties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){r.Contracts.throwIfNullOrWhitespace(i,"token"),this.properties.setProperty(o.PropertyId.SpeechServiceAuthorization_Token,i)}get properties(){return this.privProperties}get autoDetectSourceLanguage(){return this.properties.getProperty(o.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages)===t.AutoDetectSourceLanguagesOpenRangeOptionName}buildSsml(i){const s={"af-ZA":"af-ZA-AdriNeural","am-ET":"am-ET-AmehaNeural","ar-AE":"ar-AE-FatimaNeural","ar-BH":"ar-BH-AliNeural","ar-DZ":"ar-DZ-AminaNeural","ar-EG":"ar-EG-SalmaNeural","ar-IQ":"ar-IQ-BasselNeural","ar-JO":"ar-JO-SanaNeural","ar-KW":"ar-KW-FahedNeural","ar-LY":"ar-LY-ImanNeural","ar-MA":"ar-MA-JamalNeural","ar-QA":"ar-QA-AmalNeural","ar-SA":"ar-SA-HamedNeural","ar-SY":"ar-SY-AmanyNeural","ar-TN":"ar-TN-HediNeural","ar-YE":"ar-YE-MaryamNeural","bg-BG":"bg-BG-BorislavNeural","bn-BD":"bn-BD-NabanitaNeural","bn-IN":"bn-IN-BashkarNeural","ca-ES":"ca-ES-JoanaNeural","cs-CZ":"cs-CZ-AntoninNeural","cy-GB":"cy-GB-AledNeural","da-DK":"da-DK-ChristelNeural","de-AT":"de-AT-IngridNeural","de-CH":"de-CH-JanNeural","de-DE":"de-DE-KatjaNeural","el-GR":"el-GR-AthinaNeural","en-AU":"en-AU-NatashaNeural","en-CA":"en-CA-ClaraNeural","en-GB":"en-GB-LibbyNeural","en-HK":"en-HK-SamNeural","en-IE":"en-IE-ConnorNeural","en-IN":"en-IN-NeerjaNeural","en-KE":"en-KE-AsiliaNeural","en-NG":"en-NG-AbeoNeural","en-NZ":"en-NZ-MitchellNeural","en-PH":"en-PH-JamesNeural","en-SG":"en-SG-LunaNeural","en-TZ":"en-TZ-ElimuNeural","en-US":"en-US-AvaMultilingualNeural","en-ZA":"en-ZA-LeahNeural","es-AR":"es-AR-ElenaNeural","es-BO":"es-BO-MarceloNeural","es-CL":"es-CL-CatalinaNeural","es-CO":"es-CO-GonzaloNeural","es-CR":"es-CR-JuanNeural","es-CU":"es-CU-BelkysNeural","es-DO":"es-DO-EmilioNeural","es-EC":"es-EC-AndreaNeural","es-ES":"es-ES-AlvaroNeural","es-GQ":"es-GQ-JavierNeural","es-GT":"es-GT-AndresNeural","es-HN":"es-HN-CarlosNeural","es-MX":"es-MX-DaliaNeural","es-NI":"es-NI-FedericoNeural","es-PA":"es-PA-MargaritaNeural","es-PE":"es-PE-AlexNeural","es-PR":"es-PR-KarinaNeural","es-PY":"es-PY-MarioNeural","es-SV":"es-SV-LorenaNeural","es-US":"es-US-AlonsoNeural","es-UY":"es-UY-MateoNeural","es-VE":"es-VE-PaolaNeural","et-EE":"et-EE-AnuNeural","fa-IR":"fa-IR-DilaraNeural","fi-FI":"fi-FI-SelmaNeural","fil-PH":"fil-PH-AngeloNeural","fr-BE":"fr-BE-CharlineNeural","fr-CA":"fr-CA-SylvieNeural","fr-CH":"fr-CH-ArianeNeural","fr-FR":"fr-FR-DeniseNeural","ga-IE":"ga-IE-ColmNeural","gl-ES":"gl-ES-RoiNeural","gu-IN":"gu-IN-DhwaniNeural","he-IL":"he-IL-AvriNeural","hi-IN":"hi-IN-MadhurNeural","hr-HR":"hr-HR-GabrijelaNeural","hu-HU":"hu-HU-NoemiNeural","id-ID":"id-ID-ArdiNeural","is-IS":"is-IS-GudrunNeural","it-IT":"it-IT-IsabellaNeural","ja-JP":"ja-JP-NanamiNeural","jv-ID":"jv-ID-DimasNeural","kk-KZ":"kk-KZ-AigulNeural","km-KH":"km-KH-PisethNeural","kn-IN":"kn-IN-GaganNeural","ko-KR":"ko-KR-SunHiNeural","lo-LA":"lo-LA-ChanthavongNeural","lt-LT":"lt-LT-LeonasNeural","lv-LV":"lv-LV-EveritaNeural","mk-MK":"mk-MK-AleksandarNeural","ml-IN":"ml-IN-MidhunNeural","mr-IN":"mr-IN-AarohiNeural","ms-MY":"ms-MY-OsmanNeural","mt-MT":"mt-MT-GraceNeural","my-MM":"my-MM-NilarNeural","nb-NO":"nb-NO-PernilleNeural","nl-BE":"nl-BE-ArnaudNeural","nl-NL":"nl-NL-ColetteNeural","pl-PL":"pl-PL-AgnieszkaNeural","ps-AF":"ps-AF-GulNawazNeural","pt-BR":"pt-BR-FranciscaNeural","pt-PT":"pt-PT-DuarteNeural","ro-RO":"ro-RO-AlinaNeural","ru-RU":"ru-RU-SvetlanaNeural","si-LK":"si-LK-SameeraNeural","sk-SK":"sk-SK-LukasNeural","sl-SI":"sl-SI-PetraNeural","so-SO":"so-SO-MuuseNeural","sr-RS":"sr-RS-NicholasNeural","su-ID":"su-ID-JajangNeural","sv-SE":"sv-SE-SofieNeural","sw-KE":"sw-KE-RafikiNeural","sw-TZ":"sw-TZ-DaudiNeural","ta-IN":"ta-IN-PallaviNeural","ta-LK":"ta-LK-KumarNeural","ta-SG":"ta-SG-AnbuNeural","te-IN":"te-IN-MohanNeural","th-TH":"th-TH-PremwadeeNeural","tr-TR":"tr-TR-AhmetNeural","uk-UA":"uk-UA-OstapNeural","ur-IN":"ur-IN-GulNeural","ur-PK":"ur-PK-AsadNeural","uz-UZ":"uz-UZ-MadinaNeural","vi-VN":"vi-VN-HoaiMyNeural","zh-CN":"zh-CN-XiaoxiaoNeural","zh-HK":"zh-HK-HiuMaanNeural","zh-TW":"zh-TW-HsiaoChenNeural","zu-ZA":"zu-ZA-ThandoNeural"};let c=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthLanguage,"en-US"),u=this.properties.getProperty(o.PropertyId.SpeechServiceConnection_SynthVoice,""),d=hp.XMLEncode(i);return this.autoDetectSourceLanguage?c="en-US":u=u||s[c],u&&(d=`<voice name='${u}'>${d}</voice>`),d=`<speak version='1.0' xmlns='http://www.w3.org/2001/10/synthesis' xmlns:mstts='http://www.w3.org/2001/mstts' xmlns:emo='http://www.w3.org/2009/10/emotionml' xml:lang='${c}'>${d}</speak>`,d}async dispose(i){this.privDisposed||(i&&this.privAdapter&&await this.privAdapter.dispose(),this.privDisposed=!0)}async adapterSpeak(){if(!this.privDisposed&&!this.privSynthesizing){this.privSynthesizing=!0;const i=await this.synthesisRequestQueue.dequeue();return this.privAdapter.Speak(i.text,i.isSSML,i.requestId,i.cb,i.err,i.dataStream)}}createSynthesizerConfig(i){return new t.SynthesizerConfig(i,this.privProperties)}implCommonSynthesizeSetup(){let i=typeof window<"u"?"Browser":"Node",s="unknown",c="unknown";typeof navigator<"u"&&(i=i+"/"+navigator.platform,s=navigator.userAgent,c=navigator.appVersion);const u=this.createSynthesizerConfig(new t.SpeechServiceConfig(new t.Context(new t.OS(i,s,c)))),d=this.privProperties.getProperty(o.PropertyId.SpeechServiceConnection_Key,void 0),h=d&&d!==""?new t.CognitiveSubscriptionKeyAuthentication(d):this.tokenCredential?new t.CognitiveTokenAuthentication(async()=>{try{const l=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(l==null?void 0:l.token)??""}catch(l){throw l}},async()=>{try{const l=await this.tokenCredential.getToken("https://cognitiveservices.azure.com/.default");return(l==null?void 0:l.token)??""}catch(l){throw l}}):new t.CognitiveTokenAuthentication(()=>{const l=this.privProperties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)},()=>{const l=this.privProperties.getProperty(o.PropertyId.SpeechServiceAuthorization_Token,void 0);return Promise.resolve(l)});this.privAdapter=this.createSynthesisAdapter(h,this.privConnectionFactory,u),this.privRestAdapter=this.createRestSynthesisAdapter(h,u)}static XMLEncode(i){return i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}};Be.Synthesizer=p;class a{constructor(i,s,c,u,d,h){this.requestId=i,this.text=s,this.isSSML=c,this.cb=u,this.err=d,this.dataStream=h}}return Be.SynthesisRequest=a,Be}var tr={},ia;function Vv(){if(ia)return tr;ia=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.SpeechSynthesizer=void 0;const t=T(),e=A(),r=Yr,o=_e,p=W,a=b,n=P(),i=gs();let s=class lp extends n.Synthesizer{constructor(u,d){super(u),d!==null&&(d===void 0?this.audioConfig=typeof window>"u"?void 0:n.AudioConfig.fromDefaultSpeakerOutput():this.audioConfig=d),this.privConnectionFactory=new t.SpeechSynthesisConnectionFactory,this.implCommonSynthesizeSetup()}static FromConfig(u,d,h){const l=u;return d.properties.mergeTo(l.properties),new lp(u,h)}speakTextAsync(u,d,h,l){this.speakImpl(u,!1,d,h,l)}speakSsmlAsync(u,d,h,l){this.speakImpl(u,!0,d,h,l)}async getVoicesAsync(u=""){return this.getVoices(u)}close(u,d){a.Contracts.throwIfDisposed(this.privDisposed),(0,e.marshalPromiseToCallbacks)(this.dispose(!0),u,d)}get internalData(){return this.privAdapter}createSynthesisAdapter(u,d,h){return new t.SpeechSynthesisAdapter(u,d,h,this,this.audioConfig)}createRestSynthesisAdapter(u,d){return new t.SynthesisRestAdapter(d,u)}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=o.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(n.SpeechSynthesisOutputFormat[this.properties.getProperty(n.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0)])}speakImpl(u,d,h,l,f){try{a.Contracts.throwIfDisposed(this.privDisposed);const g=(0,e.createNoDashGuid)();let S;f instanceof n.PushAudioOutputStreamCallback?S=new p.PushAudioOutputStreamImpl(f):f instanceof n.PullAudioOutputStream?S=f:f!==void 0?S=new r.AudioFileWriter(f):S=void 0,this.synthesisRequestQueue.enqueue(new i.SynthesisRequest(g,u,d,v=>{if(this.privSynthesizing=!1,h)try{h(v)}catch(m){l&&l(m)}h=void 0,this.adapterSpeak().catch(()=>{})},v=>{l&&l(v)},S)),this.adapterSpeak().catch(()=>{})}catch(g){if(l)if(g instanceof Error){const S=g;l(S.name+": "+S.message)}else l(g);this.dispose(!0).catch(()=>{})}}async getVoices(u){const d=(0,e.createNoDashGuid)(),h=await this.privRestAdapter.getVoicesList(d);if(h.ok&&Array.isArray(h.json)){let l=h.json;return u&&u.length>0&&(l=l.filter(f=>!!f.Locale&&f.Locale.toLowerCase()===u.toLowerCase())),new n.SynthesisVoicesResult(d,l,void 0)}else return new n.SynthesisVoicesResult(d,void 0,`Error: ${h.status}: ${h.statusText}`)}};return tr.SpeechSynthesizer=s,tr}var tn={};Object.defineProperty(tn,"__esModule",{value:!0});tn.SynthesisResult=void 0;class Hv{constructor(e,r,o,p){this.privResultId=e,this.privReason=r,this.privErrorDetails=o,this.privProperties=p}get resultId(){return this.privResultId}get reason(){return this.privReason}get errorDetails(){return this.privErrorDetails}get properties(){return this.privProperties}}tn.SynthesisResult=Hv;var rr={},na;function $v(){if(na)return rr;na=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.SpeechSynthesisResult=void 0;const t=P();let e=class extends t.SynthesisResult{constructor(o,p,a,n,i,s){super(o,p,n,i),this.privAudioData=a,this.privAudioDuration=s}get audioData(){return this.privAudioData}get audioDuration(){return this.privAudioDuration}};return rr.SpeechSynthesisResult=e,rr}var rn={};Object.defineProperty(rn,"__esModule",{value:!0});rn.SpeechSynthesisEventArgs=void 0;class Kv{constructor(e){this.privResult=e}get result(){return this.privResult}}rn.SpeechSynthesisEventArgs=Kv;var nn={};Object.defineProperty(nn,"__esModule",{value:!0});nn.SpeechSynthesisWordBoundaryEventArgs=void 0;class Jv{constructor(e,r,o,p,a,n){this.privAudioOffset=e,this.privDuration=r,this.privText=o,this.privWordLength=p,this.privTextOffset=a,this.privBoundaryType=n}get audioOffset(){return this.privAudioOffset}get duration(){return this.privDuration}get text(){return this.privText}get wordLength(){return this.privWordLength}get textOffset(){return this.privTextOffset}get boundaryType(){return this.privBoundaryType}}nn.SpeechSynthesisWordBoundaryEventArgs=Jv;var sn={};Object.defineProperty(sn,"__esModule",{value:!0});sn.SpeechSynthesisBookmarkEventArgs=void 0;class Gv{constructor(e,r){this.privAudioOffset=e,this.privText=r}get audioOffset(){return this.privAudioOffset}get text(){return this.privText}}sn.SpeechSynthesisBookmarkEventArgs=Gv;var on={};Object.defineProperty(on,"__esModule",{value:!0});on.SpeechSynthesisVisemeEventArgs=void 0;class Qv{constructor(e,r,o){this.privAudioOffset=e,this.privVisemeId=r,this.privAnimation=o}get audioOffset(){return this.privAudioOffset}get visemeId(){return this.privVisemeId}get animation(){return this.privAnimation}}on.SpeechSynthesisVisemeEventArgs=Qv;var vp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SpeechSynthesisBoundaryType=void 0,function(e){e.Word="WordBoundary",e.Punctuation="PunctuationBoundary",e.Sentence="SentenceBoundary"}(t.SpeechSynthesisBoundaryType||(t.SpeechSynthesisBoundaryType={}))})(vp);var ir={},sa;function Xv(){if(sa)return ir;sa=1,Object.defineProperty(ir,"__esModule",{value:!0}),ir.SynthesisVoicesResult=void 0;const t=P();let e=class extends t.SynthesisResult{constructor(o,p,a){if(Array.isArray(p)){super(o,t.ResultReason.VoicesListRetrieved,void 0,new t.PropertyCollection),this.privVoices=[];for(const n of p)this.privVoices.push(new t.VoiceInfo(n))}else super(o,t.ResultReason.Canceled,a||"Error information unavailable",new t.PropertyCollection)}get voices(){return this.privVoices}};return ir.SynthesisVoicesResult=e,ir}var fp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceInfo=t.SynthesisVoiceType=t.SynthesisVoiceGender=void 0;var e;(function(n){n[n.Unknown=0]="Unknown",n[n.Female=1]="Female",n[n.Male=2]="Male",n[n.Neutral=3]="Neutral"})(e=t.SynthesisVoiceGender||(t.SynthesisVoiceGender={}));var r;(function(n){n[n.Unknown=0]="Unknown",n[n.OnlineNeural=1]="OnlineNeural",n[n.OnlineStandard=2]="OnlineStandard",n[n.OfflineNeural=3]="OfflineNeural",n[n.OfflineStandard=4]="OfflineStandard",n[n.OnlineNeuralHD=5]="OnlineNeuralHD"})(r=t.SynthesisVoiceType||(t.SynthesisVoiceType={}));const o={[e[e.Neutral]]:e.Neutral,[e[e.Male]]:e.Male,[e[e.Female]]:e.Female},p={Neural:r.OnlineNeural,NeuralHD:r.OnlineNeuralHD};class a{constructor(i){if(this.privStyleList=[],i){if(this.privName=i.Name,this.privLocale=i.Locale,this.privShortName=i.ShortName,this.privLocaleName=i.LocaleName,this.privDisplayName=i.DisplayName,this.privLocalName=i.LocalName,this.privVoiceType=p[i.VoiceType]||r.Unknown,this.privGender=o[i.Gender]||e.Unknown,i.StyleList&&Array.isArray(i.StyleList))for(const s of i.StyleList)this.privStyleList.push(s);this.privSampleRateHertz=i.SampleRateHertz,this.privStatus=i.Status,i.ExtendedPropertyMap&&(this.privExtendedPropertyMap=i.ExtendedPropertyMap),this.privWordsPerMinute=i.WordsPerMinute,Array.isArray(i.SecondaryLocaleList)&&(this.privSecondaryLocaleList=[...i.SecondaryLocaleList]),Array.isArray(i.RolePlayList)&&(this.privRolePlayList=[...i.RolePlayList]),i.VoiceTag&&(this.privVoiceTag=i.VoiceTag)}}get name(){return this.privName}get locale(){return this.privLocale}get shortName(){return this.privShortName}get displayName(){return this.privDisplayName}get localName(){return this.privLocalName}get localeName(){return this.privLocaleName}get gender(){return this.privGender}get voiceType(){return this.privVoiceType}get styleList(){return this.privStyleList}get sampleRateHertz(){return this.privSampleRateHertz}get status(){return this.privStatus}get extendedPropertyMap(){return this.privExtendedPropertyMap}get wordsPerMinute(){return this.privWordsPerMinute}get secondaryLocaleList(){return this.privSecondaryLocaleList}get rolePlayList(){return this.privRolePlayList}get voiceTag(){return this.privVoiceTag}}t.VoiceInfo=a})(fp);var an={};Object.defineProperty(an,"__esModule",{value:!0});an.SpeakerAudioDestination=void 0;const qe=A(),Zv=W,re=we,Yv=60*30,oa={[re.AudioFormatTag.PCM]:"audio/wav",[re.AudioFormatTag.MuLaw]:"audio/x-wav",[re.AudioFormatTag.MP3]:"audio/mpeg",[re.AudioFormatTag.OGG_OPUS]:"audio/ogg",[re.AudioFormatTag.WEBM_OPUS]:"audio/webm; codecs=opus",[re.AudioFormatTag.ALaw]:"audio/x-wav",[re.AudioFormatTag.FLAC]:"audio/flac",[re.AudioFormatTag.AMR_WB]:"audio/amr-wb",[re.AudioFormatTag.G722]:"audio/G722"};class ef{constructor(e){this.privPlaybackStarted=!1,this.privAppendingToBuffer=!1,this.privMediaSourceOpened=!1,this.privBytesReceived=0,this.privId=e||(0,qe.createNoDashGuid)(),this.privIsPaused=!1,this.privIsClosed=!1}id(){return this.privId}write(e,r,o){this.privAudioBuffer!==void 0?(this.privAudioBuffer.push(e),this.updateSourceBuffer().then(()=>{r&&r()},p=>{o&&o(p)})):this.privAudioOutputStream!==void 0&&(this.privAudioOutputStream.write(e),this.privBytesReceived+=e.byteLength)}close(e,r){if(this.privIsClosed=!0,this.privSourceBuffer!==void 0)this.handleSourceBufferUpdateEnd().then(()=>{e&&e()},o=>{r&&r(o)});else if(this.privAudioOutputStream!==void 0&&typeof window<"u")if((this.privFormat.formatTag===re.AudioFormatTag.PCM||this.privFormat.formatTag===re.AudioFormatTag.MuLaw||this.privFormat.formatTag===re.AudioFormatTag.ALaw)&&this.privFormat.hasHeader===!1)console.warn("Play back is not supported for raw PCM, mulaw or alaw format without header."),this.onAudioEnd&&this.onAudioEnd(this);else{let o=new ArrayBuffer(this.privBytesReceived);this.privAudioOutputStream.read(o).then(()=>{o=this.privFormat.addHeader(o);const p=new Blob([o],{type:oa[this.privFormat.formatTag]});this.privAudio.src=window.URL.createObjectURL(p),this.notifyPlayback().then(()=>{e&&e()},a=>{r&&r(a)})},p=>{r&&r(p)})}else this.onAudioEnd&&this.onAudioEnd(this)}set format(e){if(typeof AudioContext<"u"||typeof window<"u"&&typeof window.webkitAudioContext<"u"){this.privFormat=e;const r=oa[this.privFormat.formatTag];r===void 0?console.warn(`Unknown mimeType for format ${re.AudioFormatTag[this.privFormat.formatTag]}; playback is not supported.`):typeof MediaSource<"u"&&MediaSource.isTypeSupported(r)?(this.privAudio=new Audio,this.privAudioBuffer=[],this.privMediaSource=new MediaSource,this.privAudio.src=URL.createObjectURL(this.privMediaSource),this.privAudio.load(),this.privMediaSource.onsourceopen=()=>{this.privMediaSourceOpened=!0,this.privMediaSource.duration=Yv,this.privSourceBuffer=this.privMediaSource.addSourceBuffer(r),this.privSourceBuffer.onupdate=()=>{this.updateSourceBuffer().catch(o=>{qe.Events.instance.onEvent(new qe.BackgroundEvent(o))})},this.privSourceBuffer.onupdateend=()=>{this.handleSourceBufferUpdateEnd().catch(o=>{qe.Events.instance.onEvent(new qe.BackgroundEvent(o))})},this.privSourceBuffer.onupdatestart=()=>{this.privAppendingToBuffer=!1}},this.updateSourceBuffer().catch(o=>{qe.Events.instance.onEvent(new qe.BackgroundEvent(o))})):(console.warn(`Format ${re.AudioFormatTag[this.privFormat.formatTag]} could not be played by MSE, streaming playback is not enabled.`),this.privAudioOutputStream=new Zv.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privFormat,this.privAudio=new Audio)}}get volume(){var e;return((e=this.privAudio)==null?void 0:e.volume)??-1}set volume(e){this.privAudio&&(this.privAudio.volume=e)}mute(){this.privAudio&&(this.privAudio.muted=!0)}unmute(){this.privAudio&&(this.privAudio.muted=!1)}get isClosed(){return this.privIsClosed}get currentTime(){return this.privAudio!==void 0?this.privAudio.currentTime:-1}pause(){!this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.pause(),this.privIsPaused=!0)}resume(e,r){this.privIsPaused&&this.privAudio!==void 0&&(this.privAudio.play().then(()=>{e&&e()},o=>{r&&r(o)}),this.privIsPaused=!1)}get internalAudio(){return this.privAudio}async updateSourceBuffer(){if(this.privAudioBuffer!==void 0&&this.privAudioBuffer.length>0&&this.sourceBufferAvailable()){this.privAppendingToBuffer=!0;const e=this.privAudioBuffer.shift();try{this.privSourceBuffer.appendBuffer(e)}catch{this.privAudioBuffer.unshift(e),console.log("buffer filled, pausing addition of binaries until space is made");return}await this.notifyPlayback()}else this.canEndStream()&&await this.handleSourceBufferUpdateEnd()}async handleSourceBufferUpdateEnd(){this.canEndStream()&&this.sourceBufferAvailable()&&(this.privMediaSource.endOfStream(),await this.notifyPlayback())}async notifyPlayback(){!this.privPlaybackStarted&&this.privAudio!==void 0&&(this.privPlaybackStarted=!0,this.onAudioStart&&this.onAudioStart(this),this.privAudio.onended=()=>{this.onAudioEnd&&this.onAudioEnd(this)},this.privIsPaused||await this.privAudio.play())}canEndStream(){return this.isClosed&&this.privSourceBuffer!==void 0&&this.privAudioBuffer.length===0&&this.privMediaSourceOpened&&!this.privAppendingToBuffer&&this.privMediaSource.readyState==="open"}sourceBufferAvailable(){return this.privSourceBuffer!==void 0&&!this.privSourceBuffer.updating}}an.SpeakerAudioDestination=ef;var nr={},aa;function tf(){if(aa)return nr;aa=1,Object.defineProperty(nr,"__esModule",{value:!0}),nr.ConversationTranscriptionCanceledEventArgs=void 0;const t=ei();let e=class extends t.CancellationEventArgsBase{};return nr.ConversationTranscriptionCanceledEventArgs=e,nr}var sr={},ca;function rf(){if(ca)return sr;ca=1,Object.defineProperty(sr,"__esModule",{value:!0}),sr.MeetingTranscriptionCanceledEventArgs=void 0;const t=ei();let e=class extends t.CancellationEventArgsBase{};return sr.MeetingTranscriptionCanceledEventArgs=e,sr}var gp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PronunciationAssessmentGradingSystem=void 0,function(e){e[e.FivePoint=1]="FivePoint",e[e.HundredMark=2]="HundredMark"}(t.PronunciationAssessmentGradingSystem||(t.PronunciationAssessmentGradingSystem={}))})(gp);var mp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PronunciationAssessmentGranularity=void 0,function(e){e[e.Phoneme=1]="Phoneme",e[e.Word=2]="Word",e[e.FullText=3]="FullText"}(t.PronunciationAssessmentGranularity||(t.PronunciationAssessmentGranularity={}))})(mp);var or={},pa;function nf(){if(pa)return or;pa=1,Object.defineProperty(or,"__esModule",{value:!0}),or.PronunciationAssessmentConfig=void 0;const t=b,e=P();let r=class Sp{constructor(p,a=e.PronunciationAssessmentGradingSystem.FivePoint,n=e.PronunciationAssessmentGranularity.Phoneme,i=!1){t.Contracts.throwIfNullOrUndefined(p,"referenceText"),this.privProperties=new e.PropertyCollection,this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,p),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_GradingSystem,e.PronunciationAssessmentGradingSystem[a]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Granularity,e.PronunciationAssessmentGranularity[n]),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,String(i))}static fromJSON(p){t.Contracts.throwIfNullOrUndefined(p,"json");const a=new Sp("");return a.privProperties=new e.PropertyCollection,a.properties.setProperty(e.PropertyId.PronunciationAssessment_Json,p),a}toJSON(){return this.updateJson(),this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Params)}applyTo(p){this.updateJson();const a=p.internalData;a.expectContentAssessmentResponse=!!this.privContentAssessmentTopic,a.speechContext.setPronunciationAssessmentParams(this.properties.getProperty(e.PropertyId.PronunciationAssessment_Params),this.privContentAssessmentTopic,a.isSpeakerDiarizationEnabled)}get referenceText(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText)}set referenceText(p){t.Contracts.throwIfNullOrWhitespace(p,"referenceText"),this.properties.setProperty(e.PropertyId.PronunciationAssessment_ReferenceText,p)}set phonemeAlphabet(p){t.Contracts.throwIfNullOrWhitespace(p,"phonemeAlphabet"),this.privPhonemeAlphabet=p}set enableMiscue(p){const a=p?"true":"false";this.properties.setProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,a)}get enableMiscue(){return this.properties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue,"false").toLowerCase()==="true"}set nbestPhonemeCount(p){this.privNBestPhonemeCount=p}set enableProsodyAssessment(p){this.privEnableProsodyAssessment=p}enableContentAssessmentWithTopic(p){this.privContentAssessmentTopic=p}get properties(){return this.privProperties}updateJson(){const p=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Json,"{}"),a=JSON.parse(p),n=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_ReferenceText);n&&(a.referenceText=n);const i=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_GradingSystem);i&&(a.gradingSystem=i);const s=this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_Granularity);s&&(a.granularity=s),this.privPhonemeAlphabet&&(a.phonemeAlphabet=this.privPhonemeAlphabet),this.privNBestPhonemeCount&&(a.nbestPhonemeCount=this.privNBestPhonemeCount),a.enableProsodyAssessment=this.privEnableProsodyAssessment,a.dimension="Comprehensive",this.privProperties.getProperty(e.PropertyId.PronunciationAssessment_EnableMiscue)&&(a.enableMiscue=this.enableMiscue),this.privProperties.setProperty(e.PropertyId.PronunciationAssessment_Params,JSON.stringify(a))}};return or.PronunciationAssessmentConfig=r,or}var Fe={},ua;function sf(){if(ua)return Fe;ua=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.PronunciationAssessmentResult=Fe.ContentAssessmentResult=void 0;const t=b,e=P();class r{constructor(a){this.privPronJson=a}get grammarScore(){return this.privPronJson.ContentAssessment.GrammarScore}get vocabularyScore(){return this.privPronJson.ContentAssessment.VocabularyScore}get topicScore(){return this.privPronJson.ContentAssessment.TopicScore}}Fe.ContentAssessmentResult=r;let o=class Cp{constructor(a){const n=JSON.parse(a);t.Contracts.throwIfNullOrUndefined(n.NBest[0],"NBest"),this.privPronJson=n.NBest[0]}static fromResult(a){t.Contracts.throwIfNullOrUndefined(a,"result");const n=a.properties.getProperty(e.PropertyId.SpeechServiceResponse_JsonResult);return t.Contracts.throwIfNullOrUndefined(n,"json"),new Cp(n)}get detailResult(){return this.privPronJson}get accuracyScore(){var a;return(a=this.detailResult.PronunciationAssessment)==null?void 0:a.AccuracyScore}get pronunciationScore(){var a;return(a=this.detailResult.PronunciationAssessment)==null?void 0:a.PronScore}get completenessScore(){var a;return(a=this.detailResult.PronunciationAssessment)==null?void 0:a.CompletenessScore}get fluencyScore(){var a;return(a=this.detailResult.PronunciationAssessment)==null?void 0:a.FluencyScore}get prosodyScore(){var a;return(a=this.detailResult.PronunciationAssessment)==null?void 0:a.ProsodyScore}get contentAssessmentResult(){if(this.detailResult.ContentAssessment!==void 0)return new r(this.detailResult)}};return Fe.PronunciationAssessmentResult=o,Fe}var ar={},da;function of(){if(da)return ar;da=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.AvatarConfig=void 0;const t=b,e=P();let r=class{constructor(p,a,n){this.privCustomized=!1,this.privUseBuiltInVoice=!1,t.Contracts.throwIfNullOrWhitespace(p,"character"),this.character=p,this.style=a,n===void 0&&(n=new e.AvatarVideoFormat),this.videoFormat=n}get customized(){return this.privCustomized}set customized(p){this.privCustomized=p}get useBuiltInVoice(){return this.privUseBuiltInVoice}set useBuiltInVoice(p){this.privUseBuiltInVoice=p}get backgroundColor(){return this.privBackgroundColor}set backgroundColor(p){this.privBackgroundColor=p}get backgroundImage(){return this.privBackgroundImage}set backgroundImage(p){this.privBackgroundImage=p}get remoteIceServers(){return this.privRemoteIceServers}set remoteIceServers(p){this.privRemoteIceServers=p}};return ar.AvatarConfig=r,ar}var yp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.AvatarEventArgs=t.AvatarEventTypes=void 0,function(r){r.SwitchedToSpeaking="SwitchedToSpeaking",r.SwitchedToIdle="SwitchedToIdle",r.SessionClosed="SessionClosed"}(t.AvatarEventTypes||(t.AvatarEventTypes={}));class e{constructor(o,p){this.privOffset=o,this.privDescription=p}get type(){return this.privType}get offset(){return this.privOffset}get description(){return this.privDescription}}t.AvatarEventArgs=e})(yp);var cr={},pr={},ha;function Pp(){if(ha)return pr;ha=1,Object.defineProperty(pr,"__esModule",{value:!0}),pr.SpeechSynthesisConnectionFactory=void 0;const t=x(),e=P(),r=ue(),o=T(),p=F,a=pe;let n=class{constructor(){this.synthesisUri="/tts/cognitiveservices/websocket/v1"}async create(s,c,u){let d=s.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const h=s.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),l=r.ConnectionFactoryBase.getHostSuffix(h),f=s.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),g=f===void 0?"tts":"voice",S=s.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+h+"."+g+".speech"+l),v={},m={};if(c.token!==void 0&&c.token!==""&&(m[c.headerName]=c.token),m[p.HeaderNames.ConnectionId]=u,f!==void 0&&f!==""&&(!d||d.search(a.QueryParameterNames.CustomVoiceDeploymentId)===-1)&&(v[a.QueryParameterNames.CustomVoiceDeploymentId]=f),s.avatarEnabled&&(!d||d.search(a.QueryParameterNames.EnableAvatar)===-1)&&(v[a.QueryParameterNames.EnableAvatar]="true"),d){const y=new URL(d),E=y.pathname;(E===""||E==="/")&&(y.pathname=this.synthesisUri,d=await r.ConnectionFactoryBase.getRedirectUrlFromEndpoint(y.toString()))}d||(d=S+this.synthesisUri),s.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,d);const C=s.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new t.WebsocketConnection(d,v,m,new o.WebsocketMessageFormatter,t.ProxyInfo.fromParameters(s.parameters),C,u)}};return pr.SpeechSynthesisConnectionFactory=n,pr}var la;function af(){if(la)return cr;la=1,Object.defineProperty(cr,"__esModule",{value:!0}),cr.AvatarSynthesizer=void 0;const t=Pp(),e=T(),r=A(),o=_e,p=P(),a=b,n=gs();let i=class extends p.Synthesizer{constructor(c,u){super(c),a.Contracts.throwIfNullOrUndefined(u,"avatarConfig"),this.privConnectionFactory=new t.SpeechSynthesisConnectionFactory,this.privAvatarConfig=u,this.implCommonSynthesizeSetup()}implCommonSynthesizeSetup(){super.implCommonSynthesizeSetup(),this.privAdapter.audioOutputFormat=o.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormat(p.SpeechSynthesisOutputFormat.Riff24Khz16BitMonoPcm)}async startAvatarAsync(c){a.Contracts.throwIfNullOrUndefined(c,"peerConnection"),this.privIceServers=c.getConfiguration().iceServers,a.Contracts.throwIfNullOrUndefined(this.privIceServers,"Ice servers must be set.");const u=new r.Deferred;c.onicegatheringstatechange=()=>{r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering state: "+c.iceGatheringState,r.EventType.Debug)),c.iceGatheringState==="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering complete.",r.EventType.Info)),u.resolve())},c.onicecandidate=g=>{g.candidate?r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: "+g.candidate.candidate,r.EventType.Debug)):(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice candidate: complete",r.EventType.Debug)),u.resolve())},setTimeout(()=>{c.iceGatheringState!=="complete"&&(r.Events.instance.onEvent(new r.PlatformEvent("peer connection: ice gathering timeout.",r.EventType.Warning)),u.resolve())},2e3);const d=await c.createOffer();await c.setLocalDescription(d),await u.promise,r.Events.instance.onEvent(new r.PlatformEvent("peer connection: got local SDP.",r.EventType.Info)),this.privProperties.setProperty(p.PropertyId.TalkingAvatarService_WebRTC_SDP,JSON.stringify(c.localDescription));const h=await this.speak("",!1);if(h.reason!==p.ResultReason.SynthesizingAudioCompleted)return new p.SynthesisResult(h.resultId,h.reason,h.errorDetails,h.properties);const l=atob(h.properties.getProperty(p.PropertyId.TalkingAvatarService_WebRTC_SDP)),f=new RTCSessionDescription(JSON.parse(l));return await c.setRemoteDescription(f),new p.SynthesisResult(h.resultId,h.reason,void 0,h.properties)}async speakTextAsync(c){const u=await this.speak(c,!1);return new p.SynthesisResult(u.resultId,u.reason,u.errorDetails,u.properties)}async speakSsmlAsync(c){const u=await this.speak(c,!0);return new p.SynthesisResult(u.resultId,u.reason,u.errorDetails,u.properties)}async stopSpeakingAsync(){for(;this.synthesisRequestQueue.length()>0;)(await this.synthesisRequestQueue.dequeue()).err("Synthesis is canceled by user.");return this.privAdapter.stopSpeaking()}async stopAvatarAsync(){return a.Contracts.throwIfDisposed(this.privDisposed),this.dispose(!0)}async close(){if(!this.privDisposed)return this.dispose(!0)}get iceServers(){return this.privIceServers}createSynthesisAdapter(c,u,d){return new e.AvatarSynthesisAdapter(c,u,d,this,this.privAvatarConfig)}createRestSynthesisAdapter(c,u){}createSynthesizerConfig(c){const u=super.createSynthesizerConfig(c);return u.avatarEnabled=!0,u}async speak(c,u){const d=(0,r.createNoDashGuid)(),h=new r.Deferred;return this.synthesisRequestQueue.enqueue(new n.SynthesisRequest(d,c,u,l=>{h.resolve(l),this.privSynthesizing=!1,this.adapterSpeak()},l=>{h.reject(l),this.privSynthesizing=!1})),this.adapterSpeak(),h.promise}};return cr.AvatarSynthesizer=i,cr}var Xe={};Object.defineProperty(Xe,"__esModule",{value:!0});Xe.AvatarVideoFormat=Xe.Coordinate=void 0;class cf{constructor(e,r){this.x=e,this.y=r}}Xe.Coordinate=cf;class pf{constructor(e="H264",r=2e6,o=1920,p=1080){this.codec=e,this.bitrate=r,this.width=o,this.height=p}setCropRange(e,r){this.cropRange={bottomRight:r,topLeft:e}}}Xe.AvatarVideoFormat=pf;var ur={},va;function uf(){if(va)return ur;va=1,Object.defineProperty(ur,"__esModule",{value:!0}),ur.AvatarWebRTCConnectionResult=void 0;const t=P();let e=class extends t.SynthesisResult{constructor(o,p,a,n,i){super(p,a,n,i),this.privSDPAnswer=o}get SDPAnswer(){return this.privSDPAnswer}};return ur.AvatarWebRTCConnectionResult=e,ur}var dr={},fa;function df(){if(fa)return dr;fa=1,Object.defineProperty(dr,"__esModule",{value:!0}),dr.Diagnostics=void 0;const t=x(),e=A();let r=class{static SetLoggingLevel(p){this.privListener=new t.ConsoleLoggingListener(p),e.Events.instance.attachConsoleListener(this.privListener)}static StartConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!0)}static StopConsoleOutput(){this.privListener&&(this.privListener.enableConsoleOutput=!1)}static SetLogOutputPath(p){if(typeof window>"u")this.privListener&&(this.privListener.logPath=p);else throw new Error("File system logging not available in browser.")}static set onLogOutput(p){this.privListener&&(this.privListener.logCallback=p)}};return dr.Diagnostics=r,r.privListener=void 0,dr}var ga;function P(){return ga||(ga=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectionEventArgs=t.CancellationErrorCode=t.CancellationDetails=t.CancellationDetailsBase=t.IntentRecognitionCanceledEventArgs=t.TranslationRecognitionCanceledEventArgs=t.NoMatchDetails=t.NoMatchReason=t.Translations=t.TranslationRecognizer=t.VoiceProfileType=t.IntentRecognizer=t.SpeechRecognizer=t.Recognizer=t.PropertyId=t.PropertyCollection=t.SpeechTranslationConfigImpl=t.SpeechTranslationConfig=t.SpeechConfigImpl=t.SpeechConfig=t.ResultReason=t.TranslationSynthesisResult=t.TranslationRecognitionResult=t.TranslationSynthesisEventArgs=t.TranslationRecognitionEventArgs=t.SpeechRecognitionCanceledEventArgs=t.MeetingTranscriptionEventArgs=t.ConversationTranscriptionEventArgs=t.SpeechRecognitionEventArgs=t.LanguageUnderstandingModel=t.IntentRecognitionResult=t.SpeechRecognitionResult=t.RecognitionResult=t.IntentRecognitionEventArgs=t.OutputFormat=t.RecognitionEventArgs=t.SessionEventArgs=t.KeywordRecognitionModel=t.PushAudioOutputStreamCallback=t.PullAudioInputStreamCallback=t.CancellationReason=t.PushAudioOutputStream=t.PullAudioOutputStream=t.AudioOutputStream=t.PushAudioInputStream=t.PullAudioInputStream=t.AudioInputStream=t.AudioFormatTag=t.AudioStreamFormat=t.AudioConfig=void 0,t.SpeechSynthesisEventArgs=t.SpeechSynthesisResult=t.SynthesisResult=t.SpeechSynthesizer=t.SpeechSynthesisOutputFormat=t.Synthesizer=t.User=t.ParticipantChangedReason=t.Participant=t.MeetingTranscriber=t.Meeting=t.ConversationTranscriptionResult=t.ConversationTranscriber=t.ConversationTranslator=t.ConversationTranslationResult=t.ConversationTranslationEventArgs=t.ConversationTranslationCanceledEventArgs=t.ConversationParticipantsChangedEventArgs=t.ConversationExpirationEventArgs=t.Conversation=t.SpeakerRecognitionCancellationDetails=t.SpeakerRecognitionResultType=t.SpeakerRecognitionResult=t.SourceLanguageConfig=t.AutoDetectSourceLanguageResult=t.AutoDetectSourceLanguageConfig=t.SpeakerVerificationModel=t.SpeakerIdentificationModel=t.SpeakerRecognizer=t.VoiceProfileClient=t.VoiceProfilePhraseResult=t.VoiceProfileCancellationDetails=t.VoiceProfileResult=t.VoiceProfileEnrollmentCancellationDetails=t.VoiceProfileEnrollmentResult=t.VoiceProfile=t.ConnectionMessage=t.ConnectionMessageEventArgs=t.BaseAudioPlayer=t.ProfanityOption=t.ServicePropertyChannel=t.TurnStatusReceivedEventArgs=t.ActivityReceivedEventArgs=t.DialogServiceConnector=t.CustomCommandsConfig=t.BotFrameworkConfig=t.DialogServiceConfig=t.PhraseListGrammar=t.Connection=t.ServiceEventArgs=void 0,t.LogLevel=t.Diagnostics=t.AvatarWebRTCConnectionResult=t.Coordinate=t.AvatarVideoFormat=t.AvatarSynthesizer=t.AvatarEventArgs=t.AvatarConfig=t.LanguageIdMode=t.PronunciationAssessmentResult=t.PronunciationAssessmentConfig=t.PronunciationAssessmentGranularity=t.PronunciationAssessmentGradingSystem=t.MeetingTranscriptionCanceledEventArgs=t.ConversationTranscriptionCanceledEventArgs=t.SpeakerAudioDestination=t.VoiceInfo=t.SynthesisVoiceType=t.SynthesisVoiceGender=t.SynthesisVoicesResult=t.SpeechSynthesisBoundaryType=t.SpeechSynthesisVisemeEventArgs=t.SpeechSynthesisBookmarkEventArgs=t.SpeechSynthesisWordBoundaryEventArgs=void 0;var e=qc();Object.defineProperty(t,"AudioConfig",{enumerable:!0,get:function(){return e.AudioConfig}});var r=we;Object.defineProperty(t,"AudioStreamFormat",{enumerable:!0,get:function(){return r.AudioStreamFormat}}),Object.defineProperty(t,"AudioFormatTag",{enumerable:!0,get:function(){return r.AudioFormatTag}});var o=Nc();Object.defineProperty(t,"AudioInputStream",{enumerable:!0,get:function(){return o.AudioInputStream}}),Object.defineProperty(t,"PullAudioInputStream",{enumerable:!0,get:function(){return o.PullAudioInputStream}}),Object.defineProperty(t,"PushAudioInputStream",{enumerable:!0,get:function(){return o.PushAudioInputStream}});var p=W;Object.defineProperty(t,"AudioOutputStream",{enumerable:!0,get:function(){return p.AudioOutputStream}}),Object.defineProperty(t,"PullAudioOutputStream",{enumerable:!0,get:function(){return p.PullAudioOutputStream}}),Object.defineProperty(t,"PushAudioOutputStream",{enumerable:!0,get:function(){return p.PushAudioOutputStream}});var a=Fc;Object.defineProperty(t,"CancellationReason",{enumerable:!0,get:function(){return a.CancellationReason}});var n=Bi;Object.defineProperty(t,"PullAudioInputStreamCallback",{enumerable:!0,get:function(){return n.PullAudioInputStreamCallback}});var i=qi;Object.defineProperty(t,"PushAudioOutputStreamCallback",{enumerable:!0,get:function(){return i.PushAudioOutputStreamCallback}});var s=Fi;Object.defineProperty(t,"KeywordRecognitionModel",{enumerable:!0,get:function(){return s.KeywordRecognitionModel}});var c=xi;Object.defineProperty(t,"SessionEventArgs",{enumerable:!0,get:function(){return c.SessionEventArgs}});var u=ql();Object.defineProperty(t,"RecognitionEventArgs",{enumerable:!0,get:function(){return u.RecognitionEventArgs}});var d=xc;Object.defineProperty(t,"OutputFormat",{enumerable:!0,get:function(){return d.OutputFormat}});var h=Fl();Object.defineProperty(t,"IntentRecognitionEventArgs",{enumerable:!0,get:function(){return h.IntentRecognitionEventArgs}});var l=Ui;Object.defineProperty(t,"RecognitionResult",{enumerable:!0,get:function(){return l.RecognitionResult}});var f=Ul();Object.defineProperty(t,"SpeechRecognitionResult",{enumerable:!0,get:function(){return f.SpeechRecognitionResult}});var g=Wl();Object.defineProperty(t,"IntentRecognitionResult",{enumerable:!0,get:function(){return g.IntentRecognitionResult}});var S=Qe;Object.defineProperty(t,"LanguageUnderstandingModel",{enumerable:!0,get:function(){return S.LanguageUnderstandingModel}});var v=Vl();Object.defineProperty(t,"SpeechRecognitionEventArgs",{enumerable:!0,get:function(){return v.SpeechRecognitionEventArgs}}),Object.defineProperty(t,"ConversationTranscriptionEventArgs",{enumerable:!0,get:function(){return v.ConversationTranscriptionEventArgs}}),Object.defineProperty(t,"MeetingTranscriptionEventArgs",{enumerable:!0,get:function(){return v.MeetingTranscriptionEventArgs}});var m=Hl();Object.defineProperty(t,"SpeechRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return m.SpeechRecognitionCanceledEventArgs}});var C=$l();Object.defineProperty(t,"TranslationRecognitionEventArgs",{enumerable:!0,get:function(){return C.TranslationRecognitionEventArgs}});var y=Kl();Object.defineProperty(t,"TranslationSynthesisEventArgs",{enumerable:!0,get:function(){return y.TranslationSynthesisEventArgs}});var E=Vc();Object.defineProperty(t,"TranslationRecognitionResult",{enumerable:!0,get:function(){return E.TranslationRecognitionResult}});var I=Wi;Object.defineProperty(t,"TranslationSynthesisResult",{enumerable:!0,get:function(){return I.TranslationSynthesisResult}});var w=Hc;Object.defineProperty(t,"ResultReason",{enumerable:!0,get:function(){return w.ResultReason}});var R=Gl();Object.defineProperty(t,"SpeechConfig",{enumerable:!0,get:function(){return R.SpeechConfig}}),Object.defineProperty(t,"SpeechConfigImpl",{enumerable:!0,get:function(){return R.SpeechConfigImpl}});var z=Ql();Object.defineProperty(t,"SpeechTranslationConfig",{enumerable:!0,get:function(){return z.SpeechTranslationConfig}}),Object.defineProperty(t,"SpeechTranslationConfigImpl",{enumerable:!0,get:function(){return z.SpeechTranslationConfigImpl}});var L=Kc();Object.defineProperty(t,"PropertyCollection",{enumerable:!0,get:function(){return L.PropertyCollection}});var se=Vi;Object.defineProperty(t,"PropertyId",{enumerable:!0,get:function(){return se.PropertyId}});var Ke=Xl();Object.defineProperty(t,"Recognizer",{enumerable:!0,get:function(){return Ke.Recognizer}});var Y=Zl();Object.defineProperty(t,"SpeechRecognizer",{enumerable:!0,get:function(){return Y.SpeechRecognizer}});var Ms=Yl();Object.defineProperty(t,"IntentRecognizer",{enumerable:!0,get:function(){return Ms.IntentRecognizer}});var Kp=Qc;Object.defineProperty(t,"VoiceProfileType",{enumerable:!0,get:function(){return Kp.VoiceProfileType}});var Jp=ev();Object.defineProperty(t,"TranslationRecognizer",{enumerable:!0,get:function(){return Jp.TranslationRecognizer}});var Gp=tv();Object.defineProperty(t,"Translations",{enumerable:!0,get:function(){return Gp.Translations}});var Qp=ep;Object.defineProperty(t,"NoMatchReason",{enumerable:!0,get:function(){return Qp.NoMatchReason}});var Xp=rv();Object.defineProperty(t,"NoMatchDetails",{enumerable:!0,get:function(){return Xp.NoMatchDetails}});var Zp=Hi;Object.defineProperty(t,"TranslationRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return Zp.TranslationRecognitionCanceledEventArgs}});var Yp=nv();Object.defineProperty(t,"IntentRecognitionCanceledEventArgs",{enumerable:!0,get:function(){return Yp.IntentRecognitionCanceledEventArgs}});var eu=ti;Object.defineProperty(t,"CancellationDetailsBase",{enumerable:!0,get:function(){return eu.CancellationDetailsBase}});var tu=ov();Object.defineProperty(t,"CancellationDetails",{enumerable:!0,get:function(){return tu.CancellationDetails}});var ru=ip;Object.defineProperty(t,"CancellationErrorCode",{enumerable:!0,get:function(){return ru.CancellationErrorCode}});var iu=av();Object.defineProperty(t,"ConnectionEventArgs",{enumerable:!0,get:function(){return iu.ConnectionEventArgs}});var nu=cv();Object.defineProperty(t,"ServiceEventArgs",{enumerable:!0,get:function(){return nu.ServiceEventArgs}});var su=Zc();Object.defineProperty(t,"Connection",{enumerable:!0,get:function(){return su.Connection}});var ou=$i;Object.defineProperty(t,"PhraseListGrammar",{enumerable:!0,get:function(){return ou.PhraseListGrammar}});var au=ds();Object.defineProperty(t,"DialogServiceConfig",{enumerable:!0,get:function(){return au.DialogServiceConfig}});var cu=pv();Object.defineProperty(t,"BotFrameworkConfig",{enumerable:!0,get:function(){return cu.BotFrameworkConfig}});var pu=uv();Object.defineProperty(t,"CustomCommandsConfig",{enumerable:!0,get:function(){return pu.CustomCommandsConfig}});var uu=hv();Object.defineProperty(t,"DialogServiceConnector",{enumerable:!0,get:function(){return uu.DialogServiceConnector}});var du=Ki;Object.defineProperty(t,"ActivityReceivedEventArgs",{enumerable:!0,get:function(){return du.ActivityReceivedEventArgs}});var hu=Ji;Object.defineProperty(t,"TurnStatusReceivedEventArgs",{enumerable:!0,get:function(){return hu.TurnStatusReceivedEventArgs}});var lu=np;Object.defineProperty(t,"ServicePropertyChannel",{enumerable:!0,get:function(){return lu.ServicePropertyChannel}});var vu=sp;Object.defineProperty(t,"ProfanityOption",{enumerable:!0,get:function(){return vu.ProfanityOption}});var fu=gv();Object.defineProperty(t,"BaseAudioPlayer",{enumerable:!0,get:function(){return fu.BaseAudioPlayer}});var gu=Qi;Object.defineProperty(t,"ConnectionMessageEventArgs",{enumerable:!0,get:function(){return gu.ConnectionMessageEventArgs}});var mu=Xc();Object.defineProperty(t,"ConnectionMessage",{enumerable:!0,get:function(){return mu.ConnectionMessage}});var Su=Xi;Object.defineProperty(t,"VoiceProfile",{enumerable:!0,get:function(){return Su.VoiceProfile}});var Os=Cv();Object.defineProperty(t,"VoiceProfileEnrollmentResult",{enumerable:!0,get:function(){return Os.VoiceProfileEnrollmentResult}}),Object.defineProperty(t,"VoiceProfileEnrollmentCancellationDetails",{enumerable:!0,get:function(){return Os.VoiceProfileEnrollmentCancellationDetails}});var Ds=yv();Object.defineProperty(t,"VoiceProfileResult",{enumerable:!0,get:function(){return Ds.VoiceProfileResult}}),Object.defineProperty(t,"VoiceProfileCancellationDetails",{enumerable:!0,get:function(){return Ds.VoiceProfileCancellationDetails}});var Cu=Pv();Object.defineProperty(t,"VoiceProfilePhraseResult",{enumerable:!0,get:function(){return Cu.VoiceProfilePhraseResult}});var yu=Rv();Object.defineProperty(t,"VoiceProfileClient",{enumerable:!0,get:function(){return yu.VoiceProfileClient}});var Pu=Ev();Object.defineProperty(t,"SpeakerRecognizer",{enumerable:!0,get:function(){return Pu.SpeakerRecognizer}});var Ru=Iv();Object.defineProperty(t,"SpeakerIdentificationModel",{enumerable:!0,get:function(){return Ru.SpeakerIdentificationModel}});var Eu=Tv();Object.defineProperty(t,"SpeakerVerificationModel",{enumerable:!0,get:function(){return Eu.SpeakerVerificationModel}});var Iu=Av();Object.defineProperty(t,"AutoDetectSourceLanguageConfig",{enumerable:!0,get:function(){return Iu.AutoDetectSourceLanguageConfig}});var Tu=Zi;Object.defineProperty(t,"AutoDetectSourceLanguageResult",{enumerable:!0,get:function(){return Tu.AutoDetectSourceLanguageResult}});var Au=Yi;Object.defineProperty(t,"SourceLanguageConfig",{enumerable:!0,get:function(){return Au.SourceLanguageConfig}});var wn=_v();Object.defineProperty(t,"SpeakerRecognitionResult",{enumerable:!0,get:function(){return wn.SpeakerRecognitionResult}}),Object.defineProperty(t,"SpeakerRecognitionResultType",{enumerable:!0,get:function(){return wn.SpeakerRecognitionResultType}}),Object.defineProperty(t,"SpeakerRecognitionCancellationDetails",{enumerable:!0,get:function(){return wn.SpeakerRecognitionCancellationDetails}});var te=fs();Object.defineProperty(t,"Conversation",{enumerable:!0,get:function(){return te.Conversation}}),Object.defineProperty(t,"ConversationExpirationEventArgs",{enumerable:!0,get:function(){return te.ConversationExpirationEventArgs}}),Object.defineProperty(t,"ConversationParticipantsChangedEventArgs",{enumerable:!0,get:function(){return te.ConversationParticipantsChangedEventArgs}}),Object.defineProperty(t,"ConversationTranslationCanceledEventArgs",{enumerable:!0,get:function(){return te.ConversationTranslationCanceledEventArgs}}),Object.defineProperty(t,"ConversationTranslationEventArgs",{enumerable:!0,get:function(){return te.ConversationTranslationEventArgs}}),Object.defineProperty(t,"ConversationTranslationResult",{enumerable:!0,get:function(){return te.ConversationTranslationResult}}),Object.defineProperty(t,"ConversationTranslator",{enumerable:!0,get:function(){return te.ConversationTranslator}}),Object.defineProperty(t,"ConversationTranscriber",{enumerable:!0,get:function(){return te.ConversationTranscriber}}),Object.defineProperty(t,"ConversationTranscriptionResult",{enumerable:!0,get:function(){return te.ConversationTranscriptionResult}}),Object.defineProperty(t,"Meeting",{enumerable:!0,get:function(){return te.Meeting}}),Object.defineProperty(t,"MeetingTranscriber",{enumerable:!0,get:function(){return te.MeetingTranscriber}}),Object.defineProperty(t,"Participant",{enumerable:!0,get:function(){return te.Participant}}),Object.defineProperty(t,"ParticipantChangedReason",{enumerable:!0,get:function(){return te.ParticipantChangedReason}}),Object.defineProperty(t,"User",{enumerable:!0,get:function(){return te.User}});var wu=gs();Object.defineProperty(t,"Synthesizer",{enumerable:!0,get:function(){return wu.Synthesizer}});var _u=as;Object.defineProperty(t,"SpeechSynthesisOutputFormat",{enumerable:!0,get:function(){return _u.SpeechSynthesisOutputFormat}});var bu=Vv();Object.defineProperty(t,"SpeechSynthesizer",{enumerable:!0,get:function(){return bu.SpeechSynthesizer}});var Mu=tn;Object.defineProperty(t,"SynthesisResult",{enumerable:!0,get:function(){return Mu.SynthesisResult}});var Ou=$v();Object.defineProperty(t,"SpeechSynthesisResult",{enumerable:!0,get:function(){return Ou.SpeechSynthesisResult}});var Du=rn;Object.defineProperty(t,"SpeechSynthesisEventArgs",{enumerable:!0,get:function(){return Du.SpeechSynthesisEventArgs}});var ku=nn;Object.defineProperty(t,"SpeechSynthesisWordBoundaryEventArgs",{enumerable:!0,get:function(){return ku.SpeechSynthesisWordBoundaryEventArgs}});var Nu=sn;Object.defineProperty(t,"SpeechSynthesisBookmarkEventArgs",{enumerable:!0,get:function(){return Nu.SpeechSynthesisBookmarkEventArgs}});var zu=on;Object.defineProperty(t,"SpeechSynthesisVisemeEventArgs",{enumerable:!0,get:function(){return zu.SpeechSynthesisVisemeEventArgs}});var ju=vp;Object.defineProperty(t,"SpeechSynthesisBoundaryType",{enumerable:!0,get:function(){return ju.SpeechSynthesisBoundaryType}});var Lu=Xv();Object.defineProperty(t,"SynthesisVoicesResult",{enumerable:!0,get:function(){return Lu.SynthesisVoicesResult}});var _n=fp;Object.defineProperty(t,"SynthesisVoiceGender",{enumerable:!0,get:function(){return _n.SynthesisVoiceGender}}),Object.defineProperty(t,"SynthesisVoiceType",{enumerable:!0,get:function(){return _n.SynthesisVoiceType}}),Object.defineProperty(t,"VoiceInfo",{enumerable:!0,get:function(){return _n.VoiceInfo}});var Bu=an;Object.defineProperty(t,"SpeakerAudioDestination",{enumerable:!0,get:function(){return Bu.SpeakerAudioDestination}});var qu=tf();Object.defineProperty(t,"ConversationTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return qu.ConversationTranscriptionCanceledEventArgs}});var Fu=rf();Object.defineProperty(t,"MeetingTranscriptionCanceledEventArgs",{enumerable:!0,get:function(){return Fu.MeetingTranscriptionCanceledEventArgs}});var xu=gp;Object.defineProperty(t,"PronunciationAssessmentGradingSystem",{enumerable:!0,get:function(){return xu.PronunciationAssessmentGradingSystem}});var Uu=mp;Object.defineProperty(t,"PronunciationAssessmentGranularity",{enumerable:!0,get:function(){return Uu.PronunciationAssessmentGranularity}});var Wu=nf();Object.defineProperty(t,"PronunciationAssessmentConfig",{enumerable:!0,get:function(){return Wu.PronunciationAssessmentConfig}});var Vu=sf();Object.defineProperty(t,"PronunciationAssessmentResult",{enumerable:!0,get:function(){return Vu.PronunciationAssessmentResult}});var Hu=ls;Object.defineProperty(t,"LanguageIdMode",{enumerable:!0,get:function(){return Hu.LanguageIdMode}});var $u=of();Object.defineProperty(t,"AvatarConfig",{enumerable:!0,get:function(){return $u.AvatarConfig}});var Ku=yp;Object.defineProperty(t,"AvatarEventArgs",{enumerable:!0,get:function(){return Ku.AvatarEventArgs}});var Ju=af();Object.defineProperty(t,"AvatarSynthesizer",{enumerable:!0,get:function(){return Ju.AvatarSynthesizer}});var ks=Xe;Object.defineProperty(t,"AvatarVideoFormat",{enumerable:!0,get:function(){return ks.AvatarVideoFormat}}),Object.defineProperty(t,"Coordinate",{enumerable:!0,get:function(){return ks.Coordinate}});var Gu=uf();Object.defineProperty(t,"AvatarWebRTCConnectionResult",{enumerable:!0,get:function(){return Gu.AvatarWebRTCConnectionResult}});var Qu=df();Object.defineProperty(t,"Diagnostics",{enumerable:!0,get:function(){return Qu.Diagnostics}});var Xu=ss;Object.defineProperty(t,"LogLevel",{enumerable:!0,get:function(){return Xu.LogLevel}})}(Fn)),Fn}var ma;function hf(){if(ma)return ut;ma=1,Object.defineProperty(ut,"__esModule",{value:!0}),ut.ProxyInfo=void 0;const t=P();let e=class Rp{constructor(o,p,a,n){this.privProxyHostName=o,this.privProxyPort=p,this.privProxyUserName=a,this.privProxyPassword=n}static fromParameters(o){return new Rp(o.getProperty(t.PropertyId.SpeechServiceConnection_ProxyHostName),parseInt(o.getProperty(t.PropertyId.SpeechServiceConnection_ProxyPort),10),o.getProperty(t.PropertyId.SpeechServiceConnection_ProxyUserName),o.getProperty(t.PropertyId.SpeechServiceConnection_ProxyPassword))}static fromRecognizerConfig(o){return this.fromParameters(o.parameters)}get HostName(){return this.privProxyHostName}get Port(){return this.privProxyPort}get UserName(){return this.privProxyUserName}get Password(){return this.privProxyPassword}};return ut.ProxyInfo=e,ut}var Ep={};const lf=new Set(["json","buffer","string"]);var vf=t=>(...e)=>{const r=new Set;let o,p,a,n="";return e.forEach(i=>{if(typeof i=="string")if(i.toUpperCase()===i)if(o){const s=`Can't set method to ${i}, already set to ${o}.`;throw new Error(s)}else o=i;else if(i.startsWith("http:")||i.startsWith("https:"))n=i;else if(lf.has(i))p=i;else throw new Error(`Unknown encoding, ${i}`);else if(typeof i=="number")r.add(i);else if(typeof i=="object")if(Array.isArray(i)||i instanceof Set)i.forEach(s=>r.add(s));else{if(a)throw new Error("Cannot set headers twice.");a=i}else throw new Error(`Unknown type: ${typeof i}`)}),o||(o="GET"),r.size===0&&r.add(200),t(r,o,p,a,n)};const ff=vf;class ms extends Error{constructor(e,...r){super(...r),Error.captureStackTrace&&Error.captureStackTrace(this,ms),this.name="StatusError",this.message=e.statusMessage,this.statusCode=e.status,this.res=e,this.json=e.json.bind(e),this.text=e.text.bind(e),this.arrayBuffer=e.arrayBuffer.bind(e);let o;Object.defineProperty(this,"responseBody",{get:()=>(o||(o=this.arrayBuffer()),o)}),this.headers={};for(const[a,n]of e.headers.entries())this.headers[a.toLowerCase()]=n}}const gf=(t,e,r,o,p)=>async(a,n,i={})=>{a=p+(a||"");let s=new URL(a);if(o||(o={}),s.username&&(o.Authorization="Basic "+btoa(s.username+":"+s.password),s=new URL(s.protocol+"//"+s.host+s.pathname+s.search)),s.protocol!=="https:"&&s.protocol!=="http:")throw new Error(`Unknown protocol, ${s.protocol}`);if(n&&!(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="string"))if(typeof n=="object")n=JSON.stringify(n),o["Content-Type"]="application/json";else throw new Error("Unknown body type.");i=new Headers({...o||{},...i});const c=await fetch(s,{method:e,headers:i,body:n});if(c.statusCode=c.status,!t.has(c.status))throw new ms(c);return r==="json"?c.json():r==="buffer"?c.arrayBuffer():r==="string"?c.text():c};var mf=ff(gf);(function(t){var e=k&&k.__importDefault||function(n){return n&&n.__esModule?n:{default:n}};Object.defineProperty(t,"__esModule",{value:!0}),t.RestMessageAdapter=t.RestRequestType=void 0;const r=e(mf),o=A();var p;(function(n){n.Get="GET",n.Post="POST",n.Delete="DELETE",n.File="file"})(p=t.RestRequestType||(t.RestRequestType={}));class a{constructor(i){if(!i)throw new o.ArgumentNullError("configParams");this.privHeaders=i.headers,this.privIgnoreCache=i.ignoreCache}static extractHeaderValue(i,s){let c="";try{const u=s.trim().split(/[\r\n]+/),d={};u.forEach(h=>{const l=h.split(": "),f=l.shift().toLowerCase(),g=l.join(": ");d[f]=g}),c=d[i.toLowerCase()]}catch{}return c}set options(i){this.privHeaders=i.headers,this.privIgnoreCache=i.ignoreCache}setHeaders(i,s){this.privHeaders[i]=s}request(i,s,c={},u=null){const d=new o.Deferred,h=i===p.File?"POST":i,l=(g,S={})=>{const v=g;return{data:JSON.stringify(S),headers:JSON.stringify(g.headers),json:S,ok:g.statusCode>=200&&g.statusCode<300,status:g.statusCode,statusText:S.error?S.error.message:v.statusText?v.statusText:v.statusMessage}},f=g=>{const S=(0,r.default)(s,h,this.privHeaders,200,201,202,204,400,401,402,403,404),v=this.queryParams(c)===""?"":`?${this.queryParams(c)}`;S(v,g).then(async m=>{if(i===p.Delete||m.statusCode===204)d.resolve(l(m));else try{const C=await m.json();d.resolve(l(m,C))}catch{d.resolve(l(m))}}).catch(m=>{d.reject(m)})};return this.privIgnoreCache&&(this.privHeaders["Cache-Control"]="no-cache"),i===p.Post&&u&&(this.privHeaders["content-type"]="application/json",this.privHeaders["Content-Type"]="application/json"),f(u),d.promise}queryParams(i={}){return Object.keys(i).map(s=>encodeURIComponent(s)+"="+encodeURIComponent(i[s])).join("&")}}t.RestMessageAdapter=a})(Ep);var ii={};Object.defineProperty(ii,"__esModule",{value:!0});ii.RestConfigBase=void 0;class Ee{static get requestOptions(){return Ee.privDefaultRequestOptions}static get configParams(){return Ee.privDefaultParams}static get restErrors(){return Ee.privRestErrors}}ii.RestConfigBase=Ee;Ee.privDefaultRequestOptions={headers:{Accept:"application/json"},ignoreCache:!1,timeout:1e4};Ee.privRestErrors={authInvalidSubscriptionKey:"You must specify either an authentication token to use, or a Cognitive Speech subscription key.",authInvalidSubscriptionRegion:"You must specify the Cognitive Speech region to use.",invalidArgs:"Required input not found: {arg}.",invalidCreateJoinConversationResponse:"Creating/Joining conversation failed with HTTP {status}.",invalidParticipantRequest:"The requested participant was not found.",permissionDeniedConnect:"Required credentials not found.",permissionDeniedConversation:"Invalid operation: only the host can {command} the conversation.",permissionDeniedParticipant:"Invalid operation: only the host can {command} a participant.",permissionDeniedSend:"Invalid operation: the conversation is not in a connected state.",permissionDeniedStart:"Invalid operation: there is already an active conversation."};Ee.privDefaultParams={apiVersion:"api-version",authorization:"Authorization",clientAppId:"X-ClientAppId",contentTypeKey:"Content-Type",correlationId:"X-CorrelationId",languageCode:"language",nickname:"nickname",profanity:"profanity",requestId:"X-RequestId",roomId:"roomid",sessionToken:"token",subscriptionKey:"Ocp-Apim-Subscription-Key",subscriptionRegion:"Ocp-Apim-Subscription-Region",token:"X-CapitoToken"};var Sa;function x(){return Sa||(Sa=1,function(t){var e=k&&k.__createBinding||(Object.create?function(o,p,a,n){n===void 0&&(n=a),Object.defineProperty(o,n,{enumerable:!0,get:function(){return p[a]}})}:function(o,p,a,n){n===void 0&&(n=a),o[n]=p[a]}),r=k&&k.__exportStar||function(o,p){for(var a in o)a!=="default"&&!Object.prototype.hasOwnProperty.call(p,a)&&e(p,o,a)};Object.defineProperty(t,"__esModule",{value:!0}),r(Ni,t),r(Dc,t),r(ll(),t),r(vl(),t),r(zi,t),r(ji,t),r(Zr,t),r(Li,t),r(hf(),t),r(Ep,t),r(ii,t)}(Ln)),Ln}var Ca;function Sf(){if(Ca)return at;Ca=1,Object.defineProperty(at,"__esModule",{value:!0}),at.IntentConnectionFactory=void 0;const t=x(),e=P(),r=ue(),o=T(),p=F;let a=class extends r.ConnectionFactoryBase{create(i,s,c){let u=i.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint);if(!u){const f=i.parameters.getProperty(e.PropertyId.SpeechServiceConnection_IntentRegion),g=r.ConnectionFactoryBase.getHostSuffix(f);u=i.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+f+".sr.speech"+g)+"/speech/recognition/interactive/cognitiveservices/v1"}const d={format:"simple",language:i.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(i,d,u);const h={};s.token!==void 0&&s.token!==""&&(h[s.headerName]=s.token),h[p.HeaderNames.ConnectionId]=c,i.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,u);const l=i.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new t.WebsocketConnection(u,d,h,new o.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(i),l,c))}getSpeechRegionFromIntentRegion(i){switch(i){case"West US":case"US West":case"westus":return"uswest";case"West US 2":case"US West 2":case"westus2":return"uswest2";case"South Central US":case"US South Central":case"southcentralus":return"ussouthcentral";case"West Central US":case"US West Central":case"westcentralus":return"uswestcentral";case"East US":case"US East":case"eastus":return"useast";case"East US 2":case"US East 2":case"eastus2":return"useast2";case"West Europe":case"Europe West":case"westeurope":return"europewest";case"North Europe":case"Europe North":case"northeurope":return"europenorth";case"Brazil South":case"South Brazil":case"southbrazil":return"brazilsouth";case"Australia East":case"East Australia":case"eastaustralia":return"australiaeast";case"Southeast Asia":case"Asia Southeast":case"southeastasia":return"asiasoutheast";case"East Asia":case"Asia East":case"eastasia":return"asiaeast";default:return i}}};return at.IntentConnectionFactory=a,at}var xe={},ya;function Cf(){if(ya)return xe;ya=1,Object.defineProperty(xe,"__esModule",{value:!0}),xe.VoiceProfileConnectionFactory=xe.SpeakerRecognitionConnectionFactory=void 0;const t=x(),e=P(),r=ue(),o=T(),p=F;class a extends r.ConnectionFactoryBase{create(c,u,d,h){let l=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint);if(!l){const v=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region),m=r.ConnectionFactoryBase.getHostSuffix(v),C=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,`wss://${v}.spr-frontend.speech${m}`),y=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_SpeakerIdMode,"TextIndependentIdentification");l=`${C}/speaker/ws/${this.scenarioToPath(y)}/${d}`}const f={format:"simple",language:c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage)};this.setCommonUrlParams(c,f,l);const g={};u.token!==void 0&&u.token!==""&&(g[u.headerName]=u.token),g[p.HeaderNames.ConnectionId]=h,g[p.HeaderNames.SpIDAuthKey]=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Key),c.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,l);const S=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new t.WebsocketConnection(l,f,g,new o.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(c),S,h))}scenarioToPath(c){switch(c){case"TextIndependentVerification":case"2":return"verification/text-independent";case"TextDependentVerification":case"1":return"verification/text-dependent";default:return"identification/text-independent"}}}let n=class extends a{create(c,u,d){return super.create(c,u,"recognition",d)}};xe.SpeakerRecognitionConnectionFactory=n;class i extends a{create(c,u,d){return super.create(c,u,"profile",d)}}return xe.VoiceProfileConnectionFactory=i,xe}var cn={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.RecognitionEndedEvent=t.RecognitionCompletionStatus=t.RecognitionStartedEvent=t.ConnectingToServiceEvent=t.ListeningStartedEvent=t.RecognitionTriggeredEvent=t.SpeechRecognitionEvent=void 0;const e=A();class r extends e.PlatformEvent{constructor(u,d,h,l=e.EventType.Info){super(u,l),this.privRequestId=d,this.privSessionId=h}get requestId(){return this.privRequestId}get sessionId(){return this.privSessionId}}t.SpeechRecognitionEvent=r;class o extends r{constructor(u,d,h,l){super("RecognitionTriggeredEvent",u,d),this.privAudioSourceId=h,this.privAudioNodeId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}t.RecognitionTriggeredEvent=o;class p extends r{constructor(u,d,h,l){super("ListeningStartedEvent",u,d),this.privAudioSourceId=h,this.privAudioNodeId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}}t.ListeningStartedEvent=p;class a extends r{constructor(u,d,h){super("ConnectingToServiceEvent",u,h),this.privAuthFetchEventid=d}get authFetchEventid(){return this.privAuthFetchEventid}}t.ConnectingToServiceEvent=a;class n extends r{constructor(u,d,h,l,f){super("RecognitionStartedEvent",u,f),this.privAudioSourceId=d,this.privAudioNodeId=h,this.privAuthFetchEventId=l}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}}t.RecognitionStartedEvent=n;var i;(function(c){c[c.Success=0]="Success",c[c.AudioSourceError=1]="AudioSourceError",c[c.AudioSourceTimeout=2]="AudioSourceTimeout",c[c.AuthTokenFetchError=3]="AuthTokenFetchError",c[c.AuthTokenFetchTimeout=4]="AuthTokenFetchTimeout",c[c.UnAuthorized=5]="UnAuthorized",c[c.ConnectTimeout=6]="ConnectTimeout",c[c.ConnectError=7]="ConnectError",c[c.ClientRecognitionActivityTimeout=8]="ClientRecognitionActivityTimeout",c[c.UnknownError=9]="UnknownError"})(i=t.RecognitionCompletionStatus||(t.RecognitionCompletionStatus={}));class s extends r{constructor(u,d,h,l,f,g,S,v){super("RecognitionEndedEvent",u,f,S===i.Success?e.EventType.Info:e.EventType.Error),this.privAudioSourceId=d,this.privAudioNodeId=h,this.privAuthFetchEventId=l,this.privStatus=S,this.privError=v,this.privServiceTag=g}get audioSourceId(){return this.privAudioSourceId}get audioNodeId(){return this.privAudioNodeId}get authFetchEventId(){return this.privAuthFetchEventId}get serviceTag(){return this.privServiceTag}get status(){return this.privStatus}get error(){return this.privError}}t.RecognitionEndedEvent=s})(cn);var hr={},Se={};Object.defineProperty(Se,"__esModule",{value:!0});Se.SpeechConnectionMessage=void 0;const Hn=A(),ve=F;class Ss extends Hn.ConnectionMessage{constructor(e,r,o,p,a,n,i,s){if(!r)throw new Hn.ArgumentNullError("path");if(!o)throw new Hn.ArgumentNullError("requestId");const c={};if(c[ve.HeaderNames.Path]=r,c[ve.HeaderNames.RequestId]=o,c[ve.HeaderNames.RequestTimestamp]=new Date().toISOString(),p&&(c[ve.HeaderNames.ContentType]=p),n&&(c[ve.HeaderNames.RequestStreamId]=n),i)for(const u in i)u&&(c[u]=i[u]);s?super(e,a,c,s):super(e,a,c),this.privPath=r,this.privRequestId=o,this.privContentType=p,this.privStreamId=n,this.privAdditionalHeaders=i}get path(){return this.privPath}get requestId(){return this.privRequestId}get contentType(){return this.privContentType}get streamId(){return this.privStreamId}get additionalHeaders(){return this.privAdditionalHeaders}static fromConnectionMessage(e){let r=null,o=null,p=null,a=null;const n={};if(e.headers)for(const i in e.headers)i&&(i.toLowerCase()===ve.HeaderNames.Path.toLowerCase()?r=e.headers[i]:i.toLowerCase()===ve.HeaderNames.RequestId.toLowerCase()?o=e.headers[i]:i.toLowerCase()===ve.HeaderNames.ContentType.toLowerCase()?p=e.headers[i]:i.toLowerCase()===ve.HeaderNames.RequestStreamId.toLowerCase()?a=e.headers[i]:n[i]=e.headers[i]);return new Ss(e.messageType,r,o,p,e.body,a,n,e.id)}}Se.SpeechConnectionMessage=Ss;var Ip={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SegmentationMode=void 0,function(e){e.Normal="Normal",e.Disabled="Disabled",e.Custom="Custom",e.Semantic="Semantic"}(t.SegmentationMode||(t.SegmentationMode={}))})(Ip);var Tp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.NextAction=void 0,function(e){e.None="None",e.Synthesize="Synthesize"}(t.NextAction||(t.NextAction={}))})(Tp);var Ap={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.Mode=void 0,function(e){e.None="None",e.Always="Always"}(t.Mode||(t.Mode={}))})(Ap);var wp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.LanguageIdDetectionPriority=t.LanguageIdDetectionMode=void 0,function(e){e.DetectAtAudioStart="DetectAtAudioStart",e.DetectContinuous="DetectContinuous",e.DetectSegments="DetectSegments"}(t.LanguageIdDetectionMode||(t.LanguageIdDetectionMode={})),function(e){e.Auto="Auto",e.PrioritizeLatency="PrioritizeLatency",e.PrioritizeAccuracy="PrioritizeAccuracy"}(t.LanguageIdDetectionPriority||(t.LanguageIdDetectionPriority={}))})(wp);var _p={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.NextAction=void 0,function(e){e.Recognize="Recognize",e.None="None"}(t.NextAction||(t.NextAction={}))})(_p);var bp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OnUnknownAction=void 0,function(e){e.RecognizeWithDefaultLanguage="RecognizeWithDefaultLanguage",e.None="None"}(t.OnUnknownAction||(t.OnUnknownAction={}))})(bp);var Mp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ResultType=void 0,function(e){e.Auto="Auto",e.StableFragment="StableFragment",e.Hypothesis="Hypothesis",e.None="None"}(t.ResultType||(t.ResultType={}))})(Mp);var Op={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.PhraseResultOutputType=void 0,function(e){e.Always="Always",e.None="None"}(t.PhraseResultOutputType||(t.PhraseResultOutputType={}))})(Op);var Dp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.NextAction=void 0,function(e){e.None="None",e.Translate="Translate"}(t.NextAction||(t.NextAction={}))})(Dp);var Pa;function yf(){if(Pa)return hr;Pa=1,Object.defineProperty(hr,"__esModule",{value:!0}),hr.ServiceRecognizerBase=void 0;const t=x(),e=A(),r=P(),o=T(),p=Se,a=Ip,n=ne,i=Tp,s=Ap,c=wp,u=_p,d=bp,h=Mp,l=Op,f=Dp;let g=class Ur{constructor(v,m,C,y,E){if(this.privConnectionConfigurationPromise=void 0,this.privConnectionPromise=void 0,this.privSetTimeout=setTimeout,this.privIsLiveAudio=!1,this.privAverageBytesPerMs=0,this.privEnableSpeakerId=!1,this.privExpectContentAssessmentResponse=!1,this.recognizeOverride=void 0,this.recognizeSpeaker=void 0,this.disconnectOverride=void 0,this.receiveMessageOverride=void 0,this.sendPrePayloadJSONOverride=void 0,this.postConnectImplOverride=void 0,this.configConnectionOverride=void 0,this.handleSpeechPhraseMessage=void 0,this.handleSpeechHypothesisMessage=void 0,!v)throw new e.ArgumentNullError("authentication");if(!m)throw new e.ArgumentNullError("connectionFactory");if(!C)throw new e.ArgumentNullError("audioSource");if(!y)throw new e.ArgumentNullError("recognizerConfig");this.privEnableSpeakerId=y.isSpeakerDiarizationEnabled,this.privMustReportEndOfStream=!1,this.privAuthentication=v,this.privConnectionFactory=m,this.privAudioSource=C,this.privRecognizerConfig=y,this.privIsDisposed=!1,this.privRecognizer=E,this.privRequestSession=new o.RequestSession(this.privAudioSource.id()),this.privConnectionEvents=new e.EventSource,this.privServiceEvents=new e.EventSource,this.privDynamicGrammar=new o.DynamicGrammarBuilder,this.privSpeechContext=new o.SpeechContext(this.privDynamicGrammar),this.privAgentConfig=new o.AgentConfig,this.privRecognizerConfig.parameters.getProperty(r.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?this.privSetTimeout=e.Timeout.setTimeout:(typeof window<"u"&&(this.privSetTimeout=window.setTimeout.bind(window)),typeof globalThis<"u"&&(this.privSetTimeout=globalThis.setTimeout.bind(globalThis))),this.connectionEvents.attach(w=>{if(w.name==="ConnectionClosedEvent"){const R=w;(R.statusCode===1003||R.statusCode===1007||R.statusCode===1002||R.statusCode===4e3||this.privRequestSession.numConnectionAttempts>this.privRecognizerConfig.maxRetryCount)&&this.cancelRecognitionLocal(r.CancellationReason.Error,R.statusCode===1007?r.CancellationErrorCode.BadRequestParameters:r.CancellationErrorCode.ConnectionFailure,`${R.reason} websocket error code: ${R.statusCode}`)}}),this.privEnableSpeakerId&&(this.privDiarizationSessionId=(0,e.createNoDashGuid)())}setTranslationJson(){const v=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0);if(v!==void 0){const m=v.split(","),C=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0),y=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationCategoryId,void 0),E=C!==void 0?i.NextAction.Synthesize:i.NextAction.None;if(this.privSpeechContext.getContext().translation={onPassthrough:{action:E},onSuccess:{action:E},output:{includePassThroughResults:!0,interimResults:{mode:s.Mode.Always}},targetLanguages:m},y!==void 0&&(this.privSpeechContext.getContext().translation.category=y),C!==void 0){const w={};for(const R of m)w[R]=C;this.privSpeechContext.getContext().synthesis={defaultVoices:w}}const I=this.privSpeechContext.getContext().phraseDetection||{};I.onSuccess={action:f.NextAction.Translate},I.onInterim={action:f.NextAction.Translate},this.privSpeechContext.getContext().phraseDetection=I}}setSpeechSegmentationTimeoutJson(){const v=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationSilenceTimeoutMs,void 0),m=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationMaximumTimeMs,void 0),C=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.Speech_SegmentationStrategy,void 0),y={mode:a.SegmentationMode.Normal};let E=!1;if(C!==void 0){E=!0;let I=a.SegmentationMode.Normal;switch(C.toLowerCase()){case"default":break;case"time":I=a.SegmentationMode.Custom;break;case"semantic":I=a.SegmentationMode.Semantic;break}y.mode=I}if(v!==void 0){E=!0;const I=parseInt(v,10);y.mode=a.SegmentationMode.Custom,y.segmentationSilenceTimeoutMs=I}if(m!==void 0){E=!0;const I=parseInt(m,10);y.mode=a.SegmentationMode.Custom,y.segmentationForcedTimeoutMs=I}if(E){const I=this.privSpeechContext.getContext().phraseDetection||{};switch(I.mode=this.recognitionMode,this.recognitionMode){case n.RecognitionMode.Conversation:I.conversation=I.conversation??{segmentation:{}},I.conversation.segmentation=y;break;case n.RecognitionMode.Interactive:I.interactive=I.interactive??{segmentation:{}},I.interactive.segmentation=y;break;case n.RecognitionMode.Dictation:I.dictation=I.dictation??{},I.dictation.segmentation=y;break}this.privSpeechContext.getContext().phraseDetection=I}}setLanguageIdJson(){const v=this.privSpeechContext.getContext().phraseDetection||{};if(this.privRecognizerConfig.autoDetectSourceLanguages!==void 0){const m=this.privRecognizerConfig.autoDetectSourceLanguages.split(",");m.length===1&&m[0]===o.AutoDetectSourceLanguagesOpenRangeOptionName&&(m[0]="UND");let C;this.privRecognizerConfig.languageIdMode==="Continuous"?C=c.LanguageIdDetectionMode.DetectContinuous:C=c.LanguageIdDetectionMode.DetectAtAudioStart,this.privSpeechContext.getContext().languageId={languages:m,mode:C,onSuccess:{action:u.NextAction.Recognize},onUnknown:{action:d.OnUnknownAction.None},priority:c.LanguageIdDetectionPriority.PrioritizeLatency},this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:h.ResultType.Auto},phraseResults:{resultType:l.PhraseResultOutputType.Always}};const y=this.privRecognizerConfig.sourceLanguageModels;y!==void 0&&(v.customModels=y,v.onInterim={action:f.NextAction.None},v.onSuccess={action:f.NextAction.None})}this.privSpeechContext.getContext().phraseDetection=v}setOutputDetailLevelJson(){this.privEnableSpeakerId&&(this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true"?this.privSpeechContext.setWordLevelTimings():this.privRecognizerConfig.parameters.getProperty(o.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()===r.OutputFormat[r.OutputFormat.Detailed].toLocaleLowerCase()&&this.privSpeechContext.setDetailedOutputFormat())}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}get audioSource(){return this.privAudioSource}get speechContext(){return this.privSpeechContext}get dynamicGrammar(){return this.privDynamicGrammar}get agentConfig(){return this.privAgentConfig}set conversationTranslatorToken(v){this.privRecognizerConfig.parameters.setProperty(r.PropertyId.ConversationTranslator_Token,v)}set voiceProfileType(v){this.privRecognizerConfig.parameters.setProperty(r.PropertyId.SpeechServiceConnection_SpeakerIdMode,v)}set authentication(v){this.privAuthentication=v}isDisposed(){return this.privIsDisposed}async dispose(v){if(this.privIsDisposed=!0,this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose(v)}catch{return}}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}get recognitionMode(){return this.privRecognizerConfig.recognitionMode}async recognize(v,m,C){if(this.recognizeOverride!==void 0){await this.recognizeOverride(v,m,C);return}if(this.privConnectionConfigurationPromise=void 0,this.privRecognizerConfig.recognitionMode=v,this.privRecognizerConfig.recognitionEndpointVersion==="2"){const R=this.privSpeechContext.getContext().phraseDetection||{};R.mode=v,this.privSpeechContext.getContext().phraseDetection=R}this.setLanguageIdJson(),this.setTranslationJson(),this.privRecognizerConfig.autoDetectSourceLanguages!==void 0&&this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0)!==void 0&&this.setupTranslationWithLanguageId(),this.setSpeechSegmentationTimeoutJson(),this.setOutputDetailLevelJson(),this.privSuccessCallback=m,this.privErrorCallback=C,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privAudioSource.events);const y=this.connectImpl();let E;try{const R=await this.audioSource.attach(this.privRequestSession.audioNodeId),z=await this.audioSource.format,L=await this.audioSource.deviceInfo;this.privIsLiveAudio=L.type&&L.type===o.type.Microphones,E=new t.ReplayableAudioNode(R,z.avgBytesPerSec),await this.privRequestSession.onAudioSourceAttachCompleted(E,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:L}}catch(R){throw await this.privRequestSession.onStopRecognizing(),R}try{await y}catch(R){await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,R);return}const I=new r.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,I),this.receiveMessage(),this.sendAudio(E).catch(async R=>{await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,R)})}async stopRecognizing(){if(this.privRequestSession.isRecognizing)try{await this.audioSource.turnOff(),await this.sendFinalAudio(),await this.privRequestSession.onStopRecognizing(),await this.privRequestSession.turnCompletionPromise}finally{await this.privRequestSession.dispose()}}async connect(){return await this.connectImpl(),Promise.resolve()}connectAsync(v,m){this.connectImpl().then(()=>{try{v&&v()}catch(C){m&&m(C)}},C=>{try{m&&m(C)}catch{}})}async disconnect(){if(await this.cancelRecognitionLocal(r.CancellationReason.Error,r.CancellationErrorCode.NoError,"Disconnecting"),this.disconnectOverride!==void 0&&await this.disconnectOverride(),this.privConnectionPromise!==void 0)try{await(await this.privConnectionPromise).dispose()}catch{}this.privConnectionPromise=void 0}sendMessage(v){}async sendNetworkMessage(v,m){const C=typeof m=="string"?e.MessageType.Text:e.MessageType.Binary,y=typeof m=="string"?"application/json":"";return(await this.fetchConnection()).send(new p.SpeechConnectionMessage(C,v,this.privRequestSession.requestId,y,m))}set activityTemplate(v){this.privActivityTemplate=v}get activityTemplate(){return this.privActivityTemplate}set expectContentAssessmentResponse(v){this.privExpectContentAssessmentResponse=v}async sendTelemetryData(){const v=this.privRequestSession.getTelemetry();if(Ur.telemetryDataEnabled!==!0||this.privIsDisposed||v===null)return;if(Ur.telemetryData)try{Ur.telemetryData(v)}catch{}await(await this.fetchConnection()).send(new p.SpeechConnectionMessage(e.MessageType.Text,"telemetry",this.privRequestSession.requestId,"application/json",v))}async cancelRecognitionLocal(v,m,C){this.privRequestSession.isRecognizing&&(await this.privRequestSession.onStopRecognizing(),this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,v,m,C))}async receiveMessage(){try{if(this.privIsDisposed)return;let v=await this.fetchConnection();const m=await v.read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(!m)return this.receiveMessage();this.privServiceHasSentMessage=!0;const C=p.SpeechConnectionMessage.fromConnectionMessage(m);if(C.requestId.toLowerCase()===this.privRequestSession.requestId.toLowerCase())switch(C.path.toLowerCase()){case"turn.start":this.privMustReportEndOfStream=!0,this.privRequestSession.onServiceTurnStartResponse();break;case"speech.startdetected":const y=o.SpeechDetected.fromJSON(C.textBody,this.privRequestSession.currentTurnAudioOffset),E=new r.RecognitionEventArgs(y.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,E);break;case"speech.enddetected":let I;C.textBody.length>0?I=C.textBody:I="{ Offset: 0 }";const w=o.SpeechDetected.fromJSON(I,this.privRequestSession.currentTurnAudioOffset),R=new r.RecognitionEventArgs(w.Offset+this.privRequestSession.currentTurnAudioOffset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,R);break;case"turn.end":await this.sendTelemetryData(),this.privRequestSession.isSpeechEnded&&this.privMustReportEndOfStream&&(this.privMustReportEndOfStream=!1,await this.cancelRecognitionLocal(r.CancellationReason.EndOfStream,r.CancellationErrorCode.NoError,void 0));const z=new r.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition),!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing){this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,z);return}else v=await this.fetchConnection(),await this.sendPrePayloadJSON(v);break;default:await this.processTypeSpecificMessages(C)||this.privServiceEvents&&this.serviceEvents.onEvent(new e.ServiceEvent(C.path.toLowerCase(),C.textBody))}return this.receiveMessage()}catch{return null}}updateSpeakerDiarizationAudioOffset(){const v=this.privRequestSession.recognitionBytesSent,m=this.privAverageBytesPerMs!==0?v/this.privAverageBytesPerMs:0;this.privSpeechContext.setSpeakerDiarizationAudioOffsetMs(m)}sendSpeechContext(v,m){this.privEnableSpeakerId&&this.updateSpeakerDiarizationAudioOffset();const C=this.speechContext.toJSON();if(m&&this.privRequestSession.onSpeechContext(),C)return v.send(new p.SpeechConnectionMessage(e.MessageType.Text,"speech.context",this.privRequestSession.requestId,"application/json",C))}setupTranslationWithLanguageId(){const v=this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages,void 0),m=this.privRecognizerConfig.autoDetectSourceLanguages!==void 0;if(v!==void 0&&m){this.privSpeechContext.getContext().phraseOutput={interimResults:{resultType:h.ResultType.None},phraseResults:{resultType:l.PhraseResultOutputType.None}};const C=this.privSpeechContext.getContext().translation;if(C){const y=this.privRecognizerConfig.sourceLanguageModels;if(y!==void 0&&y.length>0){const I=this.privSpeechContext.getContext().phraseDetection||{};I.customModels=y,this.privSpeechContext.getContext().phraseDetection=I}this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0)!==void 0&&(C.onSuccess={action:i.NextAction.Synthesize},C.onPassthrough={action:i.NextAction.Synthesize})}}}noOp(){}async sendPrePayloadJSON(v,m=!0){if(this.sendPrePayloadJSONOverride!==void 0)return this.sendPrePayloadJSONOverride(v);await this.sendSpeechContext(v,m),await this.sendWaveHeader(v)}async sendWaveHeader(v){const m=await this.audioSource.format;return v.send(new p.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,"audio/x-wav",m.header))}connectImpl(){return this.privConnectionPromise!==void 0?this.privConnectionPromise.then(v=>v.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=void 0,this.privServiceHasSentMessage=!1,this.connectImpl())):(this.privConnectionPromise=this.retryableConnect(),this.privConnectionPromise.catch(()=>{}),this.postConnectImplOverride!==void 0?this.postConnectImplOverride(this.privConnectionPromise):this.privConnectionPromise)}sendSpeechServiceConfig(v,m,C){if(m.onSpeechContext(),Ur.telemetryDataEnabled!==!0){const E={context:{system:JSON.parse(C).context.system}};C=JSON.stringify(E)}if(this.privRecognizerConfig.parameters.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()==="true"){const y=JSON.parse(C);y.context.DisableReferenceChannel="True",y.context.MicSpec="1_0_0",C=JSON.stringify(y)}if(C)return v.send(new p.SpeechConnectionMessage(e.MessageType.Text,"speech.config",m.requestId,"application/json",C))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(v=>v.state()===e.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.privServiceHasSentMessage=!1,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async sendAudio(v){const m=await this.audioSource.format;this.privAverageBytesPerMs=m.avgBytesPerSec/1e3;let C=Date.now();const y=this.privRecognizerConfig.parameters.getProperty("SPEECH-TransmitLengthBeforThrottleMs","5000"),E=m.avgBytesPerSec/1e3*parseInt(y,10),I=this.privRequestSession.recogNumber,w=async()=>{if(!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===I){const R=await this.fetchConnection(),z=await v.read();if(this.privRequestSession.isSpeechEnded)return;let L,se;if(!z||z.isEnd?(L=null,se=0):(L=z.buffer,this.privRequestSession.onAudioSent(L.byteLength),E>=this.privRequestSession.bytesSent?se=0:se=Math.max(0,C-Date.now())),se!==0&&await this.delay(se),L!==null&&(C=Date.now()+L.byteLength*1e3/(m.avgBytesPerSec*2)),!this.privIsDisposed&&!this.privRequestSession.isSpeechEnded&&this.privRequestSession.isRecognizing&&this.privRequestSession.recogNumber===I)if(R.send(new p.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,L)).catch(()=>{this.privRequestSession.onServiceTurnEndResponse(this.privRecognizerConfig.isContinuousRecognition).catch(()=>{})}),z!=null&&z.isEnd)this.privIsLiveAudio||this.privRequestSession.onSpeechEnded();else return w()}};return w()}async retryableConnect(){let v=!1;this.privAuthFetchEventId=(0,e.createNoDashGuid)();const m=this.privRequestSession.sessionId;this.privConnectionId=m!==void 0?m:(0,e.createNoDashGuid)(),this.privRequestSession.onPreConnectionStart(this.privAuthFetchEventId,this.privConnectionId);let C=0,y="";for(;this.privRequestSession.numConnectionAttempts<=this.privRecognizerConfig.maxRetryCount;){this.privRequestSession.onRetryConnection();const I=await(v?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId));await this.privRequestSession.onAuthCompleted(!1);const w=await this.privConnectionFactory.create(this.privRecognizerConfig,I,this.privConnectionId);this.privRequestSession.listenForServiceTelemetry(w.events),w.events.attach(z=>{this.connectionEvents.onEvent(z)});const R=await w.open();if(R.statusCode===200)return await this.privRequestSession.onConnectionEstablishCompleted(R.statusCode),Promise.resolve(w);R.statusCode===1006&&(v=!0),C=R.statusCode,y=R.reason}return await this.privRequestSession.onConnectionEstablishCompleted(C,y),Promise.reject(`Unable to contact server. StatusCode: ${C}, ${this.privRecognizerConfig.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint)} Reason: ${y}`)}delay(v){return new Promise(m=>this.privSetTimeout(m,v))}writeBufferToConsole(v){let m="Buffer Size: ";if(v===null)m+="null";else{const C=new Uint8Array(v);m+=`${v.byteLength}\r
`;for(let y=0;y<v.byteLength;y++)m+=C[y].toString(16).padStart(2,"0")+" ",(y+1)%16===0&&(console.info(m),m="")}console.info(m)}async sendFinalAudio(){await(await this.fetchConnection()).send(new p.SpeechConnectionMessage(e.MessageType.Binary,"audio",this.privRequestSession.requestId,null,null))}async configureConnection(){const v=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(v):(await this.sendSpeechServiceConfig(v,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendPrePayloadJSON(v,!1),v)}};return hr.ServiceRecognizerBase=g,g.telemetryDataEnabled=!0,hr}var lr={},Ra;function Pf(){if(Ra)return lr;Ra=1,Object.defineProperty(lr,"__esModule",{value:!0}),lr.ConversationServiceRecognizer=void 0;const t=P(),e=T();let r=class extends e.ServiceRecognizerBase{constructor(p,a,n,i,s){super(p,a,n,i,s),this.handleSpeechPhraseMessage=async c=>this.handleSpeechPhrase(c),this.handleSpeechHypothesisMessage=c=>this.handleSpeechHypothesis(c)}processTypeSpecificMessages(p){}handleRecognizedCallback(p,a,n){}handleRecognizingCallback(p,a,n){}async processSpeechMessages(p){let a=!1;switch(p.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":this.handleSpeechHypothesisMessage&&this.handleSpeechHypothesisMessage(p.textBody),a=!0;break;case"speech.phrase":this.handleSpeechPhraseMessage&&await this.handleSpeechPhraseMessage(p.textBody),a=!0;break}return a}cancelRecognition(p,a,n,i,s){}async handleSpeechPhrase(p){const a=e.SimpleSpeechPhrase.fromJSON(p,this.privRequestSession.currentTurnAudioOffset),n=e.EnumTranslation.implTranslateRecognitionResult(a.RecognitionStatus);let i;const s=new t.PropertyCollection;if(s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p),this.privRequestSession.onPhraseRecognized(a.Offset+a.Duration),t.ResultReason.Canceled===n){const c=e.EnumTranslation.implTranslateCancelResult(a.RecognitionStatus),u=e.EnumTranslation.implTranslateCancelErrorCode(a.RecognitionStatus);await this.cancelRecognitionLocal(c,u,e.EnumTranslation.implTranslateErrorDetails(u))}else if(a.RecognitionStatus!==e.RecognitionStatus.EndOfDictation){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===t.OutputFormat[t.OutputFormat.Simple])i=new t.SpeechRecognitionResult(this.privRequestSession.requestId,n,a.DisplayText,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),s);else{const c=e.DetailedSpeechPhrase.fromJSON(p,this.privRequestSession.currentTurnAudioOffset);i=new t.SpeechRecognitionResult(this.privRequestSession.requestId,n,c.Text,c.Duration,c.Offset,c.Language,c.LanguageDetectionConfidence,c.SpeakerId,void 0,c.asJson(),s)}this.handleRecognizedCallback(i,i.offset,this.privRequestSession.sessionId)}}handleSpeechHypothesis(p){const a=e.SpeechHypothesis.fromJSON(p,this.privRequestSession.currentTurnAudioOffset),n=new t.PropertyCollection;n.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,p);const i=new t.SpeechRecognitionResult(this.privRequestSession.requestId,t.ResultReason.RecognizingSpeech,a.Text,a.Duration,a.Offset,a.Language,a.LanguageDetectionConfidence,a.SpeakerId,void 0,a.asJson(),n);this.privRequestSession.onHypothesis(a.Offset),this.handleRecognizingCallback(i,a.Duration,this.privRequestSession.sessionId)}};return lr.ConversationServiceRecognizer=r,lr}var $n={},Ea;function Rf(){return Ea||(Ea=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.RecognizerConfig=t.SpeechResultFormat=void 0;const e=P(),r=T(),o=ne;(function(a){a[a.Simple=0]="Simple",a[a.Detailed=1]="Detailed"})(t.SpeechResultFormat||(t.SpeechResultFormat={}));class p{constructor(n,i){this.privSpeechServiceConfig=n||new r.SpeechServiceConfig(new r.Context(null)),this.privParameters=i,this.privMaxRetryCount=parseInt(i.getProperty("SPEECH-Error-MaxRetryCount","4"),10),this.privLanguageIdMode=i.getProperty(e.PropertyId.SpeechServiceConnection_LanguageIdMode,void 0),this.privEnableSpeakerId=!1}get parameters(){return this.privParameters}get recognitionMode(){return this.privRecognitionMode}set recognitionMode(n){this.privRecognitionMode=n,this.privRecognitionActivityTimeout=n===o.RecognitionMode.Interactive?8e3:25e3,this.privSpeechServiceConfig.Recognition=o.RecognitionMode[n]}get SpeechServiceConfig(){return this.privSpeechServiceConfig}get recognitionActivityTimeout(){return this.privRecognitionActivityTimeout}get isContinuousRecognition(){return this.privRecognitionMode!==o.RecognitionMode.Interactive}get languageIdMode(){return this.privLanguageIdMode}get autoDetectSourceLanguages(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_AutoDetectSourceLanguages,void 0)}get recognitionEndpointVersion(){return this.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,"2")}set recognitionEndpointVersion(n){this.parameters.setProperty(e.PropertyId.SpeechServiceConnection_RecognitionEndpointVersion,n)}get sourceLanguageModels(){const n=[];let i=!1;if(this.autoDetectSourceLanguages!==void 0)for(const s of this.autoDetectSourceLanguages.split(",")){const c=s+e.PropertyId.SpeechServiceConnection_EndpointId.toString(),u=this.parameters.getProperty(c,void 0);u!==void 0?(n.push({language:s,endpoint:u}),i=!0):n.push({language:s,endpoint:""})}return i?n:void 0}get maxRetryCount(){return this.privMaxRetryCount}get isSpeakerDiarizationEnabled(){return this.privEnableSpeakerId}set isSpeakerDiarizationEnabled(n){this.privEnableSpeakerId=n}}t.RecognizerConfig=p}($n)),$n}var kp={};Object.defineProperty(kp,"__esModule",{value:!0});var pn={};Object.defineProperty(pn,"__esModule",{value:!0});pn.WebsocketMessageFormatter=void 0;const oe=A(),Ia=`\r
`;class Ef{toConnectionMessage(e){const r=new oe.Deferred;try{if(e.messageType===oe.MessageType.Text){const o=e.textContent;let p={},a=null;if(o){const n=o.split(`\r
\r
`);n&&n.length>0&&(p=this.parseHeaders(n[0]),n.length>1&&(a=n[1]))}r.resolve(new oe.ConnectionMessage(e.messageType,a,p,e.id))}else if(e.messageType===oe.MessageType.Binary){const o=e.binaryContent;let p={},a=null;if(!o||o.byteLength<2)throw new Error("Invalid binary message format. Header length missing.");const n=new DataView(o),i=n.getInt16(0);if(o.byteLength<i+2)throw new Error("Invalid binary message format. Header content missing.");let s="";for(let c=0;c<i;c++)s+=String.fromCharCode(n.getInt8(c+2));p=this.parseHeaders(s),o.byteLength>i+2&&(a=o.slice(2+i)),r.resolve(new oe.ConnectionMessage(e.messageType,a,p,e.id))}}catch(o){r.reject(`Error formatting the message. Error: ${o}`)}return r.promise}fromConnectionMessage(e){const r=new oe.Deferred;try{if(e.messageType===oe.MessageType.Text){const o=`${this.makeHeaders(e)}${Ia}${e.textBody?e.textBody:""}`;r.resolve(new oe.RawWebsocketMessage(oe.MessageType.Text,o,e.id))}else if(e.messageType===oe.MessageType.Binary){const o=this.makeHeaders(e),p=e.binaryBody,a=this.stringToArrayBuffer(o),n=new Int8Array(a),i=n.byteLength,s=new Int8Array(2+i+(p?p.byteLength:0));if(s[0]=i>>8&255,s[1]=i&255,s.set(n,2),p){const u=new Int8Array(p);s.set(u,2+i)}const c=s.buffer;r.resolve(new oe.RawWebsocketMessage(oe.MessageType.Binary,c,e.id))}}catch(o){r.reject(`Error formatting the message. ${o}`)}return r.promise}makeHeaders(e){let r="";if(e.headers)for(const o in e.headers)o&&(r+=`${o}: ${e.headers[o]}${Ia}`);return r}parseHeaders(e){const r={};if(e){const o=e.match(/[^\r\n]+/g);if(r){for(const p of o)if(p){const a=p.indexOf(":"),n=a>0?p.substr(0,a).trim().toLowerCase():p,i=a>0&&p.length>a+1?p.substr(a+1).trim():"";r[n]=i}}}return r}stringToArrayBuffer(e){const r=new ArrayBuffer(e.length),o=new DataView(r);for(let p=0;p<e.length;p++)o.setUint8(p,e.charCodeAt(p));return r}}pn.WebsocketMessageFormatter=Ef;var vr={},Ta;function If(){if(Ta)return vr;Ta=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.SpeechConnectionFactory=void 0;const t=x(),e=T(),r=P(),o=ue(),p=T(),a=F,n=pe,i=ne;let s=class extends o.ConnectionFactoryBase{constructor(){super(...arguments),this.interactiveRelativeUri="/speech/recognition/interactive/cognitiveservices/v1",this.conversationRelativeUri="/speech/recognition/conversation/cognitiveservices/v1",this.dictationRelativeUri="/speech/recognition/dictation/cognitiveservices/v1",this.universalUri="/stt/speech/universal/v"}async create(u,d,h){let l=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);const f=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region,void 0),g=o.ConnectionFactoryBase.getHostSuffix(f),S=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://"+f+".stt.speech"+g),v={},m=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_EndpointId,void 0),C=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(m?(!l||l.search(n.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(v[n.QueryParameterNames.CustomSpeechDeploymentId]=m):C&&(!l||l.search(n.QueryParameterNames.Language)===-1)&&(v[n.QueryParameterNames.Language]=C),(!l||l.search(n.QueryParameterNames.Format)===-1)&&(v[n.QueryParameterNames.Format]=u.parameters.getProperty(e.OutputFormatPropertyName,r.OutputFormat[r.OutputFormat.Simple]).toLowerCase()),u.autoDetectSourceLanguages!==void 0&&(v[n.QueryParameterNames.EnableLanguageId]="true"),this.setCommonUrlParams(u,v,l),l){const R=new URL(l),z=R.pathname;(z===""||z==="/")&&(R.pathname=this.universalUri+u.recognitionEndpointVersion,l=await o.ConnectionFactoryBase.getRedirectUrlFromEndpoint(R.toString()))}if(!l)switch(u.recognitionMode){case i.RecognitionMode.Conversation:u.parameters.getProperty(e.ForceDictationPropertyName,"false")==="true"?l=S+this.dictationRelativeUri:u.recognitionEndpointVersion!==void 0&&parseInt(u.recognitionEndpointVersion,10)>1?l=`${S}${this.universalUri}${u.recognitionEndpointVersion}`:l=S+this.conversationRelativeUri;break;case i.RecognitionMode.Dictation:l=S+this.dictationRelativeUri;break;default:u.recognitionEndpointVersion!==void 0&&parseInt(u.recognitionEndpointVersion,10)>1?l=`${S}${this.universalUri}${u.recognitionEndpointVersion}`:l=S+this.interactiveRelativeUri;break}const y={};d.token!==void 0&&d.token!==""&&(y[d.headerName]=d.token),y[a.HeaderNames.ConnectionId]=h,y.connectionId=h;const E=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",I=new t.WebsocketConnection(l,v,y,new p.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(u),E,h),w=I.uri;return u.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,w),I}};return vr.SpeechConnectionFactory=s,vr}var fr={},Aa;function Tf(){if(Aa)return fr;Aa=1,Object.defineProperty(fr,"__esModule",{value:!0}),fr.ConversationTranscriberConnectionFactory=void 0;const t=x(),e=P(),r=T(),o=ue(),p=T(),a=F,n=pe;let i=class extends o.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2"}async create(c,u,d){let h=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const l=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,void 0),f=o.ConnectionFactoryBase.getHostSuffix(l),g=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,"wss://"+l+".stt.speech"+f),S={},v=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),m=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);if(v?(!h||h.search(n.QueryParameterNames.CustomSpeechDeploymentId)===-1)&&(S[n.QueryParameterNames.CustomSpeechDeploymentId]=v):m&&(!h||h.search(n.QueryParameterNames.Language)===-1)&&(S[n.QueryParameterNames.Language]=m),c.autoDetectSourceLanguages!==void 0&&(S[n.QueryParameterNames.EnableLanguageId]="true"),this.setV2UrlParams(c,S,h),h){const w=new URL(h),R=w.pathname;(R===""||R==="/")&&(w.pathname=this.universalUri,h=await o.ConnectionFactoryBase.getRedirectUrlFromEndpoint(w.toString()))}h||(h=`${g}${this.universalUri}`);const C={};u.token!==void 0&&u.token!==""&&(C[u.headerName]=u.token),C[a.HeaderNames.ConnectionId]=d;const y=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true",E=new t.WebsocketConnection(h,S,C,new p.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(c),y,d),I=E.uri;return c.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,I),E}setV2UrlParams(c,u,d){new Map([[e.PropertyId.Speech_SegmentationSilenceTimeoutMs,n.QueryParameterNames.SegmentationSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_EnableAudioLogging,n.QueryParameterNames.EnableAudioLogging],[e.PropertyId.SpeechServiceConnection_EndSilenceTimeoutMs,n.QueryParameterNames.EndSilenceTimeoutMs],[e.PropertyId.SpeechServiceConnection_InitialSilenceTimeoutMs,n.QueryParameterNames.InitialSilenceTimeoutMs],[e.PropertyId.SpeechServiceResponse_PostProcessingOption,n.QueryParameterNames.Postprocessing],[e.PropertyId.SpeechServiceResponse_ProfanityOption,n.QueryParameterNames.Profanity],[e.PropertyId.SpeechServiceResponse_StablePartialResultThreshold,n.QueryParameterNames.StableIntermediateThreshold]]).forEach((f,g)=>{this.setUrlParameter(g,f,c,u,d)});const l=JSON.parse(c.parameters.getProperty(r.ServicePropertiesPropertyName,"{}"));Object.keys(l).forEach(f=>{u[f]=l[f]})}};return fr.ConversationTranscriberConnectionFactory=i,fr}var gr={},wa;function Af(){if(wa)return gr;wa=1,Object.defineProperty(gr,"__esModule",{value:!0}),gr.TranscriberConnectionFactory=void 0;const t=x(),e=P(),r=ue(),o=T(),p=F,a=pe;let n=class extends r.ConnectionFactoryBase{constructor(){super(...arguments),this.multiaudioRelativeUri="/speech/recognition/multiaudio"}create(s,c,u){let d=s.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);const h=s.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"centralus"),l=r.ConnectionFactoryBase.getHostSuffix(h),f="wss://transcribe."+h+".cts.speech"+l+this.multiaudioRelativeUri,g=s.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,f),S={};this.setQueryParams(S,s,d),d||(d=g);const v={};c.token!==void 0&&c.token!==""&&(v[c.headerName]=c.token),v[p.HeaderNames.ConnectionId]=u,s.parameters.setProperty(e.PropertyId.SpeechServiceConnection_Url,d);const m=s.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new t.WebsocketConnection(d,S,v,new o.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(s),m,u))}setQueryParams(s,c,u){const d=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_EndpointId,void 0),h=c.parameters.getProperty(e.PropertyId.SpeechServiceConnection_RecoLanguage,void 0);d&&!(a.QueryParameterNames.CustomSpeechDeploymentId in s)&&(s[a.QueryParameterNames.CustomSpeechDeploymentId]=d),h&&!(a.QueryParameterNames.Language in s)&&(s[a.QueryParameterNames.Language]=h);const l=c.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps,"false").toLowerCase()==="true",f=c.parameters.getProperty(o.OutputFormatPropertyName,e.OutputFormat[e.OutputFormat.Simple])!==e.OutputFormat[e.OutputFormat.Simple];(l||f)&&(s[a.QueryParameterNames.Format]=e.OutputFormat[e.OutputFormat.Detailed].toLowerCase()),this.setCommonUrlParams(c,s,u)}};return gr.TranscriberConnectionFactory=n,gr}var mr={},_a;function wf(){if(_a)return mr;_a=1,Object.defineProperty(mr,"__esModule",{value:!0}),mr.TranslationConnectionFactory=void 0;const t=x(),e=ri,r=P(),o=ue(),p=T(),a=F,n=pe,i=ne;let s=class extends o.ConnectionFactoryBase{constructor(){super(...arguments),this.universalUri="/stt/speech/universal/v2",this.translationV1Uri="/speech/translation/cognitiveservices/v1"}async create(u,d,h){let l=this.getEndpointUrl(u);const f={};if(this.setQueryParams(f,u,l),l){const m=new URL(l),C=m.pathname;(C===""||C==="/")&&(m.pathname=this.universalUri,l=await o.ConnectionFactoryBase.getRedirectUrlFromEndpoint(m.toString()))}const g={};d.token!==void 0&&d.token!==""&&(g[d.headerName]=d.token),g[a.HeaderNames.ConnectionId]=h,u.parameters.setProperty(r.PropertyId.SpeechServiceConnection_Url,l);const S=u.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return new t.WebsocketConnection(l,f,g,new p.WebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(u),S,h)}getEndpointUrl(u,d){const h=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Region),l=o.ConnectionFactoryBase.getHostSuffix(h);let f=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Endpoint,void 0);return f?d===!0?f:e.StringUtils.formatString(f,{region:h}):(u.parameters.getProperty("SPEECH-ForceV1Endpoint","false")==="true"?f=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.s2s.speech"+l)+this.translationV1Uri:f=u.parameters.getProperty(r.PropertyId.SpeechServiceConnection_Host,"wss://{region}.stt.speech"+l)+this.universalUri,d===!0?f:e.StringUtils.formatString(f,{region:h}))}setQueryParams(u,d,h){u.from=d.parameters.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage),u.to=d.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationToLanguages),u.scenario=d.recognitionMode===i.RecognitionMode.Interactive?"interactive":d.recognitionMode===i.RecognitionMode.Conversation?"conversation":"",this.setCommonUrlParams(d,u,h),this.setUrlParameter(r.PropertyId.SpeechServiceResponse_TranslationRequestStablePartialResult,n.QueryParameterNames.StableTranslation,d,u,h);const l=d.parameters.getProperty(r.PropertyId.SpeechServiceConnection_TranslationVoice,void 0);l!==void 0&&(u.voice=l,u.features="requireVoice")}};return mr.TranslationConnectionFactory=s,mr}var Sr={},ba;function _f(){if(ba)return Sr;ba=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.EnumTranslation=void 0;const t=P(),e=T();let r=class{static implTranslateRecognitionResult(p,a=!1){let n=t.ResultReason.Canceled;switch(p){case e.RecognitionStatus.Success:n=t.ResultReason.RecognizedSpeech;break;case e.RecognitionStatus.EndOfDictation:n=a?t.ResultReason.RecognizedSpeech:t.ResultReason.NoMatch;break;case e.RecognitionStatus.NoMatch:case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:n=t.ResultReason.NoMatch;break;case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:n=t.ResultReason.Canceled;break}return n}static implTranslateCancelResult(p){let a=t.CancellationReason.EndOfStream;switch(p){case e.RecognitionStatus.Success:case e.RecognitionStatus.EndOfDictation:case e.RecognitionStatus.NoMatch:a=t.CancellationReason.EndOfStream;break;case e.RecognitionStatus.InitialSilenceTimeout:case e.RecognitionStatus.BabbleTimeout:case e.RecognitionStatus.Error:case e.RecognitionStatus.BadRequest:case e.RecognitionStatus.Forbidden:default:a=t.CancellationReason.Error;break}return a}static implTranslateCancelErrorCode(p){let a=t.CancellationErrorCode.NoError;switch(p){case e.RecognitionStatus.Error:a=t.CancellationErrorCode.ServiceError;break;case e.RecognitionStatus.TooManyRequests:a=t.CancellationErrorCode.TooManyRequests;break;case e.RecognitionStatus.BadRequest:a=t.CancellationErrorCode.BadRequestParameters;break;case e.RecognitionStatus.Forbidden:a=t.CancellationErrorCode.Forbidden;break;default:a=t.CancellationErrorCode.NoError;break}return a}static implTranslateErrorDetails(p){let a="The speech service encountered an internal error and could not continue.";switch(p){case t.CancellationErrorCode.Forbidden:a="The recognizer is using a free subscription that ran out of quota.";break;case t.CancellationErrorCode.BadRequestParameters:a="Invalid parameter or unsupported audio format in the request.";break;case t.CancellationErrorCode.TooManyRequests:a="The number of parallel requests exceeded the number of allowed concurrent transcriptions.";break}return a}};return Sr.EnumTranslation=r,Sr}var Np={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.RecognitionStatus=t.SynthesisStatus=void 0,function(e){e[e.Success=0]="Success",e[e.SynthesisEnd=1]="SynthesisEnd",e[e.Error=2]="Error"}(t.SynthesisStatus||(t.SynthesisStatus={})),function(e){e[e.Success=0]="Success",e[e.NoMatch=1]="NoMatch",e[e.InitialSilenceTimeout=2]="InitialSilenceTimeout",e[e.BabbleTimeout=3]="BabbleTimeout",e[e.Error=4]="Error",e[e.EndOfDictation=5]="EndOfDictation",e[e.TooManyRequests=6]="TooManyRequests",e[e.BadRequest=7]="BadRequest",e[e.Forbidden=8]="Forbidden"}(t.RecognitionStatus||(t.RecognitionStatus={}))})(Np);var Cr={},Ma;function bf(){if(Ma)return Cr;Ma=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.TranslationSynthesisEnd=void 0;const t=T();let e=class zp{constructor(o){this.privSynthesisEnd=JSON.parse(o),this.privSynthesisEnd.SynthesisStatus&&(this.privSynthesisEnd.SynthesisStatus=t.SynthesisStatus[this.privSynthesisEnd.SynthesisStatus]),this.privSynthesisEnd.Status&&(this.privSynthesisEnd.SynthesisStatus=t.SynthesisStatus[this.privSynthesisEnd.Status])}static fromJSON(o){return new zp(o)}get SynthesisStatus(){return this.privSynthesisEnd.SynthesisStatus}get FailureReason(){return this.privSynthesisEnd.FailureReason}};return Cr.TranslationSynthesisEnd=e,Cr}var un={};Object.defineProperty(un,"__esModule",{value:!0});un.TranslationHypothesis=void 0;const Mf=b,Oa=Oi;class di{constructor(e,r){this.privTranslationHypothesis=e,this.privTranslationHypothesis.Offset+=r,this.privTranslationHypothesis.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationHypothesis.Translation.TranslationStatus)}static fromJSON(e,r){return new di(JSON.parse(e),r)}static fromTranslationResponse(e,r){Mf.Contracts.throwIfNullOrUndefined(e,"translationHypothesis");const o=e.SpeechHypothesis;return e.SpeechHypothesis=void 0,o.Translation=e,new di(o,r)}get Duration(){return this.privTranslationHypothesis.Duration}get Offset(){return this.privTranslationHypothesis.Offset}get Text(){return this.privTranslationHypothesis.Text}get Translation(){return this.privTranslationHypothesis.Translation}get Language(){var e;return(e=this.privTranslationHypothesis.PrimaryLanguage)==null?void 0:e.Language}asJson(){const e={...this.privTranslationHypothesis};return e.Translation!==void 0?JSON.stringify({...e,TranslationStatus:Oa.TranslationStatus[e.Translation.TranslationStatus]}):JSON.stringify(e)}mapTranslationStatus(e){if(typeof e=="string")return Oa.TranslationStatus[e];if(typeof e=="number")return e}}un.TranslationHypothesis=di;var yr={},Da;function Of(){if(Da)return yr;Da=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.TranslationPhrase=void 0;const t=b,e=T(),r=Oi;let o=class es{constructor(a,n){this.privTranslationPhrase=a,this.privTranslationPhrase.Offset+=n,this.privTranslationPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privTranslationPhrase.RecognitionStatus),this.privTranslationPhrase.Translation!==void 0&&(this.privTranslationPhrase.Translation.TranslationStatus=this.mapTranslationStatus(this.privTranslationPhrase.Translation.TranslationStatus))}static fromJSON(a,n){return new es(JSON.parse(a),n)}static fromTranslationResponse(a,n){t.Contracts.throwIfNullOrUndefined(a,"translationResponse");const i=a.SpeechPhrase;return a.SpeechPhrase=void 0,i.Translation=a,i.Text=i.DisplayText,new es(i,n)}get RecognitionStatus(){return this.privTranslationPhrase.RecognitionStatus}get Offset(){return this.privTranslationPhrase.Offset}get Duration(){return this.privTranslationPhrase.Duration}get Text(){return this.privTranslationPhrase.Text}get Language(){var a;return(a=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:a.Language}get Confidence(){var a;return(a=this.privTranslationPhrase.PrimaryLanguage)==null?void 0:a.Confidence}get Translation(){return this.privTranslationPhrase.Translation}asJson(){const a={...this.privTranslationPhrase},n={...a,RecognitionStatus:e.RecognitionStatus[a.RecognitionStatus]};return a.Translation&&(n.Translation={...a.Translation,TranslationStatus:r.TranslationStatus[a.Translation.TranslationStatus]}),JSON.stringify(n)}mapRecognitionStatus(a){if(typeof a=="string")return e.RecognitionStatus[a];if(typeof a=="number")return a}mapTranslationStatus(a){if(typeof a=="string")return r.TranslationStatus[a];if(typeof a=="number")return a}};return yr.TranslationPhrase=o,yr}var Pr={},ka;function Df(){if(ka)return Pr;ka=1,Object.defineProperty(Pr,"__esModule",{value:!0}),Pr.TranslationServiceRecognizer=void 0;const t=A(),e=P(),r=T();let o=class extends r.ConversationServiceRecognizer{constructor(a,n,i,s,c){super(a,n,i,s,c),this.privTranslationRecognizer=c,this.connectionEvents.attach(u=>{u.name==="ConnectionEstablishedEvent"&&this.privTranslationRecognizer.onConnection()})}async processTypeSpecificMessages(a){const n=new e.PropertyCollection;let i=await this.processSpeechMessages(a);if(i)return!0;const s=async u=>{if(n.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,u.asJson()),this.privRequestSession.onPhraseRecognized(u.Offset+u.Duration),u.RecognitionStatus===r.RecognitionStatus.Success){const d=this.fireEventForResult(u,n);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,d)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(d.result)}catch(h){this.privErrorCallback&&this.privErrorCallback(h)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}else{const d=r.EnumTranslation.implTranslateRecognitionResult(u.RecognitionStatus),h=new e.TranslationRecognitionResult(void 0,this.privRequestSession.requestId,d,u.Text,u.Duration,u.Offset,u.Language,u.Confidence,void 0,u.asJson(),n);if(d===e.ResultReason.Canceled){const l=r.EnumTranslation.implTranslateCancelResult(u.RecognitionStatus),f=r.EnumTranslation.implTranslateCancelErrorCode(u.RecognitionStatus);await this.cancelRecognitionLocal(l,f,r.EnumTranslation.implTranslateErrorDetails(f))}else if(u.RecognitionStatus!==r.RecognitionStatus.EndOfDictation){const l=new e.TranslationRecognitionEventArgs(h,h.offset,this.privRequestSession.sessionId);if(this.privTranslationRecognizer.recognized)try{this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,l)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(h)}catch(f){this.privErrorCallback&&this.privErrorCallback(f)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}i=!0}},c=u=>{n.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,u.asJson());const d=this.fireEventForResult(u,n);if(this.privRequestSession.onHypothesis(d.offset),this.privTranslationRecognizer.recognizing)try{this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,d)}catch{}i=!0};switch(a.messageType===t.MessageType.Text&&n.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"translation.hypothesis":c(r.TranslationHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.response":const u=JSON.parse(a.textBody);if(u.SpeechPhrase)await s(r.TranslationPhrase.fromTranslationResponse(u,this.privRequestSession.currentTurnAudioOffset));else{const h=JSON.parse(a.textBody);h.SpeechHypothesis&&c(r.TranslationHypothesis.fromTranslationResponse(h,this.privRequestSession.currentTurnAudioOffset))}break;case"translation.phrase":await s(r.TranslationPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset));break;case"translation.synthesis":case"audio":this.sendSynthesisAudio(a.binaryBody,this.privRequestSession.sessionId),i=!0;break;case"audio.end":case"translation.synthesis.end":const d=r.TranslationSynthesisEnd.fromJSON(a.textBody);switch(d.SynthesisStatus){case r.SynthesisStatus.Error:if(this.privTranslationRecognizer.synthesizing){const h=new e.TranslationSynthesisResult(e.ResultReason.Canceled,void 0),l=new e.TranslationSynthesisEventArgs(h,this.privRequestSession.sessionId);try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,l)}catch{}}if(this.privTranslationRecognizer.canceled){const h=new e.TranslationRecognitionCanceledEventArgs(this.privRequestSession.sessionId,e.CancellationReason.Error,d.FailureReason,e.CancellationErrorCode.ServiceError,null);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,h)}catch{}}break;case r.SynthesisStatus.Success:this.sendSynthesisAudio(void 0,this.privRequestSession.sessionId);break}i=!0;break}return i}cancelRecognition(a,n,i,s,c){const u=new e.PropertyCollection;if(u.setProperty(r.CancellationErrorCodePropertyName,e.CancellationErrorCode[s]),this.privTranslationRecognizer.canceled){const d=new e.TranslationRecognitionCanceledEventArgs(a,i,c,s,void 0);try{this.privTranslationRecognizer.canceled(this.privTranslationRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new e.TranslationRecognitionResult(void 0,n,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,u);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}handleRecognizingCallback(a,n,i){try{const s=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(a),n,i);this.privTranslationRecognizer.recognizing(this.privTranslationRecognizer,s)}catch{}}handleRecognizedCallback(a,n,i){try{const s=new e.TranslationRecognitionEventArgs(e.TranslationRecognitionResult.fromSpeechRecognitionResult(a),n,i);this.privTranslationRecognizer.recognized(this.privTranslationRecognizer,s)}catch{}}fireEventForResult(a,n){let i;if(a.Translation.Translations!==void 0){i=new e.Translations;for(const l of a.Translation.Translations)i.set(l.Language,l.Text||l.DisplayText)}let s,c;a instanceof r.TranslationPhrase?(a.Translation&&a.Translation.TranslationStatus===t.TranslationStatus.Success?s=e.ResultReason.TranslatedSpeech:s=e.ResultReason.RecognizedSpeech,c=a.Confidence):s=e.ResultReason.TranslatingSpeech;const u=a.Language,d=new e.TranslationRecognitionResult(i,this.privRequestSession.requestId,s,a.Text,a.Duration,a.Offset,u,c,a.Translation.FailureReason,a.asJson(),n);return new e.TranslationRecognitionEventArgs(d,a.Offset,this.privRequestSession.sessionId)}sendSynthesisAudio(a,n){const i=a===void 0?e.ResultReason.SynthesizingAudioCompleted:e.ResultReason.SynthesizingAudio,s=new e.TranslationSynthesisResult(i,a),c=new e.TranslationSynthesisEventArgs(s,n);if(this.privTranslationRecognizer.synthesizing)try{this.privTranslationRecognizer.synthesizing(this.privTranslationRecognizer,c)}catch{}}};return Pr.TranslationServiceRecognizer=o,Pr}var dn={};Object.defineProperty(dn,"__esModule",{value:!0});dn.SpeechDetected=void 0;class Cs{constructor(e,r){this.privSpeechStartDetected=JSON.parse(e),this.privSpeechStartDetected.Offset+=r}static fromJSON(e,r){return new Cs(e,r)}get Offset(){return this.privSpeechStartDetected.Offset}}dn.SpeechDetected=Cs;var hn={};Object.defineProperty(hn,"__esModule",{value:!0});hn.SpeechHypothesis=void 0;class ys{constructor(e,r){this.privSpeechHypothesis=JSON.parse(e),this.updateOffset(r)}static fromJSON(e,r){return new ys(e,r)}updateOffset(e){this.privSpeechHypothesis.Offset+=e}asJson(){return JSON.stringify(this.privSpeechHypothesis)}get Text(){return this.privSpeechHypothesis.Text}get Offset(){return this.privSpeechHypothesis.Offset}get Duration(){return this.privSpeechHypothesis.Duration}get Language(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSpeechHypothesis.PrimaryLanguage===void 0?void 0:this.privSpeechHypothesis.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSpeechHypothesis.SpeakerId}}hn.SpeechHypothesis=ys;var ln={};Object.defineProperty(ln,"__esModule",{value:!0});ln.SpeechKeyword=void 0;class Ps{constructor(e,r){this.privSpeechKeyword=JSON.parse(e),this.privSpeechKeyword.Offset+=r}static fromJSON(e,r){return new Ps(e,r)}get Status(){return this.privSpeechKeyword.Status}get Text(){return this.privSpeechKeyword.Text}get Offset(){return this.privSpeechKeyword.Offset}get Duration(){return this.privSpeechKeyword.Duration}asJson(){return JSON.stringify(this.privSpeechKeyword)}}ln.SpeechKeyword=Ps;var Rr={},Na;function kf(){if(Na)return Rr;Na=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.SpeechServiceRecognizer=void 0;const t=P(),e=T();let r=class extends e.ServiceRecognizerBase{constructor(p,a,n,i,s){super(p,a,n,i,s),this.privSpeechRecognizer=s}async processTypeSpecificMessages(p){let a;const n=new t.PropertyCollection;let i=!1;switch(p.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const s=e.SpeechHypothesis.fromJSON(p.textBody,this.privRequestSession.currentTurnAudioOffset);n.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,s.asJson()),a=new t.SpeechRecognitionResult(this.privRequestSession.requestId,t.ResultReason.RecognizingSpeech,s.Text,s.Duration,s.Offset,s.Language,s.LanguageDetectionConfidence,void 0,void 0,s.asJson(),n),this.privRequestSession.onHypothesis(s.Offset);const c=new t.SpeechRecognitionEventArgs(a,s.Offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognizing)try{this.privSpeechRecognizer.recognizing(this.privSpeechRecognizer,c)}catch{}i=!0;break;case"speech.phrase":const u=e.SimpleSpeechPhrase.fromJSON(p.textBody,this.privRequestSession.currentTurnAudioOffset);n.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,u.asJson());const d=e.EnumTranslation.implTranslateRecognitionResult(u.RecognitionStatus,this.privExpectContentAssessmentResponse);if(this.privRequestSession.onPhraseRecognized(u.Offset+u.Duration),t.ResultReason.Canceled===d){const h=e.EnumTranslation.implTranslateCancelResult(u.RecognitionStatus),l=e.EnumTranslation.implTranslateCancelErrorCode(u.RecognitionStatus);await this.cancelRecognitionLocal(h,l,e.EnumTranslation.implTranslateErrorDetails(l))}else{if(u.RecognitionStatus===e.RecognitionStatus.EndOfDictation)break;if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===t.OutputFormat[t.OutputFormat.Simple])a=new t.SpeechRecognitionResult(this.privRequestSession.requestId,d,u.DisplayText,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,void 0,void 0,u.asJson(),n);else{const l=e.DetailedSpeechPhrase.fromJSON(p.textBody,this.privRequestSession.currentTurnAudioOffset);n.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,l.asJson()),a=new t.SpeechRecognitionResult(this.privRequestSession.requestId,d,l.RecognitionStatus===e.RecognitionStatus.Success?l.NBest[0].Display:"",l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),n)}const h=new t.SpeechRecognitionEventArgs(a,a.offset,this.privRequestSession.sessionId);if(this.privSpeechRecognizer.recognized)try{this.privSpeechRecognizer.recognized(this.privSpeechRecognizer,h)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(a)}catch(l){this.privErrorCallback&&this.privErrorCallback(l)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}i=!0;break}return i}cancelRecognition(p,a,n,i,s){const c=new t.PropertyCollection;if(c.setProperty(e.CancellationErrorCodePropertyName,t.CancellationErrorCode[i]),this.privSpeechRecognizer.canceled){const u=new t.SpeechRecognitionCanceledEventArgs(n,s,i,void 0,p);try{this.privSpeechRecognizer.canceled(this.privSpeechRecognizer,u)}catch{}}if(this.privSuccessCallback){const u=new t.SpeechRecognitionResult(a,t.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,s,void 0,c);try{this.privSuccessCallback(u),this.privSuccessCallback=void 0}catch{}}}};return Rr.SpeechServiceRecognizer=r,Rr}var Er={},jp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.IdentityProvider=t.SpeakerDiarizationMode=void 0,function(e){e.None="None",e.Identity="Identity",e.Anonymous="Anonymous"}(t.SpeakerDiarizationMode||(t.SpeakerDiarizationMode={})),function(e){e.CallCenter="CallCenter"}(t.IdentityProvider||(t.IdentityProvider={}))})(jp);var za;function Nf(){if(za)return Er;za=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.ConversationTranscriptionServiceRecognizer=void 0;const t=P(),e=T(),r=jp,o=ne;let p=class extends e.ServiceRecognizerBase{constructor(n,i,s,c,u){super(n,i,s,c,u),this.privConversationTranscriber=u,this.setSpeakerDiarizationJson()}setSpeakerDiarizationJson(){if(this.privEnableSpeakerId){const n=this.privSpeechContext.getContext().phraseDetection||{};n.mode=o.RecognitionMode.Conversation;const i={};i.mode=r.SpeakerDiarizationMode.Anonymous,i.audioSessionId=this.privDiarizationSessionId,i.audioOffsetMs=0,i.diarizeIntermediates=this.privRecognizerConfig.parameters.getProperty(t.PropertyId.SpeechServiceResponse_DiarizeIntermediateResults,"false")==="true",n.speakerDiarization=i,this.privSpeechContext.getContext().phraseDetection=n}}async processTypeSpecificMessages(n){let i;const s=new t.PropertyCollection;s.setProperty(t.PropertyId.SpeechServiceResponse_JsonResult,n.textBody);let c=!1;switch(n.path.toLowerCase()){case"speech.hypothesis":case"speech.fragment":const u=e.SpeechHypothesis.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);i=new t.ConversationTranscriptionResult(this.privRequestSession.requestId,t.ResultReason.RecognizingSpeech,u.Text,u.Duration,u.Offset,u.Language,u.LanguageDetectionConfidence,u.SpeakerId,void 0,u.asJson(),s),this.privRequestSession.onHypothesis(u.Offset);const d=new t.ConversationTranscriptionEventArgs(i,u.Duration,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribing)try{this.privConversationTranscriber.transcribing(this.privConversationTranscriber,d)}catch{}c=!0;break;case"speech.phrase":const h=e.SimpleSpeechPhrase.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset),l=e.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus);if(this.privRequestSession.onPhraseRecognized(h.Offset+h.Duration),t.ResultReason.Canceled===l){const f=e.EnumTranslation.implTranslateCancelResult(h.RecognitionStatus),g=e.EnumTranslation.implTranslateCancelErrorCode(h.RecognitionStatus);await this.cancelRecognitionLocal(f,g,e.EnumTranslation.implTranslateErrorDetails(g))}else if(!(this.privRequestSession.isSpeechEnded&&l===t.ResultReason.NoMatch&&h.RecognitionStatus!==e.RecognitionStatus.InitialSilenceTimeout)){if(this.privRecognizerConfig.parameters.getProperty(e.OutputFormatPropertyName)===t.OutputFormat[t.OutputFormat.Simple])i=new t.ConversationTranscriptionResult(this.privRequestSession.requestId,l,h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,h.SpeakerId,void 0,h.asJson(),s);else{const g=e.DetailedSpeechPhrase.fromJSON(n.textBody,this.privRequestSession.currentTurnAudioOffset);i=new t.ConversationTranscriptionResult(this.privRequestSession.requestId,l,g.RecognitionStatus===e.RecognitionStatus.Success?g.NBest[0].Display:void 0,g.Duration,g.Offset,g.Language,g.LanguageDetectionConfidence,h.SpeakerId,void 0,g.asJson(),s)}const f=new t.ConversationTranscriptionEventArgs(i,i.offset,this.privRequestSession.sessionId);if(this.privConversationTranscriber.transcribed)try{this.privConversationTranscriber.transcribed(this.privConversationTranscriber,f)}catch{}}c=!0;break}return c}cancelRecognition(n,i,s,c,u){if(new t.PropertyCollection().setProperty(e.CancellationErrorCodePropertyName,t.CancellationErrorCode[c]),this.privConversationTranscriber.canceled){const h=new t.ConversationTranscriptionCanceledEventArgs(s,u,c,void 0,n);try{this.privConversationTranscriber.canceled(this.privConversationTranscriber,h)}catch{}}}};return Er.ConversationTranscriptionServiceRecognizer=p,Er}var Ir={},ja;function zf(){if(ja)return Ir;ja=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.TranscriptionServiceRecognizer=void 0;const t=A(),e=P(),r=T(),o=Se;let p=class extends r.ConversationServiceRecognizer{constructor(n,i,s,c,u){super(n,i,s,c,u),this.privTranscriberRecognizer=u,this.sendPrePayloadJSONOverride=d=>this.sendTranscriptionStartJSON(d),this.privRecognizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceResponse_RequestWordLevelTimestamps)==="true"&&this.privSpeechContext.setWordLevelTimings()}async sendSpeechEventAsync(n,i){if(this.privRequestSession.isRecognizing){const s=await this.fetchConnection();await this.sendSpeechEvent(s,this.createSpeechEventPayload(n,i))}}async sendMeetingSpeechEventAsync(n,i){if(this.privRequestSession.isRecognizing){const s=await this.fetchConnection();await this.sendSpeechEvent(s,this.createMeetingSpeechEventPayload(n,i))}}processTypeSpecificMessages(n){return this.processSpeechMessages(n)}handleRecognizedCallback(n,i,s){try{const c=new e.SpeechRecognitionEventArgs(n,i,s);if(this.privTranscriberRecognizer.recognized(this.privTranscriberRecognizer,c),this.privSuccessCallback){try{this.privSuccessCallback(n)}catch(u){this.privErrorCallback&&this.privErrorCallback(u)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}catch{}}handleRecognizingCallback(n,i,s){try{const c=new e.SpeechRecognitionEventArgs(n,i,s);this.privTranscriberRecognizer.recognizing(this.privTranscriberRecognizer,c)}catch{}}cancelRecognition(n,i,s,c,u){const d=new e.PropertyCollection;if(d.setProperty(r.CancellationErrorCodePropertyName,e.CancellationErrorCode[c]),this.privTranscriberRecognizer.IsMeetingRecognizer()){if(this.privTranscriberRecognizer.canceled){const h=new e.MeetingTranscriptionCanceledEventArgs(s,u,c,void 0,n);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,h)}catch{}}}else if(this.privTranscriberRecognizer.canceled){const h=new e.ConversationTranscriptionCanceledEventArgs(s,u,c,void 0,n);try{this.privTranscriberRecognizer.canceled(this.privTranscriberRecognizer,h)}catch{}}if(this.privSuccessCallback){const h=new e.SpeechRecognitionResult(i,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,u,void 0,d);try{this.privSuccessCallback(h),this.privSuccessCallback=void 0}catch{}}}async sendTranscriptionStartJSON(n){if(await this.sendSpeechContext(n,!0),this.privTranscriberRecognizer.IsMeetingRecognizer()){const i=this.privTranscriberRecognizer.getMeetingInfo(),s=this.createMeetingSpeechEventPayload(i,"start");await this.sendSpeechEvent(n,s)}else{const i=this.privTranscriberRecognizer.getConversationInfo(),s=this.createSpeechEventPayload(i,"start");await this.sendSpeechEvent(n,s)}await this.sendWaveHeader(n)}sendSpeechEvent(n,i){const s=JSON.stringify(i);if(s)return n.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speech.event",this.privRequestSession.requestId,"application/json",s))}createSpeechEventPayload(n,i){const s={id:"meeting",name:i,meeting:n.conversationProperties};return s.meeting.id=n.id,s.meeting.attendees=n.participants,s}createMeetingSpeechEventPayload(n,i){const s={id:"meeting",name:i,meeting:n.meetingProperties};return s.meeting.id=n.id,s.meeting.attendees=n.participants,s}};return Ir.TranscriptionServiceRecognizer=p,Ir}var Tr={},La;function jf(){if(La)return Tr;La=1,Object.defineProperty(Tr,"__esModule",{value:!0}),Tr.DetailedSpeechPhrase=void 0;const t=T();let e=class Lp{constructor(o,p){this.privDetailedSpeechPhrase=JSON.parse(o),this.privDetailedSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privDetailedSpeechPhrase.RecognitionStatus),this.updateOffsets(p)}static fromJSON(o,p){return new Lp(o,p)}updateOffsets(o){if(this.privDetailedSpeechPhrase.Offset+=o,this.privDetailedSpeechPhrase.NBest)for(const p of this.privDetailedSpeechPhrase.NBest){if(p.Words)for(const a of p.Words)a.Offset+=o;if(p.DisplayWords)for(const a of p.DisplayWords)a.Offset+=o}}asJson(){const o={...this.privDetailedSpeechPhrase};return JSON.stringify({...o,RecognitionStatus:t.RecognitionStatus[o.RecognitionStatus]})}get RecognitionStatus(){return this.privDetailedSpeechPhrase.RecognitionStatus}get NBest(){return this.privDetailedSpeechPhrase.NBest}get Duration(){return this.privDetailedSpeechPhrase.Duration}get Offset(){return this.privDetailedSpeechPhrase.Offset}get Language(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privDetailedSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privDetailedSpeechPhrase.PrimaryLanguage.Confidence}get Text(){return this.privDetailedSpeechPhrase.NBest&&this.privDetailedSpeechPhrase.NBest[0]?this.privDetailedSpeechPhrase.NBest[0].Display||this.privDetailedSpeechPhrase.NBest[0].DisplayText:this.privDetailedSpeechPhrase.DisplayText}get SpeakerId(){return this.privDetailedSpeechPhrase.SpeakerId}mapRecognitionStatus(o){if(typeof o=="string")return t.RecognitionStatus[o];if(typeof o=="number")return o}};return Tr.DetailedSpeechPhrase=e,Tr}var Ar={},Ba;function Lf(){if(Ba)return Ar;Ba=1,Object.defineProperty(Ar,"__esModule",{value:!0}),Ar.SimpleSpeechPhrase=void 0;const t=T();let e=class Bp{constructor(o,p=0){this.privSimpleSpeechPhrase=JSON.parse(o),this.privSimpleSpeechPhrase.RecognitionStatus=this.mapRecognitionStatus(this.privSimpleSpeechPhrase.RecognitionStatus),this.updateOffset(p)}static fromJSON(o,p){return new Bp(o,p)}updateOffset(o){this.privSimpleSpeechPhrase.Offset+=o}asJson(){const o={...this.privSimpleSpeechPhrase};return JSON.stringify({...o,RecognitionStatus:t.RecognitionStatus[o.RecognitionStatus]})}get RecognitionStatus(){return this.privSimpleSpeechPhrase.RecognitionStatus}get DisplayText(){return this.privSimpleSpeechPhrase.DisplayText}get Offset(){return this.privSimpleSpeechPhrase.Offset}get Duration(){return this.privSimpleSpeechPhrase.Duration}get Language(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Language}get LanguageDetectionConfidence(){return this.privSimpleSpeechPhrase.PrimaryLanguage===void 0?void 0:this.privSimpleSpeechPhrase.PrimaryLanguage.Confidence}get SpeakerId(){return this.privSimpleSpeechPhrase.SpeakerId}mapRecognitionStatus(o){if(typeof o=="string")return t.RecognitionStatus[o];if(typeof o=="number")return o}};return Ar.SimpleSpeechPhrase=e,Ar}var vn={};Object.defineProperty(vn,"__esModule",{value:!0});vn.AddedLmIntent=void 0;class Bf{constructor(e,r){this.modelImpl=e,this.intentName=r}}vn.AddedLmIntent=Bf;var wr={},qa;function qf(){if(qa)return wr;qa=1,Object.defineProperty(wr,"__esModule",{value:!0}),wr.IntentServiceRecognizer=void 0;const t=A(),e=P(),r=T();let o=class extends r.ServiceRecognizerBase{constructor(a,n,i,s,c){super(a,n,i,s,c),this.privIntentRecognizer=c,this.privIntentDataSent=!1,s.recognitionEndpointVersion="1"}setIntents(a,n){this.privAddedLmIntents=a,this.privUmbrellaIntent=n,this.privIntentDataSent=!0}processTypeSpecificMessages(a){let n,i,s=!1;const c=new e.PropertyCollection;switch(a.messageType===t.MessageType.Text&&c.setProperty(e.PropertyId.SpeechServiceResponse_JsonResult,a.textBody),a.path.toLowerCase()){case"speech.hypothesis":const d=r.SpeechHypothesis.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);if(n=new e.IntentRecognitionResult(void 0,this.privRequestSession.requestId,e.ResultReason.RecognizingIntent,d.Text,d.Duration,d.Offset,d.Language,d.LanguageDetectionConfidence,void 0,d.asJson(),c),this.privRequestSession.onHypothesis(n.offset),i=new e.IntentRecognitionEventArgs(n,d.Offset,this.privRequestSession.sessionId),this.privIntentRecognizer.recognizing)try{this.privIntentRecognizer.recognizing(this.privIntentRecognizer,i)}catch{}s=!0;break;case"speech.phrase":const h=r.SimpleSpeechPhrase.fromJSON(a.textBody,this.privRequestSession.currentTurnAudioOffset);n=new e.IntentRecognitionResult(void 0,this.privRequestSession.requestId,r.EnumTranslation.implTranslateRecognitionResult(h.RecognitionStatus),h.DisplayText,h.Duration,h.Offset,h.Language,h.LanguageDetectionConfidence,void 0,h.asJson(),c),i=new e.IntentRecognitionEventArgs(n,n.offset,this.privRequestSession.sessionId);const l=()=>{if(this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(n)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}};this.privIntentDataSent===!1||e.ResultReason.NoMatch===i.result.reason?(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),l()):this.privPendingIntentArgs=i,s=!0;break;case"response":if(i=this.privPendingIntentArgs,this.privPendingIntentArgs=void 0,i===void 0){if(a.textBody==="")return;i=new e.IntentRecognitionEventArgs(new e.IntentRecognitionResult,0,this.privRequestSession.sessionId)}const f=r.IntentResponse.fromJSON(a.textBody);if(f!==null&&f.topScoringIntent&&f.topScoringIntent.intent){let g=this.privAddedLmIntents[f.topScoringIntent.intent];if(this.privUmbrellaIntent!==void 0&&(g=this.privUmbrellaIntent),g){const S=g===void 0||g.intentName===void 0?f.topScoringIntent.intent:g.intentName;let v=i.result.reason;S!==void 0&&(v=e.ResultReason.RecognizedIntent);const m=i.result.properties!==void 0?i.result.properties:new e.PropertyCollection;m.setProperty(e.PropertyId.LanguageUnderstandingServiceResponse_JsonResult,a.textBody),i=new e.IntentRecognitionEventArgs(new e.IntentRecognitionResult(S,i.result.resultId,v,i.result.text,i.result.duration,i.result.offset,void 0,void 0,i.result.errorDetails,i.result.json,m),i.offset,i.sessionId)}}if(this.privRequestSession.onPhraseRecognized(i.offset+i.result.duration),this.privIntentRecognizer.recognized)try{this.privIntentRecognizer.recognized(this.privIntentRecognizer,i)}catch{}if(this.privSuccessCallback){try{this.privSuccessCallback(i.result)}catch(g){this.privErrorCallback&&this.privErrorCallback(g)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}s=!0;break}const u=new t.Deferred;return u.resolve(s),u.promise}cancelRecognition(a,n,i,s,c){const u=new e.PropertyCollection;if(u.setProperty(r.CancellationErrorCodePropertyName,e.CancellationErrorCode[s]),this.privIntentRecognizer.canceled){const d=new e.IntentRecognitionCanceledEventArgs(i,c,s,void 0,void 0,a);try{this.privIntentRecognizer.canceled(this.privIntentRecognizer,d)}catch{}}if(this.privSuccessCallback){const d=new e.IntentRecognitionResult(void 0,n,e.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,c,void 0,u);try{this.privSuccessCallback(d),this.privSuccessCallback=void 0}catch{}}}};return wr.IntentServiceRecognizer=o,wr}var fn={};Object.defineProperty(fn,"__esModule",{value:!0});fn.IntentResponse=void 0;class Rs{constructor(e){e===""?this.privIntentResponse={}:this.privIntentResponse=JSON.parse(e)}static fromJSON(e){return new Rs(e)}get query(){return this.privIntentResponse.query}get topScoringIntent(){return this.privIntentResponse.topScoringIntent}get entities(){return this.privIntentResponse.entities}}fn.IntentResponse=Rs;var qp={};Object.defineProperty(qp,"__esModule",{value:!0});var gn={},mn={};Object.defineProperty(mn,"__esModule",{value:!0});mn.ServiceTelemetryListener=void 0;const fe=A(),Fa=cn;class Ff{constructor(e,r,o){this.privIsDisposed=!1,this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privRequestId=e,this.privAudioSourceId=r,this.privAudioNodeId=o,this.privReceivedMessages={},this.privPhraseLatencies=[],this.privHypothesisLatencies=[]}phraseReceived(e){e>0&&this.privPhraseLatencies.push(Date.now()-e)}hypothesisReceived(e){e>0&&this.privHypothesisLatencies.push(Date.now()-e)}onEvent(e){this.privIsDisposed||(e instanceof Fa.RecognitionTriggeredEvent&&e.requestId===this.privRequestId&&(this.privListeningTriggerMetric={End:e.eventTime,Name:"ListeningTrigger",Start:e.eventTime}),e instanceof fe.AudioStreamNodeAttachingEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof fe.AudioStreamNodeAttachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicStartTime=e.eventTime),e instanceof fe.AudioSourceErrorEvent&&e.audioSourceId===this.privAudioSourceId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof fe.AudioStreamNodeErrorEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Error:e.error,Name:"Microphone",Start:this.privMicStartTime})),e instanceof fe.AudioStreamNodeDetachedEvent&&e.audioSourceId===this.privAudioSourceId&&e.audioNodeId===this.privAudioNodeId&&(this.privMicMetric||(this.privMicMetric={End:e.eventTime,Name:"Microphone",Start:this.privMicStartTime})),e instanceof Fa.ConnectingToServiceEvent&&e.requestId===this.privRequestId&&(this.privConnectionId=e.sessionId),e instanceof fe.ConnectionStartEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionStartTime=e.eventTime),e instanceof fe.ConnectionEstablishedEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof fe.ConnectionEstablishErrorEvent&&e.connectionId===this.privConnectionId&&(this.privConnectionEstablishMetric||(this.privConnectionEstablishMetric={End:e.eventTime,Error:this.getConnectionError(e.statusCode),Id:this.privConnectionId,Name:"Connection",Start:this.privConnectionStartTime})),e instanceof fe.ConnectionMessageReceivedEvent&&e.connectionId===this.privConnectionId&&e.message&&e.message.headers&&e.message.headers.path&&(this.privReceivedMessages[e.message.headers.path]||(this.privReceivedMessages[e.message.headers.path]=new Array),this.privReceivedMessages[e.message.headers.path].length<50&&this.privReceivedMessages[e.message.headers.path].push(e.networkReceivedTime)))}getTelemetry(){const e=new Array;this.privListeningTriggerMetric&&e.push(this.privListeningTriggerMetric),this.privMicMetric&&e.push(this.privMicMetric),this.privConnectionEstablishMetric&&e.push(this.privConnectionEstablishMetric),this.privPhraseLatencies.length>0&&e.push({PhraseLatencyMs:this.privPhraseLatencies}),this.privHypothesisLatencies.length>0&&e.push({FirstHypothesisLatencyMs:this.privHypothesisLatencies});const r={Metrics:e,ReceivedMessages:this.privReceivedMessages},o=JSON.stringify(r);return this.privReceivedMessages={},this.privListeningTriggerMetric=null,this.privMicMetric=null,this.privConnectionEstablishMetric=null,this.privPhraseLatencies=[],this.privHypothesisLatencies=[],o}get hasTelemetry(){return Object.keys(this.privReceivedMessages).length!==0||this.privListeningTriggerMetric!==null||this.privMicMetric!==null||this.privConnectionEstablishMetric!==null||this.privPhraseLatencies.length!==0||this.privHypothesisLatencies.length!==0}dispose(){this.privIsDisposed=!0}getConnectionError(e){switch(e){case 400:case 1002:case 1003:case 1005:case 1007:case 1008:case 1009:return"BadRequest";case 401:return"Unauthorized";case 403:return"Forbidden";case 503:case 1001:return"ServerUnavailable";case 500:case 1011:return"ServerError";case 408:case 504:return"Timeout";default:return"statuscode:"+e.toString()}}}mn.ServiceTelemetryListener=Ff;Object.defineProperty(gn,"__esModule",{value:!0});gn.RequestSession=void 0;const Ge=A(),ai=cn,xf=mn;class Uf{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privIsAudioNodeDetached=!1,this.privIsRecognizing=!1,this.privIsSpeechEnded=!1,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privHypothesisReceived=!1,this.privBytesSent=0,this.privRecognitionBytesSent=0,this.privRecogNumber=0,this.privInTurn=!1,this.privConnectionAttempts=0,this.privAudioSourceId=e,this.privRequestId=(0,Ge.createNoDashGuid)(),this.privAudioNodeId=(0,Ge.createNoDashGuid)(),this.privTurnDeferral=new Ge.Deferred,this.privTurnDeferral.resolve()}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get audioNodeId(){return this.privAudioNodeId}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSpeechEnded(){return this.privIsSpeechEnded}get isRecognizing(){return this.privIsRecognizing}get currentTurnAudioOffset(){return this.privTurnStartAudioOffset}get recogNumber(){return this.privRecogNumber}get numConnectionAttempts(){return this.privConnectionAttempts}get bytesSent(){return this.privBytesSent}get recognitionBytesSent(){return this.privRecognitionBytesSent}listenForServiceTelemetry(e){this.privServiceTelemetryListener&&this.privDetachables.push(e.attachListener(this.privServiceTelemetryListener))}startNewRecognition(){this.privRecognitionBytesSent=0,this.privIsSpeechEnded=!1,this.privIsRecognizing=!0,this.privTurnStartAudioOffset=0,this.privLastRecoOffset=0,this.privRecogNumber++,this.privServiceTelemetryListener=new xf.ServiceTelemetryListener(this.privRequestId,this.privAudioSourceId,this.privAudioNodeId),this.onEvent(new ai.RecognitionTriggeredEvent(this.requestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}async onAudioSourceAttachCompleted(e,r){this.privAudioNode=e,this.privIsAudioNodeDetached=!1,r?await this.onComplete():this.onEvent(new ai.ListeningStartedEvent(this.privRequestId,this.privSessionId,this.privAudioSourceId,this.privAudioNodeId))}onPreConnectionStart(e,r){this.privAuthFetchEventId=e,this.privSessionId=r,this.onEvent(new ai.ConnectingToServiceEvent(this.privRequestId,this.privAuthFetchEventId,this.privSessionId))}async onAuthCompleted(e){e&&await this.onComplete()}async onConnectionEstablishCompleted(e,r){if(e===200){this.onEvent(new ai.RecognitionStartedEvent(this.requestId,this.privAudioSourceId,this.privAudioNodeId,this.privAuthFetchEventId,this.privSessionId)),this.privAudioNode&&this.privAudioNode.replay(),this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privBytesSent=0;return}else e===403&&await this.onComplete()}async onServiceTurnEndResponse(e){this.privTurnDeferral.resolve(),!e||this.isSpeechEnded?(await this.onComplete(),this.privInTurn=!1):(this.privTurnStartAudioOffset=this.privLastRecoOffset,this.privAudioNode.replay())}onSpeechContext(){this.privRequestId=(0,Ge.createNoDashGuid)()}onServiceTurnStartResponse(){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new Ge.Deferred}onHypothesis(e){this.privHypothesisReceived||(this.privHypothesisReceived=!0,this.privServiceTelemetryListener.hypothesisReceived(this.privAudioNode.findTimeAtOffset(e)))}onPhraseRecognized(e){this.privServiceTelemetryListener.phraseReceived(this.privAudioNode.findTimeAtOffset(e)),this.onServiceRecognized(e)}onServiceRecognized(e){this.privLastRecoOffset=e,this.privHypothesisReceived=!1,this.privAudioNode.shrinkBuffers(e),this.privConnectionAttempts=0}onAudioSent(e){this.privBytesSent+=e,this.privRecognitionBytesSent+=e}onRetryConnection(){this.privConnectionAttempts++}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)await e.detach();this.privServiceTelemetryListener&&this.privServiceTelemetryListener.dispose(),this.privIsRecognizing=!1}}getTelemetry(){return this.privServiceTelemetryListener.hasTelemetry?this.privServiceTelemetryListener.getTelemetry():null}async onStopRecognizing(){await this.onComplete()}onSpeechEnded(){this.privIsSpeechEnded=!0}onEvent(e){this.privServiceTelemetryListener&&this.privServiceTelemetryListener.onEvent(e),Ge.Events.instance.onEvent(e)}async onComplete(){this.privIsRecognizing&&(this.privIsRecognizing=!1,await this.detachAudioNode())}async detachAudioNode(){this.privIsAudioNodeDetached||(this.privIsAudioNodeDetached=!0,this.privAudioNode&&await this.privAudioNode.detach())}}gn.RequestSession=Uf;var Sn={},Fp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TentativePhraseResultsOption=t.OutputFormat=t.PhraseExtension=t.PhraseOption=void 0,function(e){e.WordTimings="WordTimings",e.SNR="SNR",e.Pronunciation="Pronunciation",e.WordPronunciation="WordPronunciation",e.WordConfidence="WordConfidence",e.Words="Words",e.Sentiment="Sentiment",e.PronunciationAssessment="PronunciationAssessment",e.ContentAssessment="ContentAssessment",e.PhraseAMScore="PhraseAMScore",e.PhraseLMScore="PhraseLMScore",e.WordAMScore="WordAMScore",e.WordLMScore="WordLMScore",e.RuleTree="RuleTree",e.NBestTimings="NBestTimings",e.DecoderDiagnostics="DecoderDiagnostics",e.DisplayWordTimings="DisplayWordTimings",e.DisplayWords="DisplayWords"}(t.PhraseOption||(t.PhraseOption={})),function(e){e.Graph="Graph",e.Corrections="Corrections",e.Sentiment="Sentiment"}(t.PhraseExtension||(t.PhraseExtension={})),function(e){e.Simple="Simple",e.Detailed="Detailed"}(t.OutputFormat||(t.OutputFormat={})),function(e){e.None="None",e.Always="Always"}(t.TentativePhraseResultsOption||(t.TentativePhraseResultsOption={}))})(Fp);Object.defineProperty(Sn,"__esModule",{value:!0});Sn.SpeechContext=void 0;const Wf=ne,Ce=Fp;class Vf{constructor(e){this.privContext={},this.privDynamicGrammar=e}getContext(){return this.privContext}setPronunciationAssessmentParams(e,r,o=!1){this.privContext.phraseDetection===void 0&&(this.privContext.phraseDetection={enrichment:{pronunciationAssessment:{}}}),this.privContext.phraseDetection.enrichment===void 0&&(this.privContext.phraseDetection.enrichment={pronunciationAssessment:{}}),this.privContext.phraseDetection.enrichment.pronunciationAssessment=JSON.parse(e)||{},o&&(this.privContext.phraseDetection.mode=Wf.RecognitionMode.Conversation),this.setWordLevelTimings(),this.privContext.phraseOutput.detailed.options.push(Ce.PhraseOption.PronunciationAssessment),this.privContext.phraseOutput.detailed.options.indexOf(Ce.PhraseOption.SNR)===-1&&this.privContext.phraseOutput.detailed.options.push(Ce.PhraseOption.SNR),r&&(this.privContext.phraseDetection.enrichment.contentAssessment={topic:r},this.privContext.phraseOutput.detailed.options.push(Ce.PhraseOption.ContentAssessment))}setDetailedOutputFormat(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=Ce.OutputFormat.Detailed}setWordLevelTimings(){this.privContext.phraseOutput===void 0&&(this.privContext.phraseOutput={detailed:{options:[]}}),this.privContext.phraseOutput.detailed===void 0&&(this.privContext.phraseOutput.detailed={options:[]}),this.privContext.phraseOutput.format=Ce.OutputFormat.Detailed,this.privContext.phraseOutput.detailed.options.indexOf(Ce.PhraseOption.WordTimings)===-1&&this.privContext.phraseOutput.detailed.options.push(Ce.PhraseOption.WordTimings)}setSpeakerDiarizationAudioOffsetMs(e){this.privContext.phraseDetection.speakerDiarization.audioOffsetMs=e}toJSON(){const e=this.privDynamicGrammar.generateGrammarObject();return this.privContext.dgi=e,JSON.stringify(this.privContext)}}Sn.SpeechContext=Vf;var Cn={},xp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SubstringMatchType=t.GroupType=void 0,function(e){e.IntentText="IntentText",e.IntentEntity="IntentEntity",e.Generic="Generic",e.People="People",e.Place="Place",e.DynamicEntity="DynamicEntity"}(t.GroupType||(t.GroupType={})),function(e){e.None="None",e.LeftRooted="LeftRooted",e.PartialName="PartialName",e.MiddleOfSentence="MiddleOfSentence"}(t.SubstringMatchType||(t.SubstringMatchType={}))})(xp);Object.defineProperty(Cn,"__esModule",{value:!0});Cn.DynamicGrammarBuilder=void 0;const Hf=xp;class $f{addPhrase(e){this.privPhrases||(this.privPhrases=[]),e instanceof Array?this.privPhrases=this.privPhrases.concat(e):this.privPhrases.push(e)}clearPhrases(){this.privPhrases=void 0}addReferenceGrammar(e){this.privGrammars||(this.privGrammars=[]),e instanceof Array?this.privGrammars=this.privGrammars.concat(e):this.privGrammars.push(e)}clearGrammars(){this.privGrammars=void 0}generateGrammarObject(){if(this.privGrammars===void 0&&this.privPhrases===void 0)return;const e={};if(e.referenceGrammars=this.privGrammars,this.privPhrases!==void 0&&this.privPhrases.length!==0){const r=[];this.privPhrases.forEach(o=>{r.push({text:o})}),e.groups=[{type:Hf.GroupType.Generic,items:r}]}return e}}Cn.DynamicGrammarBuilder=$f;var _r={},yn={},Pn={},Es={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.MessageDataStreamType=t.ActivityPayloadResponse=void 0;class e{constructor(o){this.privActivityResponse=JSON.parse(o)}static fromJSON(o){return new e(o)}get conversationId(){return this.privActivityResponse.conversationId}get messageDataStreamType(){return this.privActivityResponse.messageDataStreamType}get messagePayload(){return this.privActivityResponse.messagePayload}get version(){return this.privActivityResponse.version}}t.ActivityPayloadResponse=e,function(r){r[r.None=0]="None",r[r.TextToSpeechAudio=1]="TextToSpeechAudio"}(t.MessageDataStreamType||(t.MessageDataStreamType={}))})(Es);Object.defineProperty(Pn,"__esModule",{value:!0});Pn.DialogServiceTurnState=void 0;const Kf=_e,Jf=W,Gf=Es;class Qf{constructor(e,r){this.privRequestId=r,this.privIsCompleted=!1,this.privAudioStream=null,this.privTurnManager=e,this.resetTurnEndTimeout()}get audioStream(){return this.resetTurnEndTimeout(),this.privAudioStream}processActivityPayload(e,r){return e.messageDataStreamType===Gf.MessageDataStreamType.TextToSpeechAudio&&(this.privAudioStream=Jf.AudioOutputStream.createPullStream(),this.privAudioStream.format=r!==void 0?r:Kf.AudioOutputFormatImpl.getDefaultOutputFormat()),this.privAudioStream}endAudioStream(){this.privAudioStream!==null&&!this.privAudioStream.isClosed&&this.privAudioStream.close()}complete(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.endAudioStream()}resetTurnEndTimeout(){this.privTimeoutToken!==void 0&&clearTimeout(this.privTimeoutToken),this.privTimeoutToken=setTimeout(()=>{this.privTurnManager.CompleteTurn(this.privRequestId)},2e3)}}Pn.DialogServiceTurnState=Qf;Object.defineProperty(yn,"__esModule",{value:!0});yn.DialogServiceTurnStateManager=void 0;const xa=V,Xf=Pn;class Zf{constructor(){this.privTurnMap=new Map}StartTurn(e){if(this.privTurnMap.has(e))throw new xa.InvalidOperationError("Service error: There is already a turn with id:"+e);const r=new Xf.DialogServiceTurnState(this,e);return this.privTurnMap.set(e,r),this.privTurnMap.get(e)}GetTurn(e){return this.privTurnMap.get(e)}CompleteTurn(e){if(!this.privTurnMap.has(e))throw new xa.InvalidOperationError("Service error: Received turn end for an unknown turn id:"+e);const r=this.privTurnMap.get(e);return r.complete(),this.privTurnMap.delete(e),r}}yn.DialogServiceTurnStateManager=Zf;var Up={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.InvocationSource=void 0,function(e){e.None="None",e.VoiceActivationWithKeyword="VoiceActivationWithKeyword"}(t.InvocationSource||(t.InvocationSource={}))})(Up);var Wp={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.OnRejectAction=t.KeywordDetectionType=void 0,function(e){e.StartTrigger="StartTrigger"}(t.KeywordDetectionType||(t.KeywordDetectionType={})),function(e){e.EndOfTurn="EndOfTurn",e.Continue="Continue"}(t.OnRejectAction||(t.OnRejectAction={}))})(Wp);var Ua;function Yf(){if(Ua)return _r;Ua=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.DialogServiceAdapter=void 0;const t=x(),e=Ve,r=A(),o=_e,p=P(),a=yn,n=T(),i=Es,s=Up,c=Wp,u=Se;let d=class extends n.ServiceRecognizerBase{constructor(l,f,g,S,v){super(l,f,g,S,v),this.privEvents=new r.EventSource,this.privDialogServiceConnector=v,this.receiveMessageOverride=()=>this.receiveDialogMessageOverride(),this.privTurnStateManager=new a.DialogServiceTurnStateManager,this.recognizeOverride=(m,C,y)=>this.listenOnce(m,C,y),this.postConnectImplOverride=m=>this.dialogConnectImpl(m),this.configConnectionOverride=m=>this.configConnection(m),this.disconnectOverride=()=>this.privDisconnect(),this.privDialogAudioSource=g,this.agentConfigSent=!1,this.privLastResult=null,this.connectionEvents.attach(m=>{m.name==="ConnectionClosedEvent"&&(this.terminateMessageLoop=!0)})}async sendMessage(l){const f=(0,r.createGuid)(),g=(0,r.createNoDashGuid)(),S={context:{interactionId:f},messagePayload:JSON.parse(l),version:.5},v=JSON.stringify(S);await(await this.fetchConnection()).send(new u.SpeechConnectionMessage(r.MessageType.Text,"agent",g,"application/json",v))}async privDisconnect(){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,p.CancellationReason.Error,p.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,this.agentConfigSent=!1}processTypeSpecificMessages(l){const f=new p.PropertyCollection;l.messageType===r.MessageType.Text&&f.setProperty(p.PropertyId.SpeechServiceResponse_JsonResult,l.textBody);let g,S;switch(l.path.toLowerCase()){case"speech.phrase":const m=n.SimpleSpeechPhrase.fromJSON(l.textBody,this.privRequestSession.currentTurnAudioOffset);if(this.privRequestSession.onPhraseRecognized(m.Offset+m.Duration),m.RecognitionStatus!==n.RecognitionStatus.TooManyRequests&&m.RecognitionStatus!==n.RecognitionStatus.Error){const w=this.fireEventForResult(m,f);if(this.privLastResult=w.result,this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,w)}catch{}}S=!0;break;case"speech.hypothesis":const C=n.SpeechHypothesis.fromJSON(l.textBody,this.privRequestSession.currentTurnAudioOffset);g=new p.SpeechRecognitionResult(this.privRequestSession.requestId,p.ResultReason.RecognizingSpeech,C.Text,C.Duration,C.Offset,C.Language,C.LanguageDetectionConfidence,void 0,void 0,C.asJson(),f),this.privRequestSession.onHypothesis(C.Offset);const y=new p.SpeechRecognitionEventArgs(g,C.Offset,this.privRequestSession.sessionId);if(this.privDialogServiceConnector.recognizing)try{this.privDialogServiceConnector.recognizing(this.privDialogServiceConnector,y)}catch{}S=!0;break;case"speech.keyword":const E=n.SpeechKeyword.fromJSON(l.textBody,this.privRequestSession.currentTurnAudioOffset);g=new p.SpeechRecognitionResult(this.privRequestSession.requestId,E.Status==="Accepted"?p.ResultReason.RecognizedKeyword:p.ResultReason.NoMatch,E.Text,E.Duration,E.Offset,void 0,void 0,void 0,void 0,E.asJson(),f),E.Status!=="Accepted"&&(this.privLastResult=g);const I=new p.SpeechRecognitionEventArgs(g,g.duration,g.resultId);if(this.privDialogServiceConnector.recognized)try{this.privDialogServiceConnector.recognized(this.privDialogServiceConnector,I)}catch{}S=!0;break;case"audio":{const w=l.requestId.toUpperCase(),R=this.privTurnStateManager.GetTurn(w);try{l.binaryBody?R.audioStream.write(l.binaryBody):R.endAudioStream()}catch{}}S=!0;break;case"response":this.handleResponseMessage(l),S=!0;break}const v=new r.Deferred;return v.resolve(S),v.promise}async cancelRecognition(l,f,g,S,v){if(this.terminateMessageLoop=!0,this.privRequestSession.isRecognizing&&await this.privRequestSession.onStopRecognizing(),this.privDialogServiceConnector.canceled){const m=new p.PropertyCollection;m.setProperty(n.CancellationErrorCodePropertyName,p.CancellationErrorCode[S]);const C=new p.SpeechRecognitionCanceledEventArgs(g,v,S,void 0,l);try{this.privDialogServiceConnector.canceled(this.privDialogServiceConnector,C)}catch{}if(this.privSuccessCallback){const y=new p.SpeechRecognitionResult(void 0,p.ResultReason.Canceled,void 0,void 0,void 0,void 0,void 0,void 0,v,void 0,m);try{this.privSuccessCallback(y),this.privSuccessCallback=void 0}catch{}}}}async listenOnce(l,f,g){this.privRecognizerConfig.recognitionMode=l,this.privSuccessCallback=f,this.privErrorCallback=g,this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privDialogAudioSource.events),this.privRecognizerConfig.parameters.setProperty(p.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const S=this.connectImpl(),v=this.sendPreAudioMessages(),m=await this.privDialogAudioSource.attach(this.privRequestSession.audioNodeId),C=await this.privDialogAudioSource.format,y=await this.privDialogAudioSource.deviceInfo,E=new t.ReplayableAudioNode(m,C.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(E,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:y};try{await S,await v}catch(R){return await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,p.CancellationReason.Error,p.CancellationErrorCode.ConnectionFailure,R),Promise.resolve()}const I=new p.SessionEventArgs(this.privRequestSession.sessionId);this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,I),this.sendAudio(E).then(()=>{},async R=>{await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,p.CancellationReason.Error,p.CancellationErrorCode.RuntimeError,R)})}dialogConnectImpl(l){return this.privConnectionLoop=this.startMessageLoop(),l}receiveDialogMessageOverride(){const l=new r.Deferred,f=async()=>{try{const g=this.isDisposed(),S=!this.isDisposed()&&this.terminateMessageLoop;if(g||S){l.resolve(void 0);return}const m=await(await this.fetchConnection()).read();if(!m)return f();const C=u.SpeechConnectionMessage.fromConnectionMessage(m);switch(C.path.toLowerCase()){case"turn.start":{const L=C.requestId.toUpperCase(),se=this.privRequestSession.requestId.toUpperCase();L!==se?this.privTurnStateManager.StartTurn(L):this.privRequestSession.onServiceTurnStartResponse()}break;case"speech.startdetected":const E=n.SpeechDetected.fromJSON(C.textBody,this.privRequestSession.currentTurnAudioOffset),I=new p.RecognitionEventArgs(E.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechStartDetected&&this.privRecognizer.speechStartDetected(this.privRecognizer,I);break;case"speech.enddetected":let w;C.textBody.length>0?w=C.textBody:w="{ Offset: 0 }";const R=n.SpeechDetected.fromJSON(w,this.privRequestSession.currentTurnAudioOffset);this.privRequestSession.onServiceRecognized(R.Offset);const z=new p.RecognitionEventArgs(R.Offset,this.privRequestSession.sessionId);this.privRecognizer.speechEndDetected&&this.privRecognizer.speechEndDetected(this.privRecognizer,z);break;case"turn.end":{const L=C.requestId.toUpperCase(),se=this.privRequestSession.requestId.toUpperCase();if(L!==se)this.privTurnStateManager.CompleteTurn(L);else{const Ke=new p.SessionEventArgs(this.privRequestSession.sessionId);if(await this.privRequestSession.onServiceTurnEndResponse(!1),(!this.privRecognizerConfig.isContinuousRecognition||this.privRequestSession.isSpeechEnded||!this.privRequestSession.isRecognizing)&&this.privRecognizer.sessionStopped&&this.privRecognizer.sessionStopped(this.privRecognizer,Ke),this.privSuccessCallback&&this.privLastResult){try{this.privSuccessCallback(this.privLastResult),this.privLastResult=null}catch(Y){this.privErrorCallback&&this.privErrorCallback(Y)}this.privSuccessCallback=void 0,this.privErrorCallback=void 0}}}break;default:try{await this.processTypeSpecificMessages(C)||this.serviceEvents&&this.serviceEvents.onEvent(new r.ServiceEvent(C.path.toLowerCase(),C.textBody))}catch{}}return f()}catch{this.terminateMessageLoop=!0,l.resolve()}};return f().catch(g=>{r.Events.instance.onEvent(new r.BackgroundEvent(g))}),l.promise}async startMessageLoop(){this.terminateMessageLoop=!1;try{await this.receiveDialogMessageOverride()}catch(l){await this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,p.CancellationReason.Error,p.CancellationErrorCode.RuntimeError,l)}return Promise.resolve()}async configConnection(l){return this.terminateMessageLoop?(this.terminateMessageLoop=!1,Promise.reject("Connection to service terminated.")):(await this.sendSpeechServiceConfig(l,this.privRequestSession,this.privRecognizerConfig.SpeechServiceConfig.serialize()),await this.sendAgentConfig(l),l)}async sendPreAudioMessages(){const l=await this.fetchConnection();this.addKeywordContextData(),await this.sendSpeechContext(l,!0),await this.sendAgentContext(l),await this.sendWaveHeader(l)}sendAgentConfig(l){if(this.agentConfig&&!this.agentConfigSent){if(this.privRecognizerConfig.parameters.getProperty(p.PropertyId.Conversation_DialogType)===p.DialogServiceConfig.DialogTypes.CustomCommands){const g=this.agentConfig.get();g.botInfo.commandsCulture=this.privRecognizerConfig.parameters.getProperty(p.PropertyId.SpeechServiceConnection_RecoLanguage,"en-us"),this.agentConfig.set(g)}this.onEvent(new e.SendingAgentContextMessageEvent(this.agentConfig));const f=this.agentConfig.toJsonString();return this.agentConfigSent=!0,l.send(new u.SpeechConnectionMessage(r.MessageType.Text,"agent.config",this.privRequestSession.requestId,"application/json",f))}}sendAgentContext(l){const f=(0,r.createGuid)(),g=this.privDialogServiceConnector.properties.getProperty(p.PropertyId.Conversation_Speech_Activity_Template),v=JSON.stringify({channelData:"",context:{interactionId:f},messagePayload:typeof g===void 0?void 0:g,version:.5});return l.send(new u.SpeechConnectionMessage(r.MessageType.Text,"speech.agent.context",this.privRequestSession.requestId,"application/json",v))}fireEventForResult(l,f){const g=n.EnumTranslation.implTranslateRecognitionResult(l.RecognitionStatus),S=new p.SpeechRecognitionResult(this.privRequestSession.requestId,g,l.DisplayText,l.Duration,l.Offset,l.Language,l.LanguageDetectionConfidence,void 0,void 0,l.asJson(),f);return new p.SpeechRecognitionEventArgs(S,l.Offset,this.privRequestSession.sessionId)}handleResponseMessage(l){const f=JSON.parse(l.textBody);switch(f.messageType.toLowerCase()){case"message":const g=l.requestId.toUpperCase(),S=i.ActivityPayloadResponse.fromJSON(l.textBody),v=this.privTurnStateManager.GetTurn(g);if(S.conversationId){const y=this.agentConfig.get();y.botInfo.conversationId=S.conversationId,this.agentConfig.set(y)}const m=v.processActivityPayload(S,o.AudioOutputFormatImpl.fromSpeechSynthesisOutputFormatString(this.privDialogServiceConnector.properties.getProperty(p.PropertyId.SpeechServiceConnection_SynthOutputFormat,void 0))),C=new p.ActivityReceivedEventArgs(S.messagePayload,m);if(this.privDialogServiceConnector.activityReceived)try{this.privDialogServiceConnector.activityReceived(this.privDialogServiceConnector,C)}catch{}break;case"messagestatus":if(this.privDialogServiceConnector.turnStatusReceived)try{this.privDialogServiceConnector.turnStatusReceived(this.privDialogServiceConnector,new p.TurnStatusReceivedEventArgs(l.textBody))}catch{}break;default:r.Events.instance.onEvent(new r.BackgroundEvent(`Unexpected response of type ${f.messageType}. Ignoring.`));break}}onEvent(l){this.privEvents.onEvent(l),r.Events.instance.onEvent(l)}addKeywordContextData(){const l=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect");if(l===void 0)return;const f=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Offsets"),g=this.privRecognizerConfig.parameters.getProperty("SPEECH-KeywordsToDetect-Durations"),S=l.split(";"),v=f===void 0?[]:f.split(";"),m=g===void 0?[]:g.split(";"),C=[];for(let y=0;y<S.length;y++){const E={text:S[y]};y<v.length&&(E.startOffset=Number(v[y])),y<m.length&&(E.duration=Number(m[y])),C.push(E)}this.speechContext.getContext().invocationSource=s.InvocationSource.VoiceActivationWithKeyword,this.speechContext.getContext().keywordDetection=[{clientDetectedKeywords:C,onReject:{action:c.OnRejectAction.EndOfTurn},type:c.KeywordDetectionType.StartTrigger}]}};return _r.DialogServiceAdapter=d,_r}var Rn={};Object.defineProperty(Rn,"__esModule",{value:!0});Rn.AgentConfig=void 0;class eg{toJsonString(){return JSON.stringify(this.iPrivConfig)}get(){return this.iPrivConfig}set(e){this.iPrivConfig=e}}Rn.AgentConfig=eg;var Kn={},br={},it={};Object.defineProperty(it,"__esModule",{value:!0});it.ConversationConnectionConfig=void 0;const tg=ii;class Z extends tg.RestConfigBase{static get host(){return Z.privHost}static get apiVersion(){return Z.privApiVersion}static get clientAppId(){return Z.privClientAppId}static get defaultLanguageCode(){return Z.privDefaultLanguageCode}static get restPath(){return Z.privRestPath}static get webSocketPath(){return Z.privWebSocketPath}static get transcriptionEventKeys(){return Z.privTranscriptionEventKeys}}it.ConversationConnectionConfig=Z;Z.privHost="dev.microsofttranslator.com";Z.privRestPath="/capito/room";Z.privApiVersion="2.0";Z.privDefaultLanguageCode="en-US";Z.privClientAppId="FC539C22-1767-4F1F-84BC-B4D811114F15";Z.privWebSocketPath="/capito/translate";Z.privTranscriptionEventKeys=["iCalUid","callId","organizer","FLAC","MTUri","DifferentiateGuestSpeakers","audiorecording","Threadid","OrganizerMri","OrganizerTenantId","UserToken"];var Wa;function rg(){if(Wa)return br;Wa=1,Object.defineProperty(br,"__esModule",{value:!0}),br.ConversationManager=void 0;const t=x(),e=b,r=P(),o=it;let p=class{constructor(){this.privRequestParams=o.ConversationConnectionConfig.configParams,this.privErrors=o.ConversationConnectionConfig.restErrors,this.privHost=o.ConversationConnectionConfig.host,this.privApiVersion=o.ConversationConnectionConfig.apiVersion,this.privRestPath=o.ConversationConnectionConfig.restPath,this.privRestAdapter=new t.RestMessageAdapter({})}createOrJoin(n,i,s,c){try{e.Contracts.throwIfNullOrUndefined(n,"args");const u=n.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage,o.ConversationConnectionConfig.defaultLanguageCode),d=n.getProperty(r.PropertyId.ConversationTranslator_Name,"conversation_host"),h=n.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),l=n.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),f=n.getProperty(r.PropertyId.SpeechServiceConnection_Key),g=n.getProperty(r.PropertyId.SpeechServiceConnection_Region),S=n.getProperty(r.PropertyId.SpeechServiceAuthorization_Token);e.Contracts.throwIfNullOrWhitespace(u,"languageCode"),e.Contracts.throwIfNullOrWhitespace(d,"nickname"),e.Contracts.throwIfNullOrWhitespace(h,"endpointHost");const v={};v[this.privRequestParams.apiVersion]=this.privApiVersion,v[this.privRequestParams.languageCode]=u,v[this.privRequestParams.nickname]=d;const m={};l&&(m[this.privRequestParams.correlationId]=l),m[this.privRequestParams.clientAppId]=o.ConversationConnectionConfig.clientAppId,i!==void 0?v[this.privRequestParams.roomId]=i:(e.Contracts.throwIfNullOrUndefined(g,this.privErrors.authInvalidSubscriptionRegion),m[this.privRequestParams.subscriptionRegion]=g,f?m[this.privRequestParams.subscriptionKey]=f:S?m[this.privRequestParams.authorization]=`Bearer ${S}`:e.Contracts.throwIfNullOrUndefined(f,this.privErrors.authInvalidSubscriptionKey));const C={};C.headers=m,this.privRestAdapter.options=C;const y=`https://${h}${this.privRestPath}`;this.privRestAdapter.request(t.RestRequestType.Post,y,v,null).then(E=>{const I=t.RestMessageAdapter.extractHeaderValue(this.privRequestParams.requestId,E.headers);if(!E.ok){if(c){let R=this.privErrors.invalidCreateJoinConversationResponse.replace("{status}",E.status.toString()),z;try{z=JSON.parse(E.data),R+=` [${z.error.code}: ${z.error.message}]`}catch{R+=` [${E.data}]`}I&&(R+=` ${I}`),c(R)}return}const w=JSON.parse(E.data);if(w&&(w.requestId=I),s){try{s(w)}catch(R){c&&c(R)}s=void 0}}).catch(()=>{})}catch(u){if(c)if(u instanceof Error){const d=u;c(d.name+": "+d.message)}else c(u)}}leave(n,i){return new Promise((s,c)=>{try{e.Contracts.throwIfNullOrUndefined(n,this.privErrors.invalidArgs.replace("{arg}","config")),e.Contracts.throwIfNullOrWhitespace(i,this.privErrors.invalidArgs.replace("{arg}","token"));const u=n.getProperty(r.PropertyId.ConversationTranslator_Host,this.privHost),d=n.getProperty(r.PropertyId.ConversationTranslator_CorrelationId),h={};h[this.privRequestParams.apiVersion]=this.privApiVersion,h[this.privRequestParams.sessionToken]=i;const l={};d&&(l[this.privRequestParams.correlationId]=d);const f={};f.headers=l,this.privRestAdapter.options=f;const g=`https://${u}${this.privRestPath}`;this.privRestAdapter.request(t.RestRequestType.Delete,g,h,null).then(S=>{S.ok,s()}).catch(()=>{})}catch(u){if(u instanceof Error){const d=u;c(d.name+": "+d.message)}else c(u)}})}};return br.ConversationManager=p,br}var Ue={},Mr={},En={},ni={};Object.defineProperty(ni,"__esModule",{value:!0});ni.ConversationConnectionMessage=void 0;const ig=A();class ng extends ig.ConnectionMessage{constructor(e,r,o,p){super(e,r,o,p);const a=JSON.parse(this.textBody);a.type!==void 0&&(this.privConversationMessageType=a.type)}get conversationMessageType(){return this.privConversationMessageType}}ni.ConversationConnectionMessage=ng;Object.defineProperty(En,"__esModule",{value:!0});En.ConversationWebsocketMessageFormatter=void 0;const We=A(),Va=ni;class sg{toConnectionMessage(e){const r=new We.Deferred;try{if(e.messageType===We.MessageType.Text){const o=new Va.ConversationConnectionMessage(e.messageType,e.textContent,{},e.id);r.resolve(o)}else e.messageType===We.MessageType.Binary&&r.resolve(new Va.ConversationConnectionMessage(e.messageType,e.binaryContent,void 0,e.id))}catch(o){r.reject(`Error formatting the message. Error: ${o}`)}return r.promise}fromConnectionMessage(e){const r=new We.Deferred;try{if(e.messageType===We.MessageType.Text){const o=`${e.textBody?e.textBody:""}`;r.resolve(new We.RawWebsocketMessage(We.MessageType.Text,o,e.id))}}catch(o){r.reject(`Error formatting the message. ${o}`)}return r.promise}}En.ConversationWebsocketMessageFormatter=sg;var Ha;function og(){if(Ha)return Mr;Ha=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.ConversationConnectionFactory=void 0;const t=x(),e=A(),r=b,o=P(),p=ue(),a=it,n=En;let i=class extends p.ConnectionFactoryBase{create(c,u,d){const h=c.parameters.getProperty(o.PropertyId.ConversationTranslator_Host,a.ConversationConnectionConfig.host),l=c.parameters.getProperty(o.PropertyId.ConversationTranslator_CorrelationId,(0,e.createGuid)()),f=`wss://${h}${a.ConversationConnectionConfig.webSocketPath}`,g=c.parameters.getProperty(o.PropertyId.ConversationTranslator_Token,void 0);r.Contracts.throwIfNullOrUndefined(g,"token");const S={};S[a.ConversationConnectionConfig.configParams.apiVersion]=a.ConversationConnectionConfig.apiVersion,S[a.ConversationConnectionConfig.configParams.token]=g,S[a.ConversationConnectionConfig.configParams.correlationId]=l;const v=c.parameters.getProperty("SPEECH-EnableWebsocketCompression","false")==="true";return Promise.resolve(new t.WebsocketConnection(f,S,{},new n.ConversationWebsocketMessageFormatter,t.ProxyInfo.fromRecognizerConfig(c),v,d))}};return Mr.ConversationConnectionFactory=i,Mr}var Or={},In={};Object.defineProperty(In,"__esModule",{value:!0});In.ConversationRequestSession=void 0;const Jn=A();class ag{constructor(e){this.privIsDisposed=!1,this.privDetachables=new Array,this.privSessionId=e,this.privRequestId=(0,Jn.createNoDashGuid)(),this.privRequestCompletionDeferral=new Jn.Deferred}get sessionId(){return this.privSessionId}get requestId(){return this.privRequestId}get completionPromise(){return this.privRequestCompletionDeferral.promise}onPreConnectionStart(e,r){this.privSessionId=r}onAuthCompleted(e){e&&this.onComplete()}onConnectionEstablishCompleted(e){e!==200&&e===403&&this.onComplete()}onServiceTurnEndResponse(e){e?this.privRequestId=(0,Jn.createNoDashGuid)():this.onComplete()}async dispose(){if(!this.privIsDisposed){this.privIsDisposed=!0;for(const e of this.privDetachables)await e.detach()}}onComplete(){}}In.ConversationRequestSession=ag;var ee={},$a;function Vp(){if($a)return ee;$a=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.ConversationReceivedTranslationEventArgs=ee.ParticipantsListEventArgs=ee.ParticipantAttributeEventArgs=ee.ParticipantEventArgs=ee.LockRoomEventArgs=ee.MuteAllEventArgs=void 0;const t=P();class e extends t.SessionEventArgs{constructor(s,c){super(c),this.privIsMuted=s}get isMuted(){return this.privIsMuted}}ee.MuteAllEventArgs=e;class r extends t.SessionEventArgs{constructor(s,c){super(c),this.privIsLocked=s}get isMuted(){return this.privIsLocked}}ee.LockRoomEventArgs=r;class o extends t.SessionEventArgs{constructor(s,c){super(c),this.privParticipant=s}get participant(){return this.privParticipant}}ee.ParticipantEventArgs=o;class p extends t.SessionEventArgs{constructor(s,c,u,d){super(d),this.privKey=c,this.privValue=u,this.privParticipantId=s}get value(){return this.privValue}get key(){return this.privKey}get id(){return this.privParticipantId}}ee.ParticipantAttributeEventArgs=p;class a extends t.SessionEventArgs{constructor(s,c,u,d,h,l,f,g,S){super(S),this.privRoomId=s,this.privSessionToken=c,this.privTranslateTo=u,this.privProfanityFilter=d,this.privRoomProfanityFilter=h,this.privIsRoomLocked=l,this.privIsRoomLocked=f,this.privParticipants=g}get sessionToken(){return this.privSessionToken}get conversationId(){return this.privRoomId}get translateTo(){return this.privTranslateTo}get profanityFilter(){return this.privProfanityFilter}get roomProfanityFilter(){return this.privRoomProfanityFilter}get isRoomLocked(){return this.privIsRoomLocked}get isMuteAll(){return this.privIsMuteAll}get participants(){return this.privParticipants}}ee.ParticipantsListEventArgs=a;class n{constructor(s,c,u){this.privPayload=c,this.privCommand=s,this.privSessionId=u}get payload(){return this.privPayload}get command(){return this.privCommand}get sessionId(){return this.privSessionId}}return ee.ConversationReceivedTranslationEventArgs=n,ee}var ge={};Object.defineProperty(ge,"__esModule",{value:!0});ge.ConversationTranslatorCommandTypes=ge.ConversationTranslatorMessageTypes=ge.InternalParticipants=void 0;class cg{constructor(e=[],r){this.participants=e,this.meId=r}addOrUpdateParticipant(e){if(e===void 0)return;const r=this.getParticipantIndex(e.id);return r>-1?this.participants.splice(r,1,e):this.participants.push(e),this.getParticipant(e.id)}getParticipantIndex(e){return this.participants.findIndex(r=>r.id===e)}getParticipant(e){return this.participants.find(r=>r.id===e)}deleteParticipant(e){this.participants=this.participants.filter(r=>r.id!==e)}get host(){return this.participants.find(e=>e.isHost===!0)}get me(){return this.getParticipant(this.meId)}}ge.InternalParticipants=cg;ge.ConversationTranslatorMessageTypes={command:"command",final:"final",info:"info",instantMessage:"instant_message",keepAlive:"keep_alive",partial:"partial",participantCommand:"participant_command",translatedMessage:"translated_message"};ge.ConversationTranslatorCommandTypes={changeNickname:"ChangeNickname",disconnectSession:"DisconnectSession",ejectParticipant:"EjectParticipant",instant_message:"instant_message",joinSession:"JoinSession",leaveSession:"LeaveSession",participantList:"ParticipantList",roomExpirationWarning:"RoomExpirationWarning",setLockState:"SetLockState",setMute:"SetMute",setMuteAll:"SetMuteAll",setProfanityFiltering:"SetProfanityFiltering",setTranslateToLanguages:"SetTranslateToLanguages",setUseTTS:"SetUseTTS"};var Hp={},Tn={};Object.defineProperty(Tn,"__esModule",{value:!0});Tn.CommandResponsePayload=void 0;const pg=t=>JSON.parse(t);class Is{constructor(e){this.privCommandResponse=pg(e)}get type(){return this.privCommandResponse.type}get command(){return this.privCommandResponse.command}get id(){return this.privCommandResponse.id}get nickname(){return this.privCommandResponse.nickname}get participantId(){return this.privCommandResponse.participantId}get roomid(){return this.privCommandResponse.roomid}get value(){return this.privCommandResponse.value}get token(){return this.privCommandResponse.token}static fromJSON(e){return new Is(e)}}Tn.CommandResponsePayload=Is;var Ze={};Object.defineProperty(Ze,"__esModule",{value:!0});Ze.ParticipantPayloadResponse=Ze.ParticipantsListPayloadResponse=void 0;const ug=t=>JSON.parse(t),dg=t=>JSON.parse(t);class Ts{constructor(e){this.privParticipantsPayloadResponse=ug(e)}get roomid(){return this.privParticipantsPayloadResponse.roomid}get id(){return this.privParticipantsPayloadResponse.id}get command(){return this.privParticipantsPayloadResponse.command}get participants(){return this.privParticipantsPayloadResponse.participants}get token(){return this.privParticipantsPayloadResponse.token}get translateTo(){return this.privParticipantsPayloadResponse.translateTo}get profanityFilter(){return this.privParticipantsPayloadResponse.profanityFilter}get roomProfanityFilter(){return this.privParticipantsPayloadResponse.roomProfanityFilter}get roomLocked(){return this.privParticipantsPayloadResponse.roomLocked}get muteAll(){return this.privParticipantsPayloadResponse.muteAll}get type(){return this.privParticipantsPayloadResponse.type}static fromJSON(e){return new Ts(e)}}Ze.ParticipantsListPayloadResponse=Ts;class As{constructor(e){this.privParticipantPayloadResponse=dg(e)}get nickname(){return this.privParticipantPayloadResponse.nickname}get locale(){return this.privParticipantPayloadResponse.locale}get usetts(){return this.privParticipantPayloadResponse.usetts}get ismuted(){return this.privParticipantPayloadResponse.ismuted}get ishost(){return this.privParticipantPayloadResponse.ishost}get participantId(){return this.privParticipantPayloadResponse.participantId}get avatar(){return this.privParticipantPayloadResponse.avatar}static fromJSON(e){return new As(e)}}Ze.ParticipantPayloadResponse=As;var Ye={};Object.defineProperty(Ye,"__esModule",{value:!0});Ye.TextResponsePayload=Ye.SpeechResponsePayload=void 0;const hg=t=>JSON.parse(t),lg=t=>JSON.parse(t);class ws{constructor(e){this.privSpeechResponse=hg(e)}get recognition(){return this.privSpeechResponse.recognition}get translations(){return this.privSpeechResponse.translations}get id(){return this.privSpeechResponse.id}get language(){return this.privSpeechResponse.language}get nickname(){return this.privSpeechResponse.nickname}get participantId(){return this.privSpeechResponse.participantId}get roomid(){return this.privSpeechResponse.roomid}get timestamp(){return this.privSpeechResponse.timestamp}get type(){return this.privSpeechResponse.type}get isFinal(){return this.privSpeechResponse.type==="final"}static fromJSON(e){return new ws(e)}}Ye.SpeechResponsePayload=ws;class _s{constructor(e){this.privTextResponse=lg(e)}get originalText(){return this.privTextResponse.originalText}get translations(){return this.privTextResponse.translations}get id(){return this.privTextResponse.id}get language(){return this.privTextResponse.language}get nickname(){return this.privTextResponse.nickname}get participantId(){return this.privTextResponse.participantId}get roomid(){return this.privTextResponse.roomid}get timestamp(){return this.privTextResponse.timestamp}get type(){return this.privTextResponse.type}static fromJSON(e){return new _s(e)}}Ye.TextResponsePayload=_s;(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.TextResponsePayload=t.SpeechResponsePayload=t.ParticipantPayloadResponse=t.ParticipantsListPayloadResponse=t.CommandResponsePayload=void 0;var e=Tn;Object.defineProperty(t,"CommandResponsePayload",{enumerable:!0,get:function(){return e.CommandResponsePayload}});var r=Ze;Object.defineProperty(t,"ParticipantsListPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantsListPayloadResponse}}),Object.defineProperty(t,"ParticipantPayloadResponse",{enumerable:!0,get:function(){return r.ParticipantPayloadResponse}});var o=Ye;Object.defineProperty(t,"SpeechResponsePayload",{enumerable:!0,get:function(){return o.SpeechResponsePayload}}),Object.defineProperty(t,"TextResponsePayload",{enumerable:!0,get:function(){return o.TextResponsePayload}})})(Hp);var Ka;function vg(){if(Ka)return Or;Ka=1,Object.defineProperty(Or,"__esModule",{value:!0}),Or.ConversationServiceAdapter=void 0;const t=A(),e=P(),r=T(),o=ni,p=In,a=Vp(),n=ge,i=Hp;let s=class extends r.ServiceRecognizerBase{constructor(u,d,h,l,f){super(u,d,h,l,f),this.privConnectionConfigPromise=void 0,this.privLastPartialUtteranceId="",this.privConversationServiceConnector=f,this.privConversationAuthentication=u,this.receiveMessageOverride=()=>this.receiveConversationMessageOverride(),this.recognizeOverride=()=>this.noOp(),this.postConnectImplOverride=g=>this.conversationConnectImpl(g),this.configConnectionOverride=()=>this.configConnection(),this.disconnectOverride=()=>this.privDisconnect(),this.privConversationRequestSession=new p.ConversationRequestSession((0,t.createNoDashGuid)()),this.privConversationConnectionFactory=d,this.privConversationIsDisposed=!1}isDisposed(){return super.isDisposed()||this.privConversationIsDisposed}async dispose(u){this.privConversationIsDisposed=!0,this.privConnectionConfigPromise!==void 0&&await(await this.privConnectionConfigPromise).dispose(u),await super.dispose(u)}async sendMessage(u){return(await this.fetchConnection()).send(new o.ConversationConnectionMessage(t.MessageType.Text,u))}async sendMessageAsync(u){await(await this.fetchConnection()).send(new o.ConversationConnectionMessage(t.MessageType.Text,u))}privDisconnect(){if(!this.terminateMessageLoop)return this.cancelRecognition(this.privConversationRequestSession.sessionId,this.privConversationRequestSession.requestId,e.CancellationReason.Error,e.CancellationErrorCode.NoError,"Disconnecting"),this.terminateMessageLoop=!0,Promise.resolve()}async processTypeSpecificMessages(){return!0}cancelRecognition(u,d,h,l,f){this.terminateMessageLoop=!0;const g=new e.ConversationTranslationCanceledEventArgs(h,f,l,void 0,u);try{this.privConversationServiceConnector.canceled&&this.privConversationServiceConnector.canceled(this.privConversationServiceConnector,g)}catch{}}async conversationConnectImpl(u){return this.privConnectionLoop=this.startMessageLoop(),u}async receiveConversationMessageOverride(){if(this.isDisposed()||this.terminateMessageLoop)return Promise.resolve();const u=new t.Deferred;try{const h=await(await this.fetchConnection()).read();if(this.isDisposed()||this.terminateMessageLoop)return u.resolve(),Promise.resolve();if(!h)return this.receiveConversationMessageOverride();const l=this.privConversationRequestSession.sessionId,f=h.conversationMessageType.toLowerCase();let g=!1;try{switch(f){case"info":case"participant_command":case"command":const S=i.CommandResponsePayload.fromJSON(h.textBody);switch(S.command.toLowerCase()){case"participantlist":const I=i.ParticipantsListPayloadResponse.fromJSON(h.textBody),w=I.participants.map(Y=>({avatar:Y.avatar,displayName:Y.nickname,id:Y.participantId,isHost:Y.ishost,isMuted:Y.ismuted,isUsingTts:Y.usetts,preferredLanguage:Y.locale}));this.privConversationServiceConnector.participantsListReceived&&this.privConversationServiceConnector.participantsListReceived(this.privConversationServiceConnector,new a.ParticipantsListEventArgs(I.roomid,I.token,I.translateTo,I.profanityFilter,I.roomProfanityFilter,I.roomLocked,I.muteAll,w,l));break;case"settranslatetolanguages":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,n.ConversationTranslatorCommandTypes.setTranslateToLanguages,S.value,l));break;case"setprofanityfiltering":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,n.ConversationTranslatorCommandTypes.setProfanityFiltering,S.value,l));break;case"setmute":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,n.ConversationTranslatorCommandTypes.setMute,S.value,l));break;case"setmuteall":this.privConversationServiceConnector.muteAllCommandReceived&&this.privConversationServiceConnector.muteAllCommandReceived(this.privConversationServiceConnector,new a.MuteAllEventArgs(S.value,l));break;case"roomexpirationwarning":this.privConversationServiceConnector.conversationExpiration&&this.privConversationServiceConnector.conversationExpiration(this.privConversationServiceConnector,new e.ConversationExpirationEventArgs(S.value,this.privConversationRequestSession.sessionId));break;case"setusetts":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,n.ConversationTranslatorCommandTypes.setUseTTS,S.value,l));break;case"setlockstate":this.privConversationServiceConnector.lockRoomCommandReceived&&this.privConversationServiceConnector.lockRoomCommandReceived(this.privConversationServiceConnector,new a.LockRoomEventArgs(S.value,l));break;case"changenickname":this.privConversationServiceConnector.participantUpdateCommandReceived&&this.privConversationServiceConnector.participantUpdateCommandReceived(this.privConversationServiceConnector,new a.ParticipantAttributeEventArgs(S.participantId,n.ConversationTranslatorCommandTypes.changeNickname,S.value,l));break;case"joinsession":const R=i.ParticipantPayloadResponse.fromJSON(h.textBody),z={avatar:R.avatar,displayName:R.nickname,id:R.participantId,isHost:R.ishost,isMuted:R.ismuted,isUsingTts:R.usetts,preferredLanguage:R.locale};this.privConversationServiceConnector.participantJoinCommandReceived&&this.privConversationServiceConnector.participantJoinCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(z,l));break;case"leavesession":const L={id:S.participantId};this.privConversationServiceConnector.participantLeaveCommandReceived&&this.privConversationServiceConnector.participantLeaveCommandReceived(this.privConversationServiceConnector,new a.ParticipantEventArgs(L,l));break;case"disconnectsession":const se={id:S.participantId};break;case"token":const Ke=new r.CognitiveTokenAuthentication(()=>{const Y=S.token;return Promise.resolve(Y)},()=>{const Y=S.token;return Promise.resolve(Y)});this.authentication=Ke,this.privConversationServiceConnector.onToken(Ke);break;default:break}break;case"partial":case"final":const v=i.SpeechResponsePayload.fromJSON(h.textBody),m=f==="final"?e.ResultReason.TranslatedParticipantSpeech:e.ResultReason.TranslatingParticipantSpeech,C=new e.ConversationTranslationResult(v.participantId,this.getTranslations(v.translations),v.language,v.id,m,v.recognition,void 0,void 0,h.textBody,void 0);v.isFinal?((C.text!==void 0&&C.text.length>0||v.id===this.privLastPartialUtteranceId)&&(g=!0),g&&this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(n.ConversationTranslatorMessageTypes.final,C,l))):C.text!==void 0&&(this.privLastPartialUtteranceId=v.id,this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(n.ConversationTranslatorMessageTypes.partial,C,l)));break;case"translated_message":const y=i.TextResponsePayload.fromJSON(h.textBody),E=new e.ConversationTranslationResult(y.participantId,this.getTranslations(y.translations),y.language,void 0,void 0,y.originalText,void 0,void 0,void 0,h.textBody,void 0);this.privConversationServiceConnector.translationReceived&&this.privConversationServiceConnector.translationReceived(this.privConversationServiceConnector,new a.ConversationReceivedTranslationEventArgs(n.ConversationTranslatorMessageTypes.instantMessage,E,l));break;default:break}}catch{}return this.receiveConversationMessageOverride()}catch{this.terminateMessageLoop=!0}return u.promise}async startMessageLoop(){if(this.isDisposed())return Promise.resolve();this.terminateMessageLoop=!1;const u=this.receiveConversationMessageOverride();try{return await u}catch(d){return this.cancelRecognition(this.privRequestSession?this.privRequestSession.sessionId:"",this.privRequestSession?this.privRequestSession.requestId:"",e.CancellationReason.Error,e.CancellationErrorCode.RuntimeError,d),null}}configConnection(){return this.isDisposed()?Promise.resolve(void 0):this.privConnectionConfigPromise!==void 0?this.privConnectionConfigPromise.then(u=>u.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection()):this.privConnectionConfigPromise,()=>(this.privConnectionId=null,this.privConnectionConfigPromise=void 0,this.configConnection())):this.terminateMessageLoop?Promise.resolve(void 0):(this.privConnectionConfigPromise=this.connectImpl().then(u=>u),this.privConnectionConfigPromise)}getTranslations(u){let d;if(u!==void 0){d=new e.Translations;for(const h of u)d.set(h.lang,h.translation)}return d}};return Or.ConversationServiceAdapter=s,Or}var Ja;function fg(){if(Ja)return Ue;Ja=1,Object.defineProperty(Ue,"__esModule",{value:!0}),Ue.ConversationTranslatorRecognizer=Ue.ConversationRecognizerFactory=void 0;const t=T(),e=A(),r=b,o=P(),p=og(),a=vg();class n{static fromConfig(c,u,d){return new i(c,u,d)}}Ue.ConversationRecognizerFactory=n;let i=class extends o.Recognizer{constructor(c,u,d){const h=u;r.Contracts.throwIfNull(h,"speechConfig");const l=c;r.Contracts.throwIfNull(l,"conversationImpl"),super(d,h.properties,new p.ConversationConnectionFactory),this.privConversation=l,this.privIsDisposed=!1,this.privProperties=h.properties.clone(),this.privConnection=o.Connection.fromRecognizer(this),this.privProperties.getProperty(o.PropertyId.WebWorkerLoadType,"on").toLowerCase()==="on"&&typeof Blob<"u"&&typeof Worker<"u"?(this.privSetTimeout=e.Timeout.setTimeout,this.privClearTimeout=e.Timeout.clearTimeout):typeof window<"u"?(this.privSetTimeout=window.setTimeout.bind(window),this.privClearTimeout=window.clearTimeout.bind(window)):(this.privSetTimeout=setTimeout,this.privClearTimeout=clearTimeout)}set connected(c){this.privConnection.connected=c}set disconnected(c){this.privConnection.disconnected=c}get speechRecognitionLanguage(){return this.privSpeechRecognitionLanguage}get properties(){return this.privProperties}isDisposed(){return this.privIsDisposed}connect(c,u,d){try{r.Contracts.throwIfDisposed(this.privIsDisposed),r.Contracts.throwIfNullOrWhitespace(c,"token"),this.privReco.conversationTranslatorToken=c,this.resetConversationTimeout(),this.privReco.connectAsync(u,d)}catch(h){if(d)if(h instanceof Error){const l=h;d(l.name+": "+l.message)}else d(h)}}disconnect(c,u){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privReco.disconnect().then(()=>{c&&c()},d=>{u&&u(d)})}catch(d){if(u)if(d instanceof Error){const h=d;u(h.name+": "+h.message)}else u(d);this.dispose(!0).catch(h=>{e.Events.instance.onEvent(new e.BackgroundEvent(h))})}}sendRequest(c,u,d){try{r.Contracts.throwIfDisposed(this.privIsDisposed),this.sendMessage(c,u,d)}catch(h){if(d)if(h instanceof Error){const l=h;d(l.name+": "+l.message)}else d(h);this.dispose(!0).catch(l=>{e.Events.instance.onEvent(new e.BackgroundEvent(l))})}}onToken(c){this.privConversation.onToken(c)}async close(){this.privIsDisposed||(this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close()),this.privConnection=void 0,await this.dispose(!0))}async dispose(c){this.privIsDisposed||c&&(this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privIsDisposed=!0,this.privConnection&&(this.privConnection.closeConnection(),this.privConnection.close(),this.privConnection=void 0),await super.dispose(c))}createRecognizerConfig(c){return new t.RecognizerConfig(c,this.privProperties)}createServiceRecognizer(c,u,d,h){const l=d;return new a.ConversationServiceAdapter(c,u,l,h,this)}sendMessage(c,u,d){const h=this.privReco;((f,g,S)=>{f!==void 0?f.then(()=>{try{g&&g()}catch(v){S&&S(`'Unhandled error on promise callback: ${v}'`)}},v=>{try{S&&S(v)}catch{}}):S&&S("Null promise")})(h.sendMessageAsync(c),u,d),this.resetConversationTimeout()}resetConversationTimeout(){this.privTimeoutToken!==void 0&&this.privClearTimeout(this.privTimeoutToken),this.privTimeoutToken=this.privSetTimeout(()=>{this.sendRequest(this.privConversation.getKeepAlive())},6e4)}};return Ue.ConversationTranslatorRecognizer=i,Ue}var Dr={},Ga;function gg(){if(Ga)return Dr;Ga=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.TranscriberRecognizer=void 0;const t=A(),e=b,r=P(),o=T(),p=ne;let a=class extends r.Recognizer{constructor(i,s){const c=i;e.Contracts.throwIfNull(c,"speechTranslationConfig");const u=s;e.Contracts.throwIfNull(u,"audioConfigImpl"),e.Contracts.throwIfNullOrWhitespace(c.speechRecognitionLanguage,r.PropertyId[r.PropertyId.SpeechServiceConnection_RecoLanguage]),super(s,c.properties,new o.TranscriberConnectionFactory),this.privDisposedRecognizer=!1,this.isMeetingRecognizer=!1}get speechRecognitionLanguage(){return e.Contracts.throwIfDisposed(this.privDisposedRecognizer),this.properties.getProperty(r.PropertyId.SpeechServiceConnection_RecoLanguage)}get properties(){return this.privProperties}get authorizationToken(){return this.properties.getProperty(r.PropertyId.SpeechServiceAuthorization_Token)}set authorizationToken(i){e.Contracts.throwIfNullOrWhitespace(i,"token"),this.properties.setProperty(r.PropertyId.SpeechServiceAuthorization_Token,i)}set conversation(i){e.Contracts.throwIfNullOrUndefined(i,"Conversation"),this.isMeetingRecognizer=!1,this.privConversation=i}getConversationInfo(){return e.Contracts.throwIfNullOrUndefined(this.privConversation,"Conversation"),this.privConversation.conversationInfo}set meeting(i){e.Contracts.throwIfNullOrUndefined(i,"Meeting"),this.isMeetingRecognizer=!0,this.privMeeting=i}getMeetingInfo(){return e.Contracts.throwIfNullOrUndefined(this.privMeeting,"Meeting"),this.privMeeting.meetingInfo}IsMeetingRecognizer(){return this.isMeetingRecognizer}startContinuousRecognitionAsync(i,s){(0,t.marshalPromiseToCallbacks)(this.startContinuousRecognitionAsyncImpl(p.RecognitionMode.Conversation),i,s)}stopContinuousRecognitionAsync(i,s){(0,t.marshalPromiseToCallbacks)(this.stopContinuousRecognitionAsyncImpl(),i,s)}async close(){this.privDisposedRecognizer||await this.dispose(!0)}async pushConversationEvent(i,s){const c=this.privReco;e.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendSpeechEventAsync(i,s)}async pushMeetingEvent(i,s){const c=this.privReco;e.Contracts.throwIfNullOrUndefined(c,"serviceRecognizer"),await c.sendMeetingSpeechEventAsync(i,s)}async enforceAudioGating(){const c=(await this.audioConfig.format).channels;if(c===1){if(this.properties.getProperty("f0f5debc-f8c9-4892-ac4b-90a7ab359fd2","false").toLowerCase()!=="true")throw new Error("Single channel audio configuration for MeetingTranscriber is currently under private preview, please contact diarizationrequest@microsoft.com for more details")}else if(c!==8)throw new Error(`Unsupported audio configuration: Detected ${c}-channel audio`)}connectMeetingCallbacks(i){this.isMeetingRecognizer=!0,this.canceled=(s,c)=>{i.canceled&&i.canceled(i,c)},this.recognizing=(s,c)=>{i.transcribing&&i.transcribing(i,c)},this.recognized=(s,c)=>{i.transcribed&&i.transcribed(i,c)},this.sessionStarted=(s,c)=>{i.sessionStarted&&i.sessionStarted(i,c)},this.sessionStopped=(s,c)=>{i.sessionStopped&&i.sessionStopped(i,c)}}disconnectCallbacks(){this.canceled=void 0,this.recognizing=void 0,this.recognized=void 0,this.sessionStarted=void 0,this.sessionStopped=void 0}async dispose(i){this.privDisposedRecognizer||(i&&(this.privDisposedRecognizer=!0,await this.implRecognizerStop()),await super.dispose(i))}createRecognizerConfig(i){return new o.RecognizerConfig(i,this.properties)}createServiceRecognizer(i,s,c,u){const d=c;return new o.TranscriptionServiceRecognizer(i,s,d,u,this)}};return Dr.TranscriberRecognizer=a,Dr}var Qa;function mg(){return Qa||(Qa=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.InternalParticipants=t.ConversationTranslatorMessageTypes=t.ConversationTranslatorCommandTypes=t.ParticipantsListEventArgs=t.ParticipantEventArgs=t.ParticipantAttributeEventArgs=t.MuteAllEventArgs=t.LockRoomEventArgs=t.ConversationReceivedTranslationEventArgs=t.TranscriberRecognizer=t.ConversationRecognizerFactory=t.ConversationConnectionConfig=t.ConversationManager=void 0;var e=rg();Object.defineProperty(t,"ConversationManager",{enumerable:!0,get:function(){return e.ConversationManager}});var r=it;Object.defineProperty(t,"ConversationConnectionConfig",{enumerable:!0,get:function(){return r.ConversationConnectionConfig}});var o=fg();Object.defineProperty(t,"ConversationRecognizerFactory",{enumerable:!0,get:function(){return o.ConversationRecognizerFactory}});var p=gg();Object.defineProperty(t,"TranscriberRecognizer",{enumerable:!0,get:function(){return p.TranscriberRecognizer}});var a=Vp();Object.defineProperty(t,"ConversationReceivedTranslationEventArgs",{enumerable:!0,get:function(){return a.ConversationReceivedTranslationEventArgs}}),Object.defineProperty(t,"LockRoomEventArgs",{enumerable:!0,get:function(){return a.LockRoomEventArgs}}),Object.defineProperty(t,"MuteAllEventArgs",{enumerable:!0,get:function(){return a.MuteAllEventArgs}}),Object.defineProperty(t,"ParticipantAttributeEventArgs",{enumerable:!0,get:function(){return a.ParticipantAttributeEventArgs}}),Object.defineProperty(t,"ParticipantEventArgs",{enumerable:!0,get:function(){return a.ParticipantEventArgs}}),Object.defineProperty(t,"ParticipantsListEventArgs",{enumerable:!0,get:function(){return a.ParticipantsListEventArgs}});var n=ge;Object.defineProperty(t,"ConversationTranslatorCommandTypes",{enumerable:!0,get:function(){return n.ConversationTranslatorCommandTypes}}),Object.defineProperty(t,"ConversationTranslatorMessageTypes",{enumerable:!0,get:function(){return n.ConversationTranslatorMessageTypes}}),Object.defineProperty(t,"InternalParticipants",{enumerable:!0,get:function(){return n.InternalParticipants}})}(Kn)),Kn}var bs={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SynthesisAudioMetadata=t.MetadataType=void 0,function(r){r.WordBoundary="WordBoundary",r.Bookmark="Bookmark",r.Viseme="Viseme",r.SentenceBoundary="SentenceBoundary",r.SessionEnd="SessionEnd",r.AvatarSignal="TalkingAvatarSignal"}(t.MetadataType||(t.MetadataType={}));class e{constructor(o){this.privSynthesisAudioMetadata=JSON.parse(o)}static fromJSON(o){return new e(o)}get Metadata(){return this.privSynthesisAudioMetadata.Metadata}}t.SynthesisAudioMetadata=e})(bs);var kr={},de={};Object.defineProperty(de,"__esModule",{value:!0});de.SynthesisStartedEvent=de.ConnectingToSynthesisServiceEvent=de.SynthesisTriggeredEvent=de.SpeechSynthesisEvent=void 0;const Xa=A();class An extends Xa.PlatformEvent{constructor(e,r,o=Xa.EventType.Info){super(e,o),this.privRequestId=r}get requestId(){return this.privRequestId}}de.SpeechSynthesisEvent=An;class Sg extends An{constructor(e,r,o){super("SynthesisTriggeredEvent",e),this.privSessionAudioDestinationId=r,this.privTurnAudioDestinationId=o}get audioSessionDestinationId(){return this.privSessionAudioDestinationId}get audioTurnDestinationId(){return this.privTurnAudioDestinationId}}de.SynthesisTriggeredEvent=Sg;class Cg extends An{constructor(e,r){super("ConnectingToSynthesisServiceEvent",e),this.privAuthFetchEventId=r}get authFetchEventId(){return this.privAuthFetchEventId}}de.ConnectingToSynthesisServiceEvent=Cg;class yg extends An{constructor(e,r){super("SynthesisStartedEvent",e),this.privAuthFetchEventId=r}get authFetchEventId(){return this.privAuthFetchEventId}}de.SynthesisStartedEvent=yg;var Za;function Pg(){if(Za)return kr;Za=1,Object.defineProperty(kr,"__esModule",{value:!0}),kr.SynthesisTurn=void 0;const t=A(),e=W,r=P(),o=bs,p=de;let a=class ts{constructor(){this.privIsDisposed=!1,this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!1,this.privBytesReceived=0,this.privInTurn=!1,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privRequestId=(0,t.createNoDashGuid)(),this.privTurnDeferral=new t.Deferred,this.privTurnDeferral.resolve()}get requestId(){return this.privRequestId}get streamId(){return this.privStreamId}set streamId(i){this.privStreamId=i}get audioOutputFormat(){return this.privAudioOutputFormat}set audioOutputFormat(i){this.privAudioOutputFormat=i}get turnCompletionPromise(){return this.privTurnDeferral.promise}get isSynthesisEnded(){return this.privIsSynthesisEnded}get isSynthesizing(){return this.privIsSynthesizing}get currentTextOffset(){return this.privTextOffset}get currentSentenceOffset(){return this.privSentenceOffset}get bytesReceived(){return this.privBytesReceived}get audioDuration(){return this.privAudioDuration}get extraProperties(){if(this.privWebRTCSDP){const i=new r.PropertyCollection;return i.setProperty(r.PropertyId.TalkingAvatarService_WebRTC_SDP,this.privWebRTCSDP),i}}async getAllReceivedAudio(){return this.privReceivedAudio?Promise.resolve(this.privReceivedAudio):this.privIsSynthesisEnded?(await this.readAllAudioFromStream(),Promise.resolve(this.privReceivedAudio)):null}async getAllReceivedAudioWithHeader(){if(this.privReceivedAudioWithHeader)return this.privReceivedAudioWithHeader;if(!this.privIsSynthesisEnded)return null;if(this.audioOutputFormat.hasHeader){const i=await this.getAllReceivedAudio();return this.privReceivedAudioWithHeader=this.audioOutputFormat.addHeader(i),this.privReceivedAudioWithHeader}else return this.getAllReceivedAudio()}startNewSynthesis(i,s,c,u){this.privIsSynthesisEnded=!1,this.privIsSynthesizing=!0,this.privRequestId=i,this.privRawText=s,this.privIsSSML=c,this.privAudioOutputStream=new e.PullAudioOutputStreamImpl,this.privAudioOutputStream.format=this.privAudioOutputFormat,this.privReceivedAudio=null,this.privReceivedAudioWithHeader=null,this.privBytesReceived=0,this.privTextOffset=0,this.privNextSearchTextIndex=0,this.privSentenceOffset=0,this.privNextSearchSentenceIndex=0,this.privPartialVisemeAnimation="",this.privWebRTCSDP="",u!==void 0&&(this.privTurnAudioDestination=u,this.privTurnAudioDestination.format=this.privAudioOutputFormat),this.onEvent(new p.SynthesisTriggeredEvent(this.requestId,void 0,u===void 0?void 0:u.id()))}onPreConnectionStart(i){this.privAuthFetchEventId=i,this.onEvent(new p.ConnectingToSynthesisServiceEvent(this.privRequestId,this.privAuthFetchEventId))}onAuthCompleted(i){i&&this.onComplete()}onConnectionEstablishCompleted(i){if(i===200){this.onEvent(new p.SynthesisStartedEvent(this.requestId,this.privAuthFetchEventId)),this.privBytesReceived=0;return}else i===403&&this.onComplete()}onServiceResponseMessage(i){const s=JSON.parse(i);this.streamId=s.audio.streamId}onServiceTurnEndResponse(){this.privInTurn=!1,this.privTurnDeferral.resolve(),this.onComplete()}onServiceTurnStartResponse(i){this.privTurnDeferral&&this.privInTurn&&(this.privTurnDeferral.reject("Another turn started before current completed."),this.privTurnDeferral.promise.then().catch(()=>{})),this.privInTurn=!0,this.privTurnDeferral=new t.Deferred;const s=JSON.parse(i);s.webrtc&&(this.privWebRTCSDP=s.webrtc.connectionString)}onAudioChunkReceived(i){this.isSynthesizing&&(this.privAudioOutputStream.write(i),this.privBytesReceived+=i.byteLength,this.privTurnAudioDestination!==void 0&&this.privTurnAudioDestination.write(i))}onTextBoundaryEvent(i){this.updateTextOffset(i.Data.text.Text,i.Type)}onVisemeMetadataReceived(i){i.Data.AnimationChunk!==void 0&&(this.privPartialVisemeAnimation+=i.Data.AnimationChunk)}onSessionEnd(i){this.privAudioDuration=i.Data.Offset}async constructSynthesisResult(){const i=await this.getAllReceivedAudioWithHeader();return new r.SpeechSynthesisResult(this.requestId,r.ResultReason.SynthesizingAudioCompleted,i,void 0,this.extraProperties,this.audioDuration)}dispose(){this.privIsDisposed||(this.privIsDisposed=!0)}onStopSynthesizing(){this.onComplete()}getAndClearVisemeAnimation(){const i=this.privPartialVisemeAnimation;return this.privPartialVisemeAnimation="",i}onEvent(i){t.Events.instance.onEvent(i)}static isXmlTag(i){return i.length>=2&&i[0]==="<"&&i[i.length-1]===">"}updateTextOffset(i,s){s===o.MetadataType.WordBoundary?(this.privTextOffset=this.privRawText.indexOf(i,this.privNextSearchTextIndex),this.privTextOffset>=0&&(this.privNextSearchTextIndex=this.privTextOffset+i.length,this.privIsSSML&&this.withinXmlTag(this.privTextOffset)&&!ts.isXmlTag(i)&&this.updateTextOffset(i,s))):(this.privSentenceOffset=this.privRawText.indexOf(i,this.privNextSearchSentenceIndex),this.privSentenceOffset>=0&&(this.privNextSearchSentenceIndex=this.privSentenceOffset+i.length,this.privIsSSML&&this.withinXmlTag(this.privSentenceOffset)&&!ts.isXmlTag(i)&&this.updateTextOffset(i,s)))}onComplete(){this.privIsSynthesizing&&(this.privIsSynthesizing=!1,this.privIsSynthesisEnded=!0,this.privAudioOutputStream.close(),this.privInTurn=!1,this.privTurnAudioDestination!==void 0&&(this.privTurnAudioDestination.close(),this.privTurnAudioDestination=void 0))}async readAllAudioFromStream(){if(this.privIsSynthesisEnded){this.privReceivedAudio=new ArrayBuffer(this.bytesReceived);try{await this.privAudioOutputStream.read(this.privReceivedAudio)}catch{this.privReceivedAudio=new ArrayBuffer(0)}}}withinXmlTag(i){return this.privRawText.indexOf("<",i+1)>this.privRawText.indexOf(">",i+1)}};return kr.SynthesisTurn=a,kr}var Nr={},Ya;function Rg(){if(Ya)return Nr;Ya=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.SynthesisAdapterBase=void 0;const t=A(),e=P(),r=T(),o=Se;let p=class{constructor(n,i,s,c){if(this.speakOverride=void 0,this.receiveMessageOverride=void 0,this.connectImplOverride=void 0,this.configConnectionOverride=void 0,this.privConnectionConfigurationPromise=void 0,!n)throw new t.ArgumentNullError("authentication");if(!i)throw new t.ArgumentNullError("connectionFactory");if(!s)throw new t.ArgumentNullError("synthesizerConfig");this.privAuthentication=n,this.privConnectionFactory=i,this.privSynthesizerConfig=s,this.privIsDisposed=!1,this.privSessionAudioDestination=c,this.privSynthesisTurn=new r.SynthesisTurn,this.privConnectionEvents=new t.EventSource,this.privServiceEvents=new t.EventSource,this.privSynthesisContext=new r.SynthesisContext,this.privAgentConfig=new r.AgentConfig,this.connectionEvents.attach(u=>{if(u.name==="ConnectionClosedEvent"){const d=u;d.statusCode!==1e3&&this.cancelSynthesisLocal(e.CancellationReason.Error,d.statusCode===1007?e.CancellationErrorCode.BadRequestParameters:e.CancellationErrorCode.ConnectionFailure,`${d.reason} websocket error code: ${d.statusCode}`)}})}get synthesisContext(){return this.privSynthesisContext}get agentConfig(){return this.privAgentConfig}get connectionEvents(){return this.privConnectionEvents}get serviceEvents(){return this.privServiceEvents}set activityTemplate(n){this.privActivityTemplate=n}get activityTemplate(){return this.privActivityTemplate}set audioOutputFormat(n){this.privAudioOutputFormat=n,this.privSynthesisTurn.audioOutputFormat=n,this.privSessionAudioDestination!==void 0&&(this.privSessionAudioDestination.format=n),this.synthesisContext!==void 0&&(this.synthesisContext.audioOutputFormat=n)}isDisposed(){return this.privIsDisposed}async dispose(n){this.privIsDisposed=!0,this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.close(),this.privConnectionConfigurationPromise!==void 0&&await(await this.privConnectionConfigurationPromise).dispose(n)}async connect(){await this.connectImpl()}async sendNetworkMessage(n,i){const s=typeof i=="string"?t.MessageType.Text:t.MessageType.Binary,c=typeof i=="string"?"application/json":"";return(await this.fetchConnection()).send(new o.SpeechConnectionMessage(s,n,this.privSynthesisTurn.requestId,c,i))}async Speak(n,i,s,c,u,d){let h;if(i?h=n:h=this.privSynthesizer.buildSsml(n),this.speakOverride!==void 0)return this.speakOverride(h,s,c,u);this.privSuccessCallback=c,this.privErrorCallback=u,this.privSynthesisTurn.startNewSynthesis(s,n,i,d);try{await this.connectImpl();const l=await this.fetchConnection();await this.sendSynthesisContext(l),await this.sendSsmlMessage(l,h,s),this.onSynthesisStarted(s),this.receiveMessage()}catch(l){return this.cancelSynthesisLocal(e.CancellationReason.Error,e.CancellationErrorCode.ConnectionFailure,l),Promise.reject(l)}}async stopSpeaking(){return await this.connectImpl(),(await this.fetchConnection()).send(new o.SpeechConnectionMessage(t.MessageType.Text,"synthesis.control",this.privSynthesisTurn.requestId,"application/json",JSON.stringify({action:"stop"})))}cancelSynthesis(n,i,s,c){const u=new e.PropertyCollection;u.setProperty(r.CancellationErrorCodePropertyName,e.CancellationErrorCode[s]);const d=new e.SpeechSynthesisResult(n,e.ResultReason.Canceled,void 0,c,u);if(this.onSynthesisCancelled(d),this.privSuccessCallback)try{this.privSuccessCallback(d)}catch{}}cancelSynthesisLocal(n,i,s){this.privSynthesisTurn.isSynthesizing&&(this.privSynthesisTurn.onStopSynthesizing(),this.cancelSynthesis(this.privSynthesisTurn.requestId,n,i,s))}processTypeSpecificMessages(n){return!0}async receiveMessage(){try{const i=await(await this.fetchConnection()).read();if(this.receiveMessageOverride!==void 0)return this.receiveMessageOverride();if(this.privIsDisposed)return;if(!i)return this.privSynthesisTurn.isSynthesizing?this.receiveMessage():void 0;const s=o.SpeechConnectionMessage.fromConnectionMessage(i);if(s.requestId.toLowerCase()===this.privSynthesisTurn.requestId.toLowerCase())switch(s.path.toLowerCase()){case"turn.start":this.privSynthesisTurn.onServiceTurnStartResponse(s.textBody);break;case"response":this.privSynthesisTurn.onServiceResponseMessage(s.textBody);break;case"audio":this.privSynthesisTurn.streamId.toLowerCase()===s.streamId.toLowerCase()&&s.binaryBody&&(this.privSynthesisTurn.onAudioChunkReceived(s.binaryBody),this.onSynthesizing(s.binaryBody),this.privSessionAudioDestination!==void 0&&this.privSessionAudioDestination.write(s.binaryBody));break;case"audio.metadata":const c=r.SynthesisAudioMetadata.fromJSON(s.textBody).Metadata;for(const d of c)switch(d.Type){case r.MetadataType.WordBoundary:case r.MetadataType.SentenceBoundary:this.privSynthesisTurn.onTextBoundaryEvent(d);const h=new e.SpeechSynthesisWordBoundaryEventArgs(d.Data.Offset,d.Data.Duration,d.Data.text.Text,d.Data.text.Length,d.Type===r.MetadataType.WordBoundary?this.privSynthesisTurn.currentTextOffset:this.privSynthesisTurn.currentSentenceOffset,d.Data.text.BoundaryType);this.onWordBoundary(h);break;case r.MetadataType.Bookmark:const l=new e.SpeechSynthesisBookmarkEventArgs(d.Data.Offset,d.Data.Bookmark);this.onBookmarkReached(l);break;case r.MetadataType.Viseme:if(this.privSynthesisTurn.onVisemeMetadataReceived(d),d.Data.IsLastAnimation){const f=new e.SpeechSynthesisVisemeEventArgs(d.Data.Offset,d.Data.VisemeId,this.privSynthesisTurn.getAndClearVisemeAnimation());this.onVisemeReceived(f)}break;case r.MetadataType.AvatarSignal:this.onAvatarEvent(d);break;case r.MetadataType.SessionEnd:this.privSynthesisTurn.onSessionEnd(d);break}break;case"turn.end":this.privSynthesisTurn.onServiceTurnEndResponse();let u;try{u=await this.privSynthesisTurn.constructSynthesisResult(),this.privSuccessCallback&&this.privSuccessCallback(u)}catch(d){this.privErrorCallback&&this.privErrorCallback(d)}this.onSynthesisCompleted(u);break;default:this.processTypeSpecificMessages(s)||this.privServiceEvents&&this.serviceEvents.onEvent(new t.ServiceEvent(s.path.toLowerCase(),s.textBody))}return this.receiveMessage()}catch{}}sendSynthesisContext(n){this.setSynthesisContextSynthesisSection();const i=this.synthesisContext.toJSON();if(i)return n.send(new o.SpeechConnectionMessage(t.MessageType.Text,"synthesis.context",this.privSynthesisTurn.requestId,"application/json",i))}setSpeechConfigSynthesisSection(){}connectImpl(n=!1){if(this.privConnectionPromise!=null)return this.privConnectionPromise.then(s=>s.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()):this.privConnectionPromise,()=>(this.privConnectionId=null,this.privConnectionPromise=null,this.connectImpl()));this.privAuthFetchEventId=(0,t.createNoDashGuid)(),this.privConnectionId=(0,t.createNoDashGuid)(),this.privSynthesisTurn.onPreConnectionStart(this.privAuthFetchEventId);const i=n?this.privAuthentication.fetchOnExpiry(this.privAuthFetchEventId):this.privAuthentication.fetch(this.privAuthFetchEventId);return this.privConnectionPromise=i.then(async s=>{this.privSynthesisTurn.onAuthCompleted(!1);const c=await this.privConnectionFactory.create(this.privSynthesizerConfig,s,this.privConnectionId);c.events.attach(d=>{this.connectionEvents.onEvent(d)});const u=await c.open();return u.statusCode===200?(this.privSynthesisTurn.onConnectionEstablishCompleted(u.statusCode),Promise.resolve(c)):u.statusCode===403&&!n?this.connectImpl(!0):(this.privSynthesisTurn.onConnectionEstablishCompleted(u.statusCode),Promise.reject(`Unable to contact server. StatusCode: ${u.statusCode},
                    ${this.privSynthesizerConfig.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Url)} Reason: ${u.reason}`))},s=>{throw this.privSynthesisTurn.onAuthCompleted(!0),new Error(s)}),this.privConnectionPromise.catch(()=>{}),this.privConnectionPromise}sendSpeechServiceConfig(n,i){if(i)return n.send(new o.SpeechConnectionMessage(t.MessageType.Text,"speech.config",this.privSynthesisTurn.requestId,"application/json",i))}sendSsmlMessage(n,i,s){return n.send(new o.SpeechConnectionMessage(t.MessageType.Text,"ssml",s,"application/ssml+xml",i))}async fetchConnection(){return this.privConnectionConfigurationPromise!==void 0?this.privConnectionConfigurationPromise.then(n=>n.state()===t.ConnectionState.Disconnected?(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection()):this.privConnectionConfigurationPromise,()=>(this.privConnectionId=null,this.privConnectionConfigurationPromise=void 0,this.fetchConnection())):(this.privConnectionConfigurationPromise=this.configureConnection(),await this.privConnectionConfigurationPromise)}async configureConnection(){const n=await this.connectImpl();return this.configConnectionOverride!==void 0?this.configConnectionOverride(n):(this.setSpeechConfigSynthesisSection(),await this.sendSpeechServiceConfig(n,this.privSynthesizerConfig.SpeechServiceConfig.serialize()),n)}onAvatarEvent(n){}onSynthesisStarted(n){}onSynthesizing(n){}onSynthesisCancelled(n){}onSynthesisCompleted(n){}onWordBoundary(n){}onVisemeReceived(n){}onBookmarkReached(n){}};return Nr.SynthesisAdapterBase=p,p.telemetryDataEnabled=!0,Nr}var zr={},ec;function Eg(){if(ec)return zr;ec=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.AvatarSynthesisAdapter=void 0;const t=P(),e=T();let r=class extends e.SynthesisAdapterBase{constructor(p,a,n,i,s){super(p,a,n,void 0),this.privAvatarSynthesizer=i,this.privSynthesizer=i,this.privAvatarConfig=s}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(void 0)}setSpeechConfigSynthesisSection(){var p,a,n,i,s,c,u,d,h,l,f,g,S,v,m,C,y;this.privSynthesizerConfig.synthesisVideoSection={format:{bitrate:(p=this.privAvatarConfig.videoFormat)==null?void 0:p.bitrate,codec:(a=this.privAvatarConfig.videoFormat)==null?void 0:a.codec,crop:{bottomRight:{x:(s=(i=(n=this.privAvatarConfig.videoFormat)==null?void 0:n.cropRange)==null?void 0:i.bottomRight)==null?void 0:s.x,y:(d=(u=(c=this.privAvatarConfig.videoFormat)==null?void 0:c.cropRange)==null?void 0:u.bottomRight)==null?void 0:d.y},topLeft:{x:(f=(l=(h=this.privAvatarConfig.videoFormat)==null?void 0:h.cropRange)==null?void 0:l.topLeft)==null?void 0:f.x,y:(v=(S=(g=this.privAvatarConfig.videoFormat)==null?void 0:g.cropRange)==null?void 0:S.topLeft)==null?void 0:v.y}},resolution:{height:(m=this.privAvatarConfig.videoFormat)==null?void 0:m.height,width:(C=this.privAvatarConfig.videoFormat)==null?void 0:C.width}},protocol:{name:"WebRTC",webrtcConfig:{clientDescription:btoa(this.privSynthesizerConfig.parameters.getProperty(t.PropertyId.TalkingAvatarService_WebRTC_SDP)),iceServers:this.privAvatarConfig.remoteIceServers??this.privAvatarSynthesizer.iceServers}},talkingAvatar:{background:{color:this.privAvatarConfig.backgroundColor,image:{url:(y=this.privAvatarConfig.backgroundImage)==null?void 0:y.toString()}},character:this.privAvatarConfig.character,customized:this.privAvatarConfig.customized,style:this.privAvatarConfig.style,useBuiltInVoice:this.privAvatarConfig.useBuiltInVoice}}}onAvatarEvent(p){if(this.privAvatarSynthesizer.avatarEventReceived){const a=new t.AvatarEventArgs(p.Data.Offset,p.Data.Name);try{this.privAvatarSynthesizer.avatarEventReceived(this.privAvatarSynthesizer,a)}catch{}}}};return zr.AvatarSynthesisAdapter=r,zr}var jr={},tc;function Ig(){if(tc)return jr;tc=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.SpeechSynthesisAdapter=void 0;const t=P(),e=T();let r=class extends e.SynthesisAdapterBase{constructor(p,a,n,i,s){super(p,a,n,s),this.privSpeechSynthesizer=i,this.privSynthesizer=i}setSynthesisContextSynthesisSection(){this.privSynthesisContext.setSynthesisSection(this.privSpeechSynthesizer)}onSynthesisStarted(p){const a=new t.SpeechSynthesisEventArgs(new t.SpeechSynthesisResult(p,t.ResultReason.SynthesizingAudioStarted));this.privSpeechSynthesizer.synthesisStarted&&this.privSpeechSynthesizer.synthesisStarted(this.privSpeechSynthesizer,a)}onSynthesizing(p){if(this.privSpeechSynthesizer.synthesizing)try{const a=this.privSynthesisTurn.audioOutputFormat.addHeader(p),n=new t.SpeechSynthesisEventArgs(new t.SpeechSynthesisResult(this.privSynthesisTurn.requestId,t.ResultReason.SynthesizingAudio,a));this.privSpeechSynthesizer.synthesizing(this.privSpeechSynthesizer,n)}catch{}}onSynthesisCancelled(p){if(this.privSpeechSynthesizer.SynthesisCanceled){const a=new t.SpeechSynthesisEventArgs(p);try{this.privSpeechSynthesizer.SynthesisCanceled(this.privSpeechSynthesizer,a)}catch{}}}onSynthesisCompleted(p){if(this.privSpeechSynthesizer.synthesisCompleted)try{this.privSpeechSynthesizer.synthesisCompleted(this.privSpeechSynthesizer,new t.SpeechSynthesisEventArgs(p))}catch{}}onWordBoundary(p){if(this.privSpeechSynthesizer.wordBoundary)try{this.privSpeechSynthesizer.wordBoundary(this.privSpeechSynthesizer,p)}catch{}}onVisemeReceived(p){if(this.privSpeechSynthesizer.visemeReceived)try{this.privSpeechSynthesizer.visemeReceived(this.privSpeechSynthesizer,p)}catch{}}onBookmarkReached(p){if(this.privSpeechSynthesizer.bookmarkReached)try{this.privSpeechSynthesizer.bookmarkReached(this.privSpeechSynthesizer,p)}catch{}}};return jr.SpeechSynthesisAdapter=r,jr}var Lr={},rc;function Tg(){if(rc)return Lr;rc=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.SynthesisRestAdapter=void 0;const t=x(),e=P(),r=ue(),o=F;let p=class{constructor(n,i){let s=n.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Endpoint,void 0);if(!s){const u=n.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Region,"westus"),d=r.ConnectionFactoryBase.getHostSuffix(u);s=n.parameters.getProperty(e.PropertyId.SpeechServiceConnection_Host,`https://${u}.tts.speech${d}`)}this.privUri=`${s}/cognitiveservices/voices/list`;const c=t.RestConfigBase.requestOptions;this.privRestAdapter=new t.RestMessageAdapter(c),this.privAuthentication=i}getVoicesList(n){return this.privRestAdapter.setHeaders(o.HeaderNames.ConnectionId,n),this.privAuthentication.fetch(n).then(i=>(this.privRestAdapter.setHeaders(i.headerName,i.token),this.privRestAdapter.request(t.RestRequestType.Get,this.privUri)))}};return Lr.SynthesisRestAdapter=p,Lr}var Gn={},ic;function Ag(){return ic||(ic=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.SynthesizerConfig=t.SynthesisServiceType=void 0;const e=T();var r;(function(p){p[p.Standard=0]="Standard",p[p.Custom=1]="Custom"})(r=t.SynthesisServiceType||(t.SynthesisServiceType={}));class o{constructor(a,n){this.privSynthesisServiceType=r.Standard,this.avatarEnabled=!1,this.privSpeechServiceConfig=a||new e.SpeechServiceConfig(new e.Context(null)),this.privParameters=n}get parameters(){return this.privParameters}get synthesisServiceType(){return this.privSynthesisServiceType}set synthesisServiceType(a){this.privSynthesisServiceType=a}set synthesisVideoSection(a){this.privSpeechServiceConfig.Context.synthesis={video:a}}get SpeechServiceConfig(){return this.privSpeechServiceConfig}}t.SynthesizerConfig=o}(Gn)),Gn}var Br={},nc;function wg(){if(nc)return Br;nc=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.SynthesisContext=void 0;const t=P();let e=class{constructor(){this.privContext={}}setSection(o,p){this.privContext[o]=p}set audioOutputFormat(o){this.privAudioOutputFormat=o}toJSON(){return JSON.stringify(this.privContext)}setSynthesisSection(o){const p=this.buildSynthesisContext(o);this.setSection("synthesis",p)}buildSynthesisContext(o){return{audio:{metadataOptions:{bookmarkEnabled:!!(o!=null&&o.bookmarkReached),punctuationBoundaryEnabled:o==null?void 0:o.properties.getProperty(t.PropertyId.SpeechServiceResponse_RequestPunctuationBoundary,!!(o!=null&&o.wordBoundary)),sentenceBoundaryEnabled:o==null?void 0:o.properties.getProperty(t.PropertyId.SpeechServiceResponse_RequestSentenceBoundary,!1),sessionEndEnabled:!0,visemeEnabled:!!(o!=null&&o.visemeReceived),wordBoundaryEnabled:o==null?void 0:o.properties.getProperty(t.PropertyId.SpeechServiceResponse_RequestWordBoundary,!!(o!=null&&o.wordBoundary))},outputFormat:this.privAudioOutputFormat.requestAudioFormatString},language:{autoDetection:o==null?void 0:o.autoDetectSourceLanguage}}}};return Br.SynthesisContext=e,Br}var qr={},sc;function _g(){if(sc)return qr;sc=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.SpeakerRecognitionConfig=void 0;const t=T();let e=class{constructor(o,p){this.privContext=o||new t.Context(null),this.privParameters=p}get parameters(){return this.privParameters}get Context(){return this.privContext}};return qr.SpeakerRecognitionConfig=e,qr}var Fr={},oc;function bg(){if(oc)return Fr;oc=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.SpeakerServiceRecognizer=void 0;const t=x(),e=A(),r=P(),o=T(),p=Se;let a=class extends o.ServiceRecognizerBase{constructor(i,s,c,u,d){super(i,s,c,u,d),this.privSpeakerRecognizer=d,this.privSpeakerAudioSource=c,this.recognizeSpeaker=h=>this.recognizeSpeakerOnce(h),this.sendPrePayloadJSONOverride=()=>this.noOp()}processTypeSpecificMessages(i){let s=!1;const c=new r.PropertyCollection;switch(i.messageType===e.MessageType.Text&&c.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,i.textBody),i.path.toLowerCase()){case"speaker.response":const d=JSON.parse(i.textBody);let h;d.status.statusCode.toLowerCase()!=="success"?h=new r.SpeakerRecognitionResult(d,r.ResultReason.Canceled,r.CancellationErrorCode.ServiceError,d.status.reason):h=new r.SpeakerRecognitionResult(d,r.ResultReason.RecognizedSpeaker),this.privResultDeferral&&this.privResultDeferral.resolve(h),s=!0;break}const u=new e.Deferred;return u.resolve(s),u.promise}cancelRecognition(i,s,c,u,d){if(new r.PropertyCollection().setProperty(o.CancellationErrorCodePropertyName,r.CancellationErrorCode[u]),this.privResultDeferral){const l=new r.SpeakerRecognitionResult({scenario:this.privSpeakerModel.scenario,status:{statusCode:d,reason:d}},r.ResultReason.Canceled,u,d);try{this.privResultDeferral.resolve(l)}catch(f){this.privResultDeferral.reject(f)}}}async recognizeSpeakerOnce(i){this.privSpeakerModel=i,this.voiceProfileType=i.scenario,this.privResultDeferral||(this.privResultDeferral=new e.Deferred),this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(r.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const s=this.connectImpl(),c=this.sendPreAudioMessages(this.extractSpeakerContext(i)),u=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),d=await this.privSpeakerAudioSource.format,h=await this.privSpeakerAudioSource.deviceInfo,l=new t.ReplayableAudioNode(u,d.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(l,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:h};try{await s,await c}catch(S){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,S)}const f=new r.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,f),this.receiveMessage(),this.sendAudio(l).then(()=>{},S=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,S)}),this.privResultDeferral.promise}async sendPreAudioMessages(i){const s=await this.fetchConnection();await this.sendSpeakerRecognition(s,i)}async sendSpeakerRecognition(i,s){const c=JSON.stringify(s);return i.send(new p.SpeechConnectionMessage(e.MessageType.Text,"speaker.context",this.privRequestSession.requestId,"application/json; charset=utf-8",c))}extractSpeakerContext(i){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:i.profileIds,scenario:i.scenario}}};return Fr.SpeakerServiceRecognizer=a,Fr}var xr={},ac;function Mg(){if(ac)return xr;ac=1,Object.defineProperty(xr,"__esModule",{value:!0}),xr.VoiceServiceRecognizer=void 0;const t=x(),e=A(),r=P(),o=T(),p=Se;let a=class extends o.ServiceRecognizerBase{constructor(i,s,c,u,d){super(i,s,c,u,d),this.privDeferralMap=new e.DeferralMap,this.privSpeakerAudioSource=c,this.sendPrePayloadJSONOverride=()=>this.noOp()}set SpeakerAudioSource(i){this.privSpeakerAudioSource=i}processTypeSpecificMessages(i){let s=!1;const c=new r.PropertyCollection;switch(i.messageType===e.MessageType.Text&&c.setProperty(r.PropertyId.SpeechServiceResponse_JsonResult,i.textBody),i.path.toLowerCase()){case"speaker.profiles":const d=JSON.parse(i.textBody);switch(d.operation.toLowerCase()){case"create":this.handleCreateResponse(d,i.requestId);break;case"delete":case"reset":this.handleResultResponse(d,i.requestId);break;case"fetch":const g=JSON.parse(i.textBody);this.handleFetchResponse(g,i.requestId);break}s=!0;break;case"speaker.phrases":const h=JSON.parse(i.textBody);this.handlePhrasesResponse(h,i.requestId),s=!0;break;case"speaker.profile.enrollment":const l=JSON.parse(i.textBody),f=new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(l.enrollment?l.enrollment.enrollmentStatus:l.status.statusCode),l.enrollment?JSON.stringify(l.enrollment):void 0,l.status.reason);this.privDeferralMap.getId(i.requestId)&&this.privDeferralMap.complete(i.requestId,f),this.privRequestSession.onSpeechEnded(),s=!0;break}const u=new e.Deferred;return u.resolve(s),u.promise}cancelRecognition(i,s,c,u,d){new r.PropertyCollection().setProperty(o.CancellationErrorCodePropertyName,r.CancellationErrorCode[u]);const l=new r.VoiceProfileEnrollmentResult(r.ResultReason.Canceled,d,d);this.privDeferralMap.getId(s)&&this.privDeferralMap.complete(s,l)}async createProfile(i,s){this.voiceProfileType=i.toString();const c=this.connectImpl();try{const u=new e.Deferred;return await c,await this.sendCreateProfile(u,i,s),this.receiveMessage(),u.promise}catch(u){throw u}}async resetProfile(i){return this.voiceProfileType=i.profileType.toString(),this.sendCommonRequest("reset",i.profileType,i)}async deleteProfile(i){return this.voiceProfileType=i.profileType.toString(),this.sendCommonRequest("delete",i.profileType,i)}async retrieveEnrollmentResult(i){return this.voiceProfileType=i.profileType.toString(),this.privExpectedProfileId=i.profileId,this.sendCommonRequest("fetch",i.profileType,i)}async getAllProfiles(i){return this.voiceProfileType=i.toString(),this.sendCommonRequest("fetch",i)}async getActivationPhrases(i,s){this.voiceProfileType=i.toString();const c=this.connectImpl();try{const u=new e.Deferred;return await c,await this.sendPhrasesRequest(u,i,s),this.receiveMessage(),u.promise}catch(u){throw u}}async enrollProfile(i){this.voiceProfileType=i.profileType.toString();const s=new e.Deferred;this.privRequestSession.startNewRecognition(),this.privRequestSession.listenForServiceTelemetry(this.privSpeakerAudioSource.events),this.privRecognizerConfig.parameters.setProperty(r.PropertyId.Speech_SessionId,this.privRequestSession.sessionId);const c=this.connectImpl(),u=this.sendPreAudioMessages(i,s),d=await this.privSpeakerAudioSource.attach(this.privRequestSession.audioNodeId),h=await this.privSpeakerAudioSource.format,l=await this.privSpeakerAudioSource.deviceInfo,f=new t.ReplayableAudioNode(d,h.avgBytesPerSec);await this.privRequestSession.onAudioSourceAttachCompleted(f,!1),this.privRecognizerConfig.SpeechServiceConfig.Context.audio={source:l};try{await c,await u}catch(v){this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.ConnectionFailure,v)}const g=new r.SessionEventArgs(this.privRequestSession.sessionId);return this.privRecognizer.sessionStarted&&this.privRecognizer.sessionStarted(this.privRecognizer,g),this.receiveMessage(),this.sendAudio(f).then(()=>{},v=>{this.cancelRecognition(this.privRequestSession.sessionId,this.privRequestSession.requestId,r.CancellationReason.Error,r.CancellationErrorCode.RuntimeError,v)}),s.promise}async sendPreAudioMessages(i,s){const c=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,s),await this.sendBaseRequest(c,"enroll",this.scenarioFrom(i.profileType),i)}async sendPhrasesRequest(i,s,c){const u=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,i);const d=this.scenarioFrom(s),h={locale:c,scenario:d};return u.send(new p.SpeechConnectionMessage(e.MessageType.Text,"speaker.profile.phrases",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(h)))}async sendCreateProfile(i,s,c){const u=await this.fetchConnection();this.privRequestSession.onSpeechContext(),this.privDeferralMap.add(this.privRequestSession.requestId,i);const d=s===r.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":s===r.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification",h={locale:c,number:"1",scenario:d};return u.send(new p.SpeechConnectionMessage(e.MessageType.Text,"speaker.profile.create",this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(h)))}async sendCommonRequest(i,s,c=void 0){const u=this.connectImpl();try{const d=new e.Deferred;this.privRequestSession.onSpeechContext(),await u;const h=await this.fetchConnection();return this.privDeferralMap.add(this.privRequestSession.requestId,d),await this.sendBaseRequest(h,i,this.scenarioFrom(s),c),this.receiveMessage(),d.promise}catch(d){throw d}}async sendBaseRequest(i,s,c,u){const d={scenario:c};return u?d.profileIds=[u.profileId]:d.maxPageSize=-1,i.send(new p.SpeechConnectionMessage(e.MessageType.Text,`speaker.profile.${s}`,this.privRequestSession.requestId,"application/json; charset=utf-8",JSON.stringify(d)))}extractSpeakerContext(i){return{features:{interimResult:"enabled",progressiveDetection:"disabled"},profileIds:i.profileIds,scenario:i.scenario}}handlePhrasesResponse(i,s){if(this.privDeferralMap.getId(s))if(i.status.statusCode.toLowerCase()!=="success"){const c=r.ResultReason.Canceled,u=new r.VoiceProfilePhraseResult(c,i.status.statusCode,i.passPhraseType,[]);this.privDeferralMap.complete(s,u)}else if(i.phrases&&i.phrases.length>0){const c=r.ResultReason.EnrollingVoiceProfile,u=new r.VoiceProfilePhraseResult(c,i.status.statusCode,i.passPhraseType,i.phrases);this.privDeferralMap.complete(s,u)}else throw new Error("Voice Profile get activation phrases failed, no phrases received");else throw new Error(`Voice Profile get activation phrases request for requestID ${s} not found`)}handleCreateResponse(i,s){if(i.profiles&&i.profiles.length>0)if(this.privDeferralMap.getId(s)){const c=i.profiles.map(u=>u.profileId);this.privDeferralMap.complete(s,c)}else throw new Error(`Voice Profile create request for requestID ${s} not found`);else throw new Error("Voice Profile create failed, no profile id received")}handleResultResponse(i,s){if(this.privDeferralMap.getId(s)){const c=i.operation.toLowerCase()==="delete"?r.ResultReason.DeletedVoiceProfile:r.ResultReason.ResetVoiceProfile,u=i.status.statusCode.toLowerCase()==="success"?c:r.ResultReason.Canceled,d=new r.VoiceProfileResult(u,`statusCode: ${i.status.statusCode}, errorDetails: ${i.status.reason}`);this.privDeferralMap.complete(s,d)}else throw new Error(`Voice Profile create request for requestID ${s} not found`)}handleFetchResponse(i,s){if(this.privDeferralMap.getId(s)&&i.profiles[0]){if(this.privExpectedProfileId&&i.profiles.length===1&&i.profiles[0].profileId===this.privExpectedProfileId){this.privExpectedProfileId=void 0;const c=i.profiles[0],u=new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(c.enrollmentStatus),JSON.stringify(c),i.status.reason);this.privDeferralMap.complete(s,u)}else if(i.profiles.length>0){const c=i.profiles,u=[];for(const d of c)u.push(new r.VoiceProfileEnrollmentResult(this.enrollmentReasonFrom(d.enrollmentStatus),JSON.stringify(d),i.status.reason));this.privDeferralMap.complete(s,u)}}else throw new Error(`Voice Profile fetch request for requestID ${s} not found`)}enrollmentReasonFrom(i){switch(i.toLowerCase()){case"enrolled":return r.ResultReason.EnrolledVoiceProfile;case"invalidlocale":case"invalidphrase":case"invalidaudioformat":case"invalidscenario":case"invalidprofilecount":case"invalidoperation":case"audiotooshort":case"audiotoolong":case"toomanyenrollments":case"storageconflict":case"profilenotfound":case"incompatibleprofiles":case"incompleteenrollment":return r.ResultReason.Canceled;default:return r.ResultReason.EnrollingVoiceProfile}}scenarioFrom(i){return i===r.VoiceProfileType.TextIndependentIdentification?"TextIndependentIdentification":i===r.VoiceProfileType.TextIndependentVerification?"TextIndependentVerification":"TextDependentVerification"}};return xr.VoiceServiceRecognizer=a,xr}var $p={};(function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.type=t.connectivity=t.Device=t.OS=t.System=t.Context=t.SpeechServiceConfig=void 0;class e{constructor(i){this.context=i}serialize(){return JSON.stringify(this,(i,s)=>{if(s&&typeof s=="object"&&!Array.isArray(s)){const c={};for(const u in s)Object.hasOwnProperty.call(s,u)&&(c[u&&u.charAt(0).toLowerCase()+u.substring(1)]=s[u]);return c}return s})}get Context(){return this.context}get Recognition(){return this.recognition}set Recognition(i){this.recognition=i.toLowerCase()}}t.SpeechServiceConfig=e;class r{constructor(i){this.system=new o,this.os=i}}t.Context=r;class o{constructor(){const i="1.44.1";this.name="SpeechSDK",this.version=i,this.build="JavaScript",this.lang="JavaScript"}}t.System=o;class p{constructor(i,s,c){this.platform=i,this.name=s,this.version=c}}t.OS=p;class a{constructor(i,s,c){this.manufacturer=i,this.model=s,this.version=c}}t.Device=a,function(n){n.Bluetooth="Bluetooth",n.Wired="Wired",n.WiFi="WiFi",n.Cellular="Cellular",n.InBuilt="InBuilt",n.Unknown="Unknown"}(t.connectivity||(t.connectivity={})),function(n){n.Phone="Phone",n.Speaker="Speaker",n.Car="Car",n.Headset="Headset",n.Thermostat="Thermostat",n.Microphones="Microphones",n.Deskphone="Deskphone",n.RemoteControl="RemoteControl",n.Unknown="Unknown",n.File="File",n.Stream="Stream"}(t.type||(t.type={}))})($p);var cc;function T(){return cc||(cc=1,function(t){var e=k&&k.__createBinding||(Object.create?function(a,n,i,s){s===void 0&&(s=i),Object.defineProperty(a,s,{enumerable:!0,get:function(){return n[i]}})}:function(a,n,i,s){s===void 0&&(s=i),a[s]=n[i]}),r=k&&k.__exportStar||function(a,n){for(var i in a)i!=="default"&&!Object.prototype.hasOwnProperty.call(n,i)&&e(n,a,i)};Object.defineProperty(t,"__esModule",{value:!0}),t.AutoDetectSourceLanguagesOpenRangeOptionName=t.ForceDictationPropertyName=t.ServicePropertiesPropertyName=t.CancellationErrorCodePropertyName=t.OutputFormatPropertyName=t.SpeechSynthesisAdapter=t.AvatarSynthesisAdapter=void 0,r(hi,t),r(ki,t),r(rt,t),r(Mc,t),r(Oc,t),r(Sf(),t),r(Cf(),t),r(cn,t),r(yf(),t),r(Pf(),t),r(Rf(),t),r(kp,t),r(pn,t),r(If(),t),r(Tf(),t),r(Af(),t),r(wf(),t),r(Pp(),t),r(_f(),t),r(Np,t),r(bf(),t),r(un,t),r(Of(),t),r(Df(),t),r(dn,t),r(hn,t),r(ln,t),r(kf(),t),r(Nf(),t),r(zf(),t),r(jf(),t),r(Lf(),t),r(vn,t),r(qf(),t),r(fn,t),r(qp,t),r(gn,t),r(Sn,t),r(Cn,t),r(Yf(),t),r(Rn,t),r(mg(),t),r(bs,t),r(Pg(),t),r(Rg(),t);var o=Eg();Object.defineProperty(t,"AvatarSynthesisAdapter",{enumerable:!0,get:function(){return o.AvatarSynthesisAdapter}});var p=Ig();Object.defineProperty(t,"SpeechSynthesisAdapter",{enumerable:!0,get:function(){return p.SpeechSynthesisAdapter}}),r(Tg(),t),r(Ag(),t),r(wg(),t),r(_g(),t),r(bg(),t),r(Mg(),t),r($p,t),t.OutputFormatPropertyName="OutputFormat",t.CancellationErrorCodePropertyName="CancellationErrorCode",t.ServicePropertiesPropertyName="ServiceProperties",t.ForceDictationPropertyName="ForceDictation",t.AutoDetectSourceLanguagesOpenRangeOptionName="UND"}(bn)),bn}(function(t){var e=k&&k.__createBinding||(Object.create?function(p,a,n,i){i===void 0&&(i=n),Object.defineProperty(p,i,{enumerable:!0,get:function(){return a[n]}})}:function(p,a,n,i){i===void 0&&(i=n),p[i]=a[n]}),r=k&&k.__exportStar||function(p,a){for(var n in p)n!=="default"&&!Object.prototype.hasOwnProperty.call(a,n)&&e(a,p,n)};Object.defineProperty(t,"__esModule",{value:!0});const o=T();new o.AgentConfig,r(P(),t)})(rs);const Og=Yu(rs),eS=ed({__proto__:null,default:Og},[rs]);export{eS as m};
//# sourceMappingURL=microsoft.cognitiveservices.speech.sdk-8LyAJreJ.js.map
