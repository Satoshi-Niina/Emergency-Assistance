import{j as e}from"./ui-BaYWhfWe.js";import{r as s}from"./vendor-C0Yfakdp.js";import{d as t,u as a,f as l,S as i,L as r,B as c,W as d}from"./index-aVFLKjny.js";import{C as n,a as o,b as m,c as x}from"./card-Lfg6hAc2.js";import{S as h,V as u}from"./switch-DnopeAfq.js";import{S as b}from"./slider-CjEL39SV.js";import{W as j}from"./warning-dialog-BuP73DXt.js";import{U as p,S as g,a as N}from"./user-CXoDQykq.js";import{C as f}from"./circle-check-big-BBHQJoM9.js";import{T as v}from"./trash-2-WYHAnfoN.js";import{S as w}from"./save-C0nuyIfL.js";import"./index-CttfQz0H.js";import"./index-jVOyRz7F.js";import"./dialog-dEgQR5j_.js";import"./triangle-alert-CYLYmgLY.js";
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y=t("FileType",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 13v-1h6v1",key:"1bb014"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M11 18h2",key:"12mj7e"}]]),k=t("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);
/**
 * @license lucide-react v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function S(){const{user:t,logout:S}=a(),{toast:C}=l(),[M,E]=s.useState(!1),[B,O]=s.useState(!0),[T,V]=s.useState(!0),[z,I]=s.useState([80]),[R,A]=s.useState(!1),[K,P]=s.useState(!0),[q,D]=s.useState(!0);s.useEffect(()=>{(()=>{try{const e=localStorage.getItem("emergencyRecoverySettings");if(e){const s=JSON.parse(e);void 0!==s.notifications&&O(s.notifications),void 0!==s.textToSpeech&&V(s.textToSpeech),void 0!==s.speechVolume&&I(s.speechVolume),void 0!==s.darkMode&&A(s.darkMode),void 0!==s.autoSave&&P(s.autoSave),void 0!==s.useOnlyKnowledgeBase&&D(s.useOnlyKnowledgeBase)}}catch(e){console.error("設定の読み込みに失敗しました:",e)}})()},[]);const F=()=>{try{const e={notifications:B,textToSpeech:T,speechVolume:z,darkMode:R,autoSave:K,useOnlyKnowledgeBase:q};localStorage.setItem("emergencyRecoverySettings",JSON.stringify(e)),localStorage.setItem("useOnlyKnowledgeBase",q.toString()),window.dispatchEvent(new CustomEvent("settingsChanged",{detail:e}))}catch(e){console.error("設定の保存に失敗しました:",e)}};s.useEffect(()=>{F()},[B,T,z,R,K,q]);return e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 md:p-6 max-w-5xl mx-auto w-full bg-gradient-to-br from-blue-50 to-indigo-50",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h1",{className:"text-2xl font-bold flex items-center bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent",children:[e.jsx(i,{className:"mr-2 h-6 w-6 text-indigo-500"}),"設定"]}),e.jsx("p",{className:"text-blue-400",children:"アプリケーションの設定を管理します"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs(n,{className:"border border-blue-200 shadow-md overflow-hidden",children:[e.jsx(o,{className:"pb-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:e.jsxs(m,{className:"text-lg flex items-center",children:[e.jsx(p,{className:"mr-2 h-5 w-5"}),"ユーザープロフィール"]})}),e.jsx(x,{className:"bg-white",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:null==t?void 0:t.displayName}),e.jsx("p",{className:"text-sm text-blue-400",children:null==t?void 0:t.username}),e.jsx("p",{className:"text-sm text-blue-400",children:(null==t?void 0:t.department)||"部署未設定"})]}),e.jsx("div",{className:"text-white text-xs px-3 py-1 rounded-full "+("admin"===(null==t?void 0:t.role)?"bg-gradient-to-r from-purple-500 to-indigo-500":"bg-gradient-to-r from-blue-500 to-green-500"),children:"admin"===(null==t?void 0:t.role)?"管理者":"一般ユーザー"})]}),e.jsx("div",{className:"border-t border-blue-100 pt-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Emergency Recovery Chat"}),e.jsx("p",{className:"text-sm text-blue-500",children:"バージョン 1.0.0"}),e.jsx("p",{className:"text-sm text-blue-500",children:"© 2024 All Rights Reserved"}),e.jsx("p",{className:"text-xs text-blue-400",children:"応急復旧サポートのための対話型アシスタントシステム"})]})})]})})]}),("admin"===(null==t?void 0:t.role)||"employee"===(null==t?void 0:t.role))&&e.jsxs(n,{className:"border border-blue-200 shadow-md overflow-hidden",children:[e.jsx(o,{className:"pb-2 bg-gradient-to-r from-blue-700 to-indigo-700 text-white",children:e.jsxs(m,{className:"text-lg flex items-center",children:[e.jsx(g,{className:"mr-2 h-5 w-5"}),"管理者設定"]})}),e.jsx(x,{className:"bg-white",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-blue-100 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"ユーザー管理"}),e.jsx("p",{className:"text-sm text-blue-400",children:"ユーザーアカウントを管理する"})]}),e.jsx(r,{to:"/users",children:e.jsxs(c,{variant:"outline",size:"sm",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:[e.jsx(N,{className:"mr-2 h-4 w-4 text-blue-500"}),"管理"]})})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-blue-100 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"システム診断"}),e.jsx("p",{className:"text-sm text-blue-400",children:"DB接続とGPT接続の状態を確認"})]}),e.jsx(r,{to:"/system-diagnostic",children:e.jsxs(c,{variant:"outline",size:"sm",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:[e.jsx(f,{className:"mr-2 h-4 w-4 text-blue-500"}),"診断"]})})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-blue-100 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-800",children:"機種・機械番号管理"}),e.jsx("p",{className:"text-sm text-blue-400",children:"機種と機械番号の詳細管理"})]}),e.jsx(r,{to:"/machine-management",children:e.jsxs(c,{variant:"outline",size:"sm",className:"border-blue-300 text-blue-700 hover:bg-blue-50",children:[e.jsx(d,{className:"mr-2 h-4 w-4 text-blue-500"}),"管理"]})})]}),e.jsxs("div",{className:"border-t border-blue-100 pt-4 space-y-3",children:[e.jsx("div",{className:"text-sm font-medium text-blue-800 mb-3",children:"システムメンテナンス"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs(c,{onClick:async()=>{try{const e=await fetch("http://localhost:8080/api/tech-support/cleanup-uploads",{method:"POST"});if(!e.ok)throw new Error("クリーンアップに失敗しました");await e.json();C({title:"クリーンアップ完了",description:"アップロードファイルをクリーンアップしました"})}catch(e){C({title:"エラー",description:"クリーンアップに失敗しました",variant:"destructive"})}},variant:"destructive",className:"w-full",children:[e.jsx(v,{className:"mr-2 h-4 w-4"}),"一時ファイルを削除"]}),e.jsxs(c,{onClick:async()=>{try{C({title:"バックアップ開始",description:"ログファイルのバックアップを開始しています..."});const e=await fetch("http://localhost:8080/api/tech-support/backup-logs",{method:"POST"});if(!e.ok){const s=await e.json();throw new Error(s.error||"ログファイルバックアップに失敗しました")}const s=await e.json();if(!s.success)throw new Error(s.message||"バックアップに失敗しました");{const e=s.totalSize?(s.totalSize/1024/1024).toFixed(2):"0";C({title:"バックアップ完了",description:`${s.fileCount}件のログファイルをバックアップしました (${e} MB)`})}}catch(e){console.error("ログファイルバックアップエラー:",e),C({title:"エラー",description:e instanceof Error?e.message:"ログファイルバックアップに失敗しました",variant:"destructive"})}},variant:"outline",className:"w-full",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"ログファイルバックアップ"]})]})]})]})})]}),e.jsxs(n,{className:"border border-blue-200 shadow-md overflow-hidden",children:[e.jsx(o,{className:"pb-2 bg-gradient-to-r from-blue-400 to-sky-500 text-white",children:e.jsxs(m,{className:"text-lg flex items-center",children:[e.jsx(k,{className:"mr-2 h-5 w-5"}),"通知設定"]})}),e.jsx(x,{className:"bg-white",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-700",children:"通知を有効にする"}),e.jsx("p",{className:"text-sm text-blue-400",children:"新しいメッセージの通知を受け取る"})]}),e.jsx(h,{checked:B,onCheckedChange:O,className:"data-[state=checked]:bg-blue-500"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-blue-100 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-700",children:"音声読み上げ"}),e.jsx("p",{className:"text-sm text-blue-400",children:"AI応答を音声で読み上げる"})]}),e.jsx(h,{checked:T,onCheckedChange:V,className:"data-[state=checked]:bg-blue-500"})]}),T&&e.jsxs("div",{className:"py-2 border-t border-blue-100 pt-3",children:[e.jsx("p",{className:"font-medium mb-2 text-blue-700",children:"音声の音量"}),e.jsx(b,{value:z,onValueChange:I,max:100,step:1,className:"data-[state=checked]:bg-blue-500"}),e.jsxs("div",{className:"flex justify-between mt-1",children:[e.jsx(u,{className:"h-4 w-4 text-blue-400"}),e.jsxs("span",{className:"text-sm text-blue-500 font-medium",children:[z[0],"%"]})]})]})]})})]}),e.jsxs(n,{className:"border border-blue-200 shadow-md overflow-hidden",children:[e.jsx(o,{className:"pb-2 bg-gradient-to-r from-indigo-500 to-blue-600 text-white",children:e.jsxs(m,{className:"text-lg flex items-center",children:[e.jsx(i,{className:"mr-2 h-5 w-5"}),"アプリ設定"]})}),e.jsx(x,{className:"bg-white",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between py-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-indigo-700",children:"ダークモード"}),e.jsx("p",{className:"text-sm text-indigo-400",children:"暗い色のテーマを使用する"})]}),e.jsx(h,{checked:R,onCheckedChange:A,className:"data-[state=checked]:bg-indigo-500"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-blue-100 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-indigo-700",children:"自動保存"}),e.jsx("p",{className:"text-sm text-indigo-400",children:"会話を自動的に保存する"})]}),e.jsx(h,{checked:K,onCheckedChange:P,className:"data-[state=checked]:bg-indigo-500"})]}),e.jsxs("div",{className:"flex items-center justify-between py-2 border-t border-blue-100 pt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-indigo-700",children:"独自の技術資料のみを使用"}),e.jsx("p",{className:"text-sm text-indigo-400",children:"AI応答に登録済みナレッジのみを使用する"})]}),e.jsx(h,{checked:q,onCheckedChange:D,className:"data-[state=checked]:bg-indigo-500"})]}),e.jsx("div",{className:"py-2 border-t border-blue-100 pt-3 flex justify-end",children:e.jsxs(c,{onClick:F,className:"bg-gradient-to-r from-blue-500 to-indigo-500 text-white hover:from-blue-600 hover:to-indigo-600",children:[e.jsx(w,{className:"mr-2 h-4 w-4"}),"設定を保存"]})})]})})]})]}),e.jsx(j,{open:M,title:"ログアウト確認",message:"ログアウトしてもよろしいですか？未保存のデータは失われる可能性があります。",onCancel:()=>E(!1),onConfirm:async()=>{try{await S()}catch(e){C({title:"ログアウト失敗",description:"ログアウト中にエラーが発生しました。",variant:"destructive"})}finally{E(!1)}}})]})}export{S as default};
