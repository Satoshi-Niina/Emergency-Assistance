
> emergency-assistance-system@1.0.0 dev
> concurrently "npm:dev-client" "npm:dev-server"

[dev-client] 
[dev-client] > emergency-assistance-system@1.0.0 dev-client
[dev-client] > cd client && vite --host 0.0.0.0 --port 5001
[dev-client] 
[dev-server] 
[dev-server] > emergency-assistance-system@1.0.0 dev-server
[dev-server] > tsx server/index.ts
[dev-server] 
[dev-client] [dotenv@17.0.1] injecting env (0) from .env â€“ [tip] encrypt with dotenvx: https://dotenvx.com
[dev-client] 
[dev-client]   VITE v5.4.19  ready in 341 ms
[dev-client] 
[dev-client]   âœ  Local:   http://localhost:5001/
[dev-client]   âœ  Network: http://172.31.107.66:5001/
[dev-server] ğŸ” DEBUG server/db/schema.ts: DATABASE_URL = postgresql://neondb_owner:npg_D9YMuCVw6TUo@ep-mute-dew-afai7m8x.c-2.us-west-2.aws.neon.tech/neondb?sslmode=require
[dev-server] ğŸ” DEBUG server/db/schema.ts: connectionString = postgresql://neondb_owner:npg_D9YMuCVw6TUo@ep-mute-dew-afai7m8x.c-2.us-west-2.aws.neon.tech/neondb?sslmode=require
[dev-server] ğŸ” DEBUG server/db/index.ts: DATABASE_URL = postgresql://neondb_owner:npg_D9YMuCVw6TUo@ep-mute-dew-afai7m8x.c-2.us-west-2.aws.neon.tech/neondb?sslmode=require
[dev-server] ğŸ” DEBUG server/db/index.ts: connectionString = postgresql://neondb_owner:npg_D9YMuCVw6TUo@ep-mute-dew-afai7m8x.c-2.us-west-2.aws.neon.tech/neondb?sslmode=require
[dev-server] ğŸ”§ [AUTH ROUTER] èªè¨¼ãƒ«ãƒ¼ã‚¿ãƒ¼åˆæœŸåŒ–é–‹å§‹
[dev-server] âœ… [AUTH ROUTER] èªè¨¼ãƒ«ãƒ¼ã‚¿ãƒ¼åˆæœŸåŒ–å®Œäº†
[dev-server] ğŸ“ ç™»éŒ²ã•ã‚ŒãŸãƒ«ãƒ¼ãƒˆ: POST /login, POST /register, POST /logout, GET /me
[dev-server] ğŸ” DEBUG: DATABASE_URL = postgresql://neondb_owner:npg_D9YMuCVw6TUo@ep-mute-dew-afai7m8x.c-2.us-west-2.aws.neon.tech/neondb?sslmode=require
[dev-server] ğŸ” èªè¨¼ãƒ«ãƒ¼ã‚¿ãƒ¼ã‚¤ãƒ³ãƒãƒ¼ãƒˆçŠ¶æ³: { authRouterExists: true, authRouterType: 'function' }
[dev-server] ğŸ” [èµ·å‹•æ™‚ãƒ‘ã‚¹ç¢ºèª] knowledge-base/images/emergency-flows: /home/runner/workspace/knowledge-base/images/emergency-flows (exists: true)
[dev-server] ğŸ” [èµ·å‹•æ™‚ãƒ‘ã‚¹ç¢ºèª] knowledge-base/data: /home/runner/workspace/knowledge-base/data (exists: true)
[dev-server] ğŸ” [èµ·å‹•æ™‚ãƒ‘ã‚¹ç¢ºèª] knowledge-base/troubleshooting: /home/runner/workspace/knowledge-base/troubleshooting (exists: true)
[dev-server] ğŸ” [èµ·å‹•æ™‚ãƒ‘ã‚¹ç¢ºèª] .env: /home/runner/workspace/server/.env (exists: false)
[dev-server] ğŸ” [ç’°å¢ƒå¤‰æ•°ç¢ºèª] OpenAI API KEY: [SET]
[dev-server] ğŸš€ ã‚µãƒ¼ãƒãƒ¼èµ·å‹•é–‹å§‹
[dev-server] âœ… ç’°å¢ƒå¤‰æ•°èª­ã¿è¾¼ã¿å®Œäº†
[dev-server] ğŸ”§ Expressã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä½œæˆ
[dev-server] ğŸš€ ã‚µãƒ¼ãƒãƒ¼ã‚’ãƒãƒ¼ãƒˆ 5000 ã§èµ·å‹•ä¸­...
[dev-server] ğŸ“¡ ä½¿ç”¨ãƒãƒ¼ãƒˆ: 5000
[dev-server] ğŸ›£ï¸ ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šé–‹å§‹
[dev-server] ğŸ”§ èªè¨¼ãƒ«ãƒ¼ãƒˆç™»éŒ²ä¸­...
[dev-server] ğŸ“ authRouter type: function
[dev-server] ğŸ“ authRouter is function: true
[dev-server] âœ… authRouter is valid Express router
[dev-server] âœ… èªè¨¼ãƒ«ãƒ¼ãƒˆç™»éŒ²å®Œäº†: /api/auth
[dev-server] ğŸ“ ç™»éŒ²ã•ã‚ŒãŸèªè¨¼ãƒ«ãƒ¼ãƒˆ:
[dev-server]   [0] post /login
[dev-server]   [1] post /register
[dev-server]   [2] post /logout
[dev-server]   [3] get /me
[dev-server] âœ… ç”»åƒé…ä¿¡ãƒ«ãƒ¼ãƒˆè¨­å®šå®Œäº†
[dev-server] âœ… å…¨ãƒ«ãƒ¼ãƒˆè¨­å®šå®Œäº†
[dev-server] ğŸ”„ ã‚µãƒ¼ãƒãƒ¼listené–‹å§‹
[dev-server] âœ… ã‚µãƒ¼ãƒãƒ¼index.tsãƒ•ã‚¡ã‚¤ãƒ«ã®çµ‚ç«¯
[dev-server] ğŸš€ Server successfully started on http://0.0.0.0:5000
[dev-server] ğŸŒ Local access: http://localhost:5000
[dev-server] ğŸ“‚ Working directory: /home/runner/workspace
[dev-server] ğŸ”§ Node environment: development
[dev-server] ğŸ”„ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šãƒ†ã‚¹ãƒˆé–‹å§‹...
[dev-server] 
[dev-server] ğŸ” [2025-07-30T01:42:52.485Z] GET /
[dev-server] ğŸ“ è©³ç´°: {
[dev-server]   url: '/',
[dev-server]   path: '/',
[dev-server]   originalUrl: '/',
[dev-server]   baseUrl: '',
[dev-server]   method: 'GET',
[dev-server]   headers: {
[dev-server]     host: 'ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     origin: undefined,
[dev-server]     'content-type': undefined,
[dev-server]     'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb...'
[dev-server]   },
[dev-server]   body: 'N/A'
[dev-server] }
[dev-server] ğŸ” CORS ãƒã‚§ãƒƒã‚¯: {
[dev-server]   origin: undefined,
[dev-server]   allowedOrigins: [
[dev-server]     'http://localhost:3000',
[dev-server]     'http://localhost:4173',
[dev-server]     'http://localhost:5001',
[dev-server]     'http://127.0.0.1:3000',
[dev-server]     'http://127.0.0.1:4173',
[dev-server]     'http://127.0.0.1:5001',
[dev-server]     '=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     'https://workspace.takabeniniina.repl.co',
[dev-server]     'https://workspace.takabeniniina.repl.co:3001',
[dev-server]     'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001'
[dev-server]   ]
[dev-server] }
[dev-server] âœ… CORSè¨±å¯: ã‚ªãƒªã‚¸ãƒ³ãªã—ï¼ˆåŒä¸€ã‚ªãƒªã‚¸ãƒ³ï¼‰
[dev-server] ğŸ“¨ [2025-07-30T01:42:52.490Z] GET /
[dev-server] ğŸ” Headers: Origin=undefined, Host=ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev, Referer=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev/__replco/workspace_iframe.html?initialPath=%2F&id=%3Ar2oi%3A
[dev-server] ğŸ” Full URL: http://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev/
[dev-server] 
[dev-server] âŒ [404 NOT FOUND] GET /
[dev-server] ğŸ“ è©³ç´°æƒ…å ±: {
[dev-server]   path: '/',
[dev-server]   originalUrl: '/',
[dev-server]   baseUrl: '',
[dev-server]   method: 'GET',
[dev-server]   headers: {
[dev-server]     host: 'ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     origin: undefined,
[dev-server]     'content-type': undefined
[dev-server]   }
[dev-server] }
[dev-server] 
[dev-server] ğŸ” [EXPRESS ROUTER STACK è©³ç´°èª¿æŸ»]
[dev-server] ğŸ›£ï¸ Express app._router.stack:
[dev-server]   [0] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: query
[dev-server]   [1] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: expressInit
[dev-server]   [2] regexp: /^(.*)\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: <anonymous>
[dev-server]   [3] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: corsMiddleware
[dev-server]   [4] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: jsonParser
[dev-server]   [5] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: urlencodedParser
[dev-server]   [6] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: session
[dev-server]   [7] regexp: /^\/public\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: serveStatic
[dev-server]   [8] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: <anonymous>
[dev-server]   [9] regexp: /^\/api\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: <anonymous>
[dev-server]   [10] regexp: /^\/api\/auth\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: router
[dev-server]        ğŸ”§ Sub-router found with 4 routes:
[dev-server]          [0] /login - {"post":true}
[dev-server]          [1] /register - {"post":true}
[dev-server]          [2] /logout - {"post":true}
[dev-server]          [3] /me - {"get":true}
[dev-server]   [11] regexp: /^\/api\/emergency-flow\/image\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: serveStatic
[dev-server]   [12] regexp: /^\/api\/health\/?$/i, methods: {"get":true}
[dev-server]        path: /api/health, name: bound dispatch
[dev-server]   [13] regexp: /^\/api\/chats(?:\/([^/]+?))\/last-export\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: <anonymous>
[dev-server]   [14] regexp: /^\/api\/(.*)\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: <anonymous>
[dev-server]   [15] regexp: /^\/api\/troubleshooting\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: router
[dev-server]        ğŸ”§ Sub-router found with 6 routes:
[dev-server]          [0] /list - {"get":true}
[dev-server]          [1] /detail/:id - {"get":true}
[dev-server]          [2] / - {"post":true}
[dev-server]          [3] /:id - {"put":true}
[dev-server]          [4] /:id - {"delete":true}
[dev-server]          [5] /search - {"post":true}
[dev-server]   [16] regexp: /^\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: <anonymous>
[dev-server]   [17] regexp: /^(.*)\/?(?=\/|$)/i, methods: "N/A"
[dev-server]        path: middleware, name: <anonymous>
[dev-server] ğŸ›£ï¸ æƒ³å®šã•ã‚Œã¦ã„ã‚‹APIãƒ«ãƒ¼ãƒˆ:
[dev-server]   âœ… POST /api/auth/login
[dev-server]   âœ… GET /api/auth/me
[dev-server]   âœ… POST /api/auth/logout
[dev-server]   âœ… POST /api/auth/register
[dev-server] âœ… Connected to PostgreSQL database
[dev-server] âœ… ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¥ç¶šæˆåŠŸ
[dev-server] ğŸ”„ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆé–‹å§‹...
[dev-server] ğŸ”„ ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆé–‹å§‹...
[dev-server] 
[dev-server] ğŸ” [2025-07-30T01:42:54.200Z] GET /api/auth/me
[dev-server] ğŸ“ è©³ç´°: {
[dev-server]   url: '/',
[dev-server]   path: '/',
[dev-server]   originalUrl: '/api/auth/me',
[dev-server]   baseUrl: '/api/auth/me',
[dev-server]   method: 'GET',
[dev-server]   headers: {
[dev-server]     host: 'ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     origin: 'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001',
[dev-server]     'content-type': undefined,
[dev-server]     'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb...'
[dev-server]   },
[dev-server]   body: 'N/A'
[dev-server] }
[dev-server] ğŸ” CORS ãƒã‚§ãƒƒã‚¯: {
[dev-server]   origin: 'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001',
[dev-server]   allowedOrigins: [
[dev-server]     'http://localhost:3000',
[dev-server]     'http://localhost:4173',
[dev-server]     'http://localhost:5001',
[dev-server]     'http://127.0.0.1:3000',
[dev-server]     'http://127.0.0.1:4173',
[dev-server]     'http://127.0.0.1:5001',
[dev-server]     '=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     'https://workspace.takabeniniina.repl.co',
[dev-server]     'https://workspace.takabeniniina.repl.co:3001',
[dev-server]     'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001'
[dev-server]   ]
[dev-server] }
[dev-server] âœ… CORSè¨±å¯: Replitç’°å¢ƒ
[dev-server] ğŸ“¨ [2025-07-30T01:42:54.201Z] GET /api/auth/me
[dev-server] ğŸ” Headers: Origin=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001, Host=ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev, Referer=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001/
[dev-server] ğŸ” Full URL: http://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev/api/auth/me
[dev-server] ğŸ” [API Route Handler] å—ä¿¡: {
[dev-server]   method: 'GET',
[dev-server]   path: '/auth/me',
[dev-server]   originalUrl: '/api/auth/me',
[dev-server]   baseUrl: '/api',
[dev-server]   headers: {
[dev-server]     'content-type': undefined,
[dev-server]     'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb'
[dev-server]   }
[dev-server] }
[dev-server] ğŸ” [èªè¨¼API] è©³ç´°: { method: 'GET', path: '/auth/me', body: 'N/A', hasSession: true }
[dev-server] ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: { hasSession: true, userId: undefined }
[dev-server] âŒ èªè¨¼ã•ã‚Œã¦ã„ã¾ã›ã‚“
[dev-server] 
[dev-server] ğŸ” [2025-07-30T01:42:54.363Z] GET /api/auth/me
[dev-server] ğŸ“ è©³ç´°: {
[dev-server]   url: '/',
[dev-server]   path: '/',
[dev-server]   originalUrl: '/api/auth/me',
[dev-server]   baseUrl: '/api/auth/me',
[dev-server]   method: 'GET',
[dev-server]   headers: {
[dev-server]     host: 'ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     origin: 'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001',
[dev-server]     'content-type': undefined,
[dev-server]     'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb...'
[dev-server]   },
[dev-server]   body: 'N/A'
[dev-server] }
[dev-server] ğŸ” CORS ãƒã‚§ãƒƒã‚¯: {
[dev-server]   origin: 'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001',
[dev-server]   allowedOrigins: [
[dev-server]     'http://localhost:3000',
[dev-server]     'http://localhost:4173',
[dev-server]     'http://localhost:5001',
[dev-server]     'http://127.0.0.1:3000',
[dev-server]     'http://127.0.0.1:4173',
[dev-server]     'http://127.0.0.1:5001',
[dev-server]     '=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     'https://workspace.takabeniniina.repl.co',
[dev-server]     'https://workspace.takabeniniina.repl.co:3001',
[dev-server]     'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev',
[dev-server]     'https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001'
[dev-server]   ]
[dev-server] }
[dev-server] âœ… CORSè¨±å¯: Replitç’°å¢ƒ
[dev-server] ğŸ“¨ [2025-07-30T01:42:54.364Z] GET /api/auth/me
[dev-server] ğŸ” Headers: Origin=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001, Host=ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev, Referer=https://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev:3001/
[dev-server] ğŸ” Full URL: http://ceb3a872-0092-4e86-a990-adc5b271598b-00-tlthbuz5ebfd.sisko.replit.dev/api/auth/me
[dev-server] ğŸ” [API Route Handler] å—ä¿¡: {
[dev-server]   method: 'GET',
[dev-server]   path: '/auth/me',
[dev-server]   originalUrl: '/api/auth/me',
[dev-server]   baseUrl: '/api',
[dev-server]   headers: {
[dev-server]     'content-type': undefined,
[dev-server]     'user-agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWeb'
[dev-server]   }
[dev-server] }
[dev-server] ğŸ” [èªè¨¼API] è©³ç´°: { method: 'GET', path: '/auth/me', body: 'N/A', hasSession: true }
[dev-server] ğŸ‘¤ ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±å–å¾—ãƒªã‚¯ã‚¨ã‚¹ãƒˆ: { hasSession: true, userId: undefined }
[dev-server] âŒ èªè¨¼ã•ã‚Œã¦ã„ã¾ã›ã‚“
[dev-server] ğŸ—‘ï¸ æ—¢å­˜ã®niinaãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’å‰Šé™¤ã—ã¾ã—ãŸ
[dev-server] ğŸ” æ–°ã—ã„ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥ã‚’ç”Ÿæˆ: $2b$10$vAW0CifkrS.gWAoexc2S7unkkY.h7CrXaO5VKHUDnz57Zul7E70wW
[dev-server] âœ… ç®¡ç†è€…ãƒ¦ãƒ¼ã‚¶ãƒ¼ (niina) ã‚’å†ä½œæˆã—ã¾ã—ãŸ
[dev-server] takabeni1ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¯æ—¢ã«å­˜åœ¨ã—ã¾ã™
[dev-server] ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ä½œæˆãŒå®Œäº†ã—ã¾ã—ãŸ
[dev-server] âœ… ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆå®Œäº†
^C[dev-server] npm run dev-server exited with code SIGINT
[dev-client] npm run dev-client exited with code SIGINT